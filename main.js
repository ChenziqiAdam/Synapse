/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => SynapsePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/settings.ts
var DEFAULT_SETTINGS = {
  ollamaUrl: "http://localhost:11434",
  ollamaModel: "gemma3n:e2b",
  autoLinkEnabled: true,
  summaryLocation: "top",
  flashcardFormat: "simple",
  maxResponseLength: 1e3,
  explanationFolder: "Explanations",
  flashcardFolder: "Flashcards",
  useSummaryYaml: true,
  chatFolder: "Chats",
  enableLiveChat: true,
  enableLiveSuggestions: false,
  suggestionDelay: 1e3
};

// src/ui/SettingsTab.ts
var import_obsidian = require("obsidian");

// src/ollama.ts
var OllamaClient = class {
  constructor(baseUrl, model) {
    this.baseUrl = baseUrl.replace(/\/$/, "");
    this.model = model;
  }
  async isAvailable() {
    try {
      const response = await fetch(`${this.baseUrl}/api/tags`);
      return response.ok;
    } catch (error) {
      return false;
    }
  }
  async generate(prompt, systemPrompt, chatHistory) {
    try {
      let fullPrompt = prompt;
      if (chatHistory && chatHistory.trim()) {
        fullPrompt = `Chat history:
${chatHistory}

Current message: ${prompt}`;
      }
      const requestBody = {
        model: this.model,
        prompt: fullPrompt,
        system: systemPrompt || "",
        stream: false,
        options: {
          temperature: 0.7,
          top_p: 0.9,
          top_k: 40
        }
      };
      const response = await fetch(`${this.baseUrl}/api/generate`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(requestBody)
      });
      if (!response.ok) {
        throw new Error(`Ollama API error: ${response.status}`);
      }
      const data = await response.json();
      return data.response.trim();
    } catch (error) {
      throw new Error(`Failed to generate response: ${error.message}`);
    }
  }
  async getAvailableModels() {
    var _a;
    try {
      const response = await fetch(`${this.baseUrl}/api/tags`);
      if (!response.ok) {
        throw new Error(`Failed to fetch models: ${response.status}`);
      }
      const data = await response.json();
      return ((_a = data.models) == null ? void 0 : _a.map((model) => model.name)) || [];
    } catch (error) {
      console.error("Error fetching models:", error);
      return [];
    }
  }
};

// src/ui/SettingsTab.ts
var SynapseSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Synapse Settings" });
    containerEl.createEl("h3", { text: "Ollama Configuration" });
    new import_obsidian.Setting(containerEl).setName("Ollama URL").setDesc("URL where Ollama is running (default: http://localhost:11434)").addText((text) => text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.ollamaUrl).onChange(async (value) => {
      this.plugin.settings.ollamaUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Model").setDesc("Ollama model to use (e.g., phi3:mini, llama2, mistral)").addText((text) => text.setPlaceholder("phi3:mini").setValue(this.plugin.settings.ollamaModel).onChange(async (value) => {
      this.plugin.settings.ollamaModel = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Test Connection").setDesc("Test connection to Ollama").addButton((button) => button.setButtonText("Test").setCta().onClick(async () => {
      const client = new OllamaClient(this.plugin.settings.ollamaUrl, this.plugin.settings.ollamaModel);
      const isAvailable = await client.isAvailable();
      if (isAvailable) {
        button.setButtonText("\u2713 Connected");
        button.buttonEl.style.backgroundColor = "#4caf50";
        setTimeout(() => {
          button.setButtonText("Test");
          button.buttonEl.style.backgroundColor = "";
        }, 2e3);
      } else {
        button.setButtonText("\u2717 Failed");
        button.buttonEl.style.backgroundColor = "#f44336";
        setTimeout(() => {
          button.setButtonText("Test");
          button.buttonEl.style.backgroundColor = "";
        }, 2e3);
      }
    }));
    containerEl.createEl("h3", { text: "Feature Settings" });
    new import_obsidian.Setting(containerEl).setName("Auto-linking").setDesc('Automatically create links when using "Explain & Link"').addToggle((toggle) => toggle.setValue(this.plugin.settings.autoLinkEnabled).onChange(async (value) => {
      this.plugin.settings.autoLinkEnabled = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Summary Location").setDesc("Where to place summaries in notes").addDropdown((dropdown) => dropdown.addOption("top", "Top of note").addOption("bottom", "Bottom of note").setValue(this.plugin.settings.summaryLocation).onChange(async (value) => {
      this.plugin.settings.summaryLocation = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Use YAML for Summaries").setDesc("Add summaries to note frontmatter as YAML").addToggle((toggle) => toggle.setValue(this.plugin.settings.useSummaryYaml).onChange(async (value) => {
      this.plugin.settings.useSummaryYaml = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Max Response Length").setDesc("Maximum length for AI responses (characters)").addSlider((slider) => slider.setLimits(500, 3e3, 100).setValue(this.plugin.settings.maxResponseLength).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.maxResponseLength = value;
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h3", { text: "Folder Organization" });
    new import_obsidian.Setting(containerEl).setName("Explanations Folder").setDesc("Folder for explanation notes (empty for vault root)").addText((text) => text.setPlaceholder("Explanations").setValue(this.plugin.settings.explanationFolder).onChange(async (value) => {
      this.plugin.settings.explanationFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Flashcards Folder").setDesc("Folder for flashcard notes (empty for vault root)").addText((text) => text.setPlaceholder("Flashcards").setValue(this.plugin.settings.flashcardFolder).onChange(async (value) => {
      this.plugin.settings.flashcardFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Chat Folder").setDesc("Folder for chat session notes (empty for vault root)").addText((text) => text.setPlaceholder("Chats").setValue(this.plugin.settings.chatFolder).onChange(async (value) => {
      this.plugin.settings.chatFolder = value;
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h3", { text: "Live Features" });
    new import_obsidian.Setting(containerEl).setName("Enable Live Chat").setDesc("Enable interactive chat sessions in notes").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableLiveChat).onChange(async (value) => {
      this.plugin.settings.enableLiveChat = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Enable Live Suggestions").setDesc("Provide suggestions as you type (experimental)").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableLiveSuggestions).onChange(async (value) => {
      this.plugin.settings.enableLiveSuggestions = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Suggestion Delay").setDesc("Delay before showing suggestions (milliseconds)").addSlider((slider) => slider.setLimits(500, 5e3, 100).setValue(this.plugin.settings.suggestionDelay).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.suggestionDelay = value;
      await this.plugin.saveSettings();
    })).setDisabled(!this.plugin.settings.enableLiveSuggestions);
    containerEl.createEl("h3", { text: "Usage Instructions" });
    const instructions = containerEl.createDiv();
    instructions.innerHTML = `
            <p><strong>Commands available:</strong></p>
            <ul>
                <li><strong>Explain & Link:</strong> Select text and use command palette or right-click menu</li>
                <li><strong>Summarize Note:</strong> Run command to summarize entire current note</li>
                <li><strong>Create Flashcards:</strong> Select text to generate study flashcards</li>
                <li><strong>Start Chat Session:</strong> Begin an interactive chat with the AI</li>
                <li><strong>Send Chat Message:</strong> In a chat note, send the current line to the AI</li>
            </ul>
            <p><strong>Requirements:</strong> Make sure Ollama is installed and running with your selected model.</p>
        `;
  }
};

// src/commands.ts
var import_obsidian2 = require("obsidian");
var SynapseCommands = class {
  constructor(app, ollama, settings) {
    this.app = app;
    this.ollama = ollama;
    this.settings = settings;
  }
  updateSettings(settings) {
    this.settings = settings;
    this.ollama = new OllamaClient(settings.ollamaUrl, settings.ollamaModel);
  }
  async explainAndLink(editor, selectedText) {
    if (!selectedText.trim()) {
      new import_obsidian2.Notice("Please select text to explain");
      return;
    }
    const noticeLoading = new import_obsidian2.Notice("Generating explanation...", 0);
    try {
      const systemPrompt = `You are a helpful educational assistant. Create a clear, concise explanation of the given concept. 
            Format your response as a well-structured note with:
            1. A brief definition
            2. Key characteristics or properties
            3. A simple analogy or example if helpful
            4. Why this concept is important
            
            Keep the explanation under ${this.settings.maxResponseLength} characters and use clear, educational language.`;
      const prompt = `Explain this concept: "${selectedText}"`;
      const explanation = await this.ollama.generate(prompt, systemPrompt);
      const noteTitle = this.sanitizeFileName(selectedText);
      await this.ensureFolderExists(this.settings.explanationFolder);
      const filePath = `${this.settings.explanationFolder}/${noteTitle}.md`;
      const existingFile = this.app.vault.getAbstractFileByPath(filePath);
      if (existingFile instanceof import_obsidian2.TFile) {
        new import_obsidian2.Notice(`Note "${noteTitle}" already exists`);
        noticeLoading.hide();
        return;
      }
      const noteContent = `# ${noteTitle}

${explanation}

---
*Generated by Synapse AI*
*Created: ${new Date().toLocaleDateString()}*`;
      const newFile = await this.app.vault.create(filePath, noteContent);
      const link = `[[${filePath.replace(".md", "")}|${noteTitle}]]`;
      editor.replaceSelection(link);
      await this.app.workspace.getLeaf().openFile(newFile);
      noticeLoading.hide();
      new import_obsidian2.Notice(`Created and linked note: ${noteTitle}`);
    } catch (error) {
      noticeLoading.hide();
      new import_obsidian2.Notice(`Error: ${error.message}`);
      console.error("Explain and Link error:", error);
    }
  }
  async summarizeNote(editor, content) {
    var _a, _b;
    if (!content.trim()) {
      new import_obsidian2.Notice("No content to summarize");
      return;
    }
    const noticeLoading = new import_obsidian2.Notice("Generating summary...", 0);
    try {
      const systemPrompt = `You are a helpful assistant that creates concise summaries. 
            Create a bullet-point summary (3-5 points) of the main ideas in the given text. 
            Each bullet point should be clear and capture a key concept.
            Format as markdown bullets starting with "- ".`;
      const prompt = `Summarize this content:

${content}`;
      const summary = await this.ollama.generate(prompt, systemPrompt);
      let summarySection;
      if (this.settings.useSummaryYaml) {
        summarySection = `---
summary:
${summary.split("\n").map((line) => `  ${line}`).join("\n")}
---

`;
      } else {
        summarySection = `## Summary

${summary}

---

`;
      }
      if (this.settings.summaryLocation === "top") {
        const lines = content.split("\n");
        let insertIndex = 0;
        if ((_a = lines[0]) == null ? void 0 : _a.startsWith("---")) {
          let endFrontMatter = lines.findIndex((line, i) => i > 0 && line.startsWith("---"));
          if (endFrontMatter !== -1) {
            insertIndex = endFrontMatter + 1;
          }
        }
        if (this.settings.useSummaryYaml && ((_b = lines[0]) == null ? void 0 : _b.startsWith("---"))) {
          const endFrontMatter = lines.findIndex((line, i) => i > 0 && line.startsWith("---"));
          if (endFrontMatter !== -1) {
            const existingFrontmatter = lines.slice(0, endFrontMatter + 1).join("\n");
            const openFrontmatter = existingFrontmatter.replace(/---\s*$/, "");
            const summaryYaml = `summary:
${summary.split("\n").map((line) => `  ${line}`).join("\n")}
---`;
            const newContent2 = openFrontmatter + summaryYaml + "\n\n" + lines.slice(endFrontMatter + 1).join("\n");
            editor.setValue(newContent2);
            noticeLoading.hide();
            new import_obsidian2.Notice("Summary added to frontmatter");
            return;
          }
        }
        const newContent = [
          ...lines.slice(0, insertIndex),
          "",
          summarySection,
          ...lines.slice(insertIndex)
        ].join("\n");
        editor.setValue(newContent);
      } else {
        editor.setValue(content + "\n\n" + summarySection);
      }
      noticeLoading.hide();
      new import_obsidian2.Notice("Summary added to note");
    } catch (error) {
      noticeLoading.hide();
      new import_obsidian2.Notice(`Error: ${error.message}`);
      console.error("Summarize error:", error);
    }
  }
  async createFlashcards(editor, selectedText) {
    if (!selectedText.trim()) {
      new import_obsidian2.Notice("Please select text to create flashcards from");
      return;
    }
    const noticeLoading = new import_obsidian2.Notice("Creating flashcards...", 0);
    try {
      const systemPrompt = `You are a helpful assistant that creates study flashcards. 
            From the given text, identify 3-7 key concepts and create flashcards in this exact format:

            **Q:** Question here?
            **A:** Answer here

            Make questions clear and specific. Answers should be concise but complete.
            Focus on the most important concepts for learning and retention.`;
      const prompt = `Create flashcards from this content:

${selectedText}`;
      const flashcards = await this.ollama.generate(prompt, systemPrompt);
      const activeFile = this.app.workspace.getActiveFile();
      const noteTitle = activeFile ? activeFile.basename : "Untitled";
      await this.ensureFolderExists(this.settings.flashcardFolder);
      const flashcardFileName = `${this.settings.flashcardFolder}/${noteTitle} - Flashcards.md`;
      const flashcardContent = `# Flashcards for ${noteTitle}

${flashcards}

---
*Generated from: [[${activeFile ? activeFile.path.replace(".md", "") : "Unknown source"}]]*
*Created: ${new Date().toLocaleDateString()}*
`;
      const existingFile = this.app.vault.getAbstractFileByPath(flashcardFileName);
      if (existingFile instanceof import_obsidian2.TFile) {
        const existingContent = await this.app.vault.read(existingFile);
        const newContent = existingContent + "\n\n## New Flashcards\n\n" + flashcards;
        await this.app.vault.modify(existingFile, newContent);
        await this.app.workspace.getLeaf().openFile(existingFile);
        noticeLoading.hide();
        new import_obsidian2.Notice("Added flashcards to existing note");
      } else {
        const newFile = await this.app.vault.create(flashcardFileName, flashcardContent);
        await this.app.workspace.getLeaf().openFile(newFile);
        noticeLoading.hide();
        new import_obsidian2.Notice("Created new flashcards note");
      }
      const link = `

[[${flashcardFileName.replace(".md", "")}|Flashcards for this note]]
`;
      const cursor = editor.getCursor();
      editor.setLine(cursor.line, editor.getLine(cursor.line) + link);
    } catch (error) {
      noticeLoading.hide();
      new import_obsidian2.Notice(`Error: ${error.message}`);
      console.error("Create Flashcards error:", error);
    }
  }
  async startChatSession(editor) {
    await this.ensureFolderExists(this.settings.chatFolder);
    const timestamp = new Date().toISOString().replace(/[:.]/g, "-");
    const chatFileName = `${this.settings.chatFolder}/Chat-${timestamp}.md`;
    const chatTemplate = `# Chat Session ${new Date().toLocaleString()}

## Context
*This is a chat session with Synapse AI. Type your messages after the > prompt.*

## Chat

> 

`;
    const newFile = await this.app.vault.create(chatFileName, chatTemplate);
    const leaf = this.app.workspace.getLeaf();
    await leaf.openFile(newFile);
    const newEditor = this.getActiveEditor();
    if (newEditor) {
      const lines = chatTemplate.split("\n");
      const promptLine = lines.findIndex((line) => line === "> ");
      if (promptLine !== -1) {
        newEditor.setCursor({ line: promptLine, ch: 2 });
        newEditor.focus();
      }
    }
    new import_obsidian2.Notice("Started new chat session");
  }
  async sendChatMessage(editor) {
    const content = editor.getValue();
    const lines = content.split("\n");
    const currentLine = editor.getCursor().line;
    let promptLine = currentLine;
    while (promptLine >= 0 && !lines[promptLine].startsWith(">")) {
      promptLine--;
    }
    if (promptLine < 0) {
      new import_obsidian2.Notice("No chat prompt found. Please start message with >");
      return;
    }
    const userMessage = lines[promptLine].substring(2).trim();
    if (!userMessage) {
      new import_obsidian2.Notice("Please type a message first");
      return;
    }
    lines[promptLine] = `> ${userMessage}`;
    lines.splice(promptLine + 1, 0, "\n_Synapse is thinking..._");
    editor.setValue(lines.join("\n"));
    const chatHistory = this.extractChatHistory(lines, promptLine);
    try {
      const systemPrompt = `You are a helpful AI assistant in a chat session. 
            Provide thoughtful, concise responses to the user's questions.
            Use markdown formatting when appropriate.
            Reference prior messages in the conversation when relevant.`;
      const response = await this.ollama.generate(userMessage, systemPrompt, chatHistory);
      lines.splice(promptLine + 1, 1);
      lines.splice(
        promptLine + 1,
        0,
        `
${response}
`,
        `> `
      );
      editor.setValue(lines.join("\n"));
      editor.setCursor({ line: promptLine + 3, ch: 2 });
      editor.focus();
    } catch (error) {
      new import_obsidian2.Notice(`Error: ${error.message}`);
      console.error("Chat error:", error);
      lines.splice(promptLine + 1, 1);
      lines.splice(promptLine + 1, 0, "_Error: Could not generate response_");
      editor.setValue(lines.join("\n"));
    }
  }
  async generateLiveSuggestion(editor) {
    if (!this.settings.enableLiveSuggestions)
      return;
    const content = editor.getValue();
    const cursor = editor.getCursor();
    const currentLine = cursor.line;
    const contextLines = content.split("\n").slice(Math.max(0, currentLine - 10), currentLine + 1);
    const context = contextLines.join("\n");
    if (context.trim().length < 10)
      return;
    try {
      const systemPrompt = `You are an AI writing assistant. 
            Based on the context provided, suggest a brief continuation (1-2 sentences max).
            Make your suggestion directly relevant to what's being written.
            Do not repeat what's already written.`;
      const response = await this.ollama.generate(`Continue this text: ${context}`, systemPrompt);
      new import_obsidian2.Notice(`Suggestion: ${response.substring(0, 100)}${response.length > 100 ? "..." : ""}`, 5e3);
    } catch (error) {
      console.error("Suggestion error:", error);
    }
  }
  sanitizeFileName(text) {
    return text.replace(/[^\w\s-]/g, "").replace(/\s+/g, " ").trim().substring(0, 50);
  }
  async ensureFolderExists(folderPath) {
    if (!folderPath)
      return;
    const folders = folderPath.split("/").filter((p) => p.trim());
    let currentPath = "";
    for (const folder of folders) {
      currentPath = currentPath ? `${currentPath}/${folder}` : folder;
      if (!this.app.vault.getAbstractFileByPath(currentPath)) {
        try {
          await this.app.vault.createFolder(currentPath);
        } catch (error) {
          console.error(`Failed to create folder ${currentPath}:`, error);
        }
      }
    }
  }
  getActiveEditor() {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    return (view == null ? void 0 : view.editor) || null;
  }
  extractChatHistory(lines, currentPromptLine) {
    let chatHistory = "";
    let inChat = false;
    for (let i = 0; i < currentPromptLine; i++) {
      const line = lines[i];
      if (line === "## Chat") {
        inChat = true;
        continue;
      }
      if (inChat) {
        if (line.startsWith("> ")) {
          chatHistory += `User: ${line.substring(2)}
`;
        } else if (line.trim() && !line.startsWith("_") && line !== "") {
          chatHistory += `AI: ${line}
`;
        }
      }
    }
    return chatHistory;
  }
};

// src/main.ts
var SynapsePlugin = class extends import_obsidian3.Plugin {
  async onload() {
    await this.loadSettings();
    this.ollama = new OllamaClient(this.settings.ollamaUrl, this.settings.ollamaModel);
    this.commands = new SynapseCommands(this.app, this.ollama, this.settings);
    this.debouncedSuggestion = (0, import_obsidian3.debounce)(
      (editor) => this.commands.generateLiveSuggestion(editor),
      this.settings.suggestionDelay
    );
    this.addSettingTab(new SynapseSettingsTab(this.app, this));
    this.addCommand({
      id: "explain-and-link",
      name: "Explain & Link Selected Text",
      editorCallback: (editor) => {
        const selectedText = editor.getSelection();
        this.commands.explainAndLink(editor, selectedText);
      }
    });
    this.addCommand({
      id: "summarize-note",
      name: "Summarize Current Note",
      editorCallback: (editor) => {
        const content = editor.getValue();
        this.commands.summarizeNote(editor, content);
      }
    });
    this.addCommand({
      id: "create-flashcards",
      name: "Create Flashcards from Selection",
      editorCallback: (editor) => {
        const selectedText = editor.getSelection();
        this.commands.createFlashcards(editor, selectedText);
      }
    });
    this.addCommand({
      id: "start-chat",
      name: "Start New Chat Session",
      editorCallback: (editor) => {
        this.commands.startChatSession(editor);
      }
    });
    this.addCommand({
      id: "send-chat-message",
      name: "Send Chat Message",
      editorCallback: (editor) => {
        this.commands.sendChatMessage(editor);
      }
    });
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor) => {
        var _a;
        const selectedText = editor.getSelection();
        if (selectedText) {
          menu.addItem((item) => {
            item.setTitle("\u{1F9E0} Explain & Link").setIcon("brain-circuit").onClick(async () => {
              await this.commands.explainAndLink(editor, selectedText);
            });
          });
          menu.addItem((item) => {
            item.setTitle("\u{1F3B4} Create Flashcards").setIcon("card-stack").onClick(async () => {
              await this.commands.createFlashcards(editor, selectedText);
            });
          });
        }
        menu.addItem((item) => {
          item.setTitle("\u{1F4DD} Summarize Note").setIcon("list-checks").onClick(async () => {
            const content = editor.getValue();
            await this.commands.summarizeNote(editor, content);
          });
        });
        const fileName = ((_a = this.app.workspace.getActiveFile()) == null ? void 0 : _a.basename) || "";
        if (fileName.startsWith("Chat-")) {
          menu.addItem((item) => {
            item.setTitle("\u{1F4AC} Send Chat Message").setIcon("message-square").onClick(async () => {
              await this.commands.sendChatMessage(editor);
            });
          });
        } else {
          menu.addItem((item) => {
            item.setTitle("\u{1F4AC} Start Chat Session").setIcon("message-circle").onClick(async () => {
              await this.commands.startChatSession(editor);
            });
          });
        }
      })
    );
    if (this.settings.enableLiveSuggestions) {
      this.registerEvent(
        this.app.workspace.on("editor-change", (editor) => {
          this.debouncedSuggestion(editor);
        })
      );
    }
    this.checkOllamaConnection();
    console.log("Synapse plugin loaded");
  }
  onunload() {
    console.log("Synapse plugin unloaded");
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.commands.updateSettings(this.settings);
    this.debouncedSuggestion = (0, import_obsidian3.debounce)(
      (editor) => this.commands.generateLiveSuggestion(editor),
      this.settings.suggestionDelay
    );
    if (this.settings.enableLiveSuggestions) {
      this.registerEvent(
        this.app.workspace.on("editor-change", (editor) => {
          this.debouncedSuggestion(editor);
        })
      );
    }
  }
  async checkOllamaConnection() {
    const isAvailable = await this.ollama.isAvailable();
    if (!isAvailable) {
      new import_obsidian3.Notice(
        "Synapse: Cannot connect to Ollama. Please make sure Ollama is running on " + this.settings.ollamaUrl,
        8e3
      );
    } else {
      new import_obsidian3.Notice("Synapse: Connected to Ollama successfully", 3e3);
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy91aS9TZXR0aW5nc1RhYi50cyIsICJzcmMvb2xsYW1hLnRzIiwgInNyYy9jb21tYW5kcy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTWVudSwgTm90aWNlLCBkZWJvdW5jZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IFN5bmFwc2VTZXR0aW5ncywgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJy4vc2V0dGluZ3MnO1xuaW1wb3J0IHsgU3luYXBzZVNldHRpbmdzVGFiIH0gZnJvbSAnLi91aS9TZXR0aW5nc1RhYic7XG5pbXBvcnQgeyBPbGxhbWFDbGllbnQgfSBmcm9tICcuL29sbGFtYSc7XG5pbXBvcnQgeyBTeW5hcHNlQ29tbWFuZHMgfSBmcm9tICcuL2NvbW1hbmRzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3luYXBzZVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IFN5bmFwc2VTZXR0aW5ncztcbiAgICBvbGxhbWE6IE9sbGFtYUNsaWVudDtcbiAgICBjb21tYW5kczogU3luYXBzZUNvbW1hbmRzO1xuICAgIGRlYm91bmNlZFN1Z2dlc3Rpb246IGFueTtcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuICAgICAgICAvLyBJbml0aWFsaXplIE9sbGFtYSBjbGllbnQgYW5kIGNvbW1hbmRzXG4gICAgICAgIHRoaXMub2xsYW1hID0gbmV3IE9sbGFtYUNsaWVudCh0aGlzLnNldHRpbmdzLm9sbGFtYVVybCwgdGhpcy5zZXR0aW5ncy5vbGxhbWFNb2RlbCk7XG4gICAgICAgIHRoaXMuY29tbWFuZHMgPSBuZXcgU3luYXBzZUNvbW1hbmRzKHRoaXMuYXBwLCB0aGlzLm9sbGFtYSwgdGhpcy5zZXR0aW5ncyk7XG5cbiAgICAgICAgLy8gU2V0IHVwIGRlYm91bmNlZCBzdWdnZXN0aW9uXG4gICAgICAgIHRoaXMuZGVib3VuY2VkU3VnZ2VzdGlvbiA9IGRlYm91bmNlKFxuICAgICAgICAgICAgKGVkaXRvcjogRWRpdG9yKSA9PiB0aGlzLmNvbW1hbmRzLmdlbmVyYXRlTGl2ZVN1Z2dlc3Rpb24oZWRpdG9yKSxcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc3VnZ2VzdGlvbkRlbGF5XG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gQWRkIHNldHRpbmdzIHRhYlxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IFN5bmFwc2VTZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIC8vIFJlZ2lzdGVyIGNvbW1hbmRzXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2V4cGxhaW4tYW5kLWxpbmsnLFxuICAgICAgICAgICAgbmFtZTogJ0V4cGxhaW4gJiBMaW5rIFNlbGVjdGVkIFRleHQnLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvcikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRzLmV4cGxhaW5BbmRMaW5rKGVkaXRvciwgc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3N1bW1hcml6ZS1ub3RlJyxcbiAgICAgICAgICAgIG5hbWU6ICdTdW1tYXJpemUgQ3VycmVudCBOb3RlJyxcbiAgICAgICAgICAgIGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21tYW5kcy5zdW1tYXJpemVOb3RlKGVkaXRvciwgY29udGVudCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdjcmVhdGUtZmxhc2hjYXJkcycsXG4gICAgICAgICAgICBuYW1lOiAnQ3JlYXRlIEZsYXNoY2FyZHMgZnJvbSBTZWxlY3Rpb24nLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvcikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRzLmNyZWF0ZUZsYXNoY2FyZHMoZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgbmV3IGNoYXQgY29tbWFuZHNcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnc3RhcnQtY2hhdCcsXG4gICAgICAgICAgICBuYW1lOiAnU3RhcnQgTmV3IENoYXQgU2Vzc2lvbicsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21tYW5kcy5zdGFydENoYXRTZXNzaW9uKGVkaXRvcik7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3NlbmQtY2hhdC1tZXNzYWdlJyxcbiAgICAgICAgICAgIG5hbWU6ICdTZW5kIENoYXQgTWVzc2FnZScsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21tYW5kcy5zZW5kQ2hhdE1lc3NhZ2UoZWRpdG9yKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFkZCBjb250ZXh0IG1lbnUgaXRlbXNcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItbWVudScsIChtZW51OiBNZW51LCBlZGl0b3I6IEVkaXRvcikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZSgnXHVEODNFXHVEREUwIEV4cGxhaW4gJiBMaW5rJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbignYnJhaW4tY2lyY3VpdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNvbW1hbmRzLmV4cGxhaW5BbmRMaW5rKGVkaXRvciwgc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKCdcdUQ4M0NcdURGQjQgQ3JlYXRlIEZsYXNoY2FyZHMnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdjYXJkLXN0YWNrJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuY29tbWFuZHMuY3JlYXRlRmxhc2hjYXJkcyhlZGl0b3IsIHNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoJ1x1RDgzRFx1RENERCBTdW1tYXJpemUgTm90ZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbignbGlzdC1jaGVja3MnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNvbW1hbmRzLnN1bW1hcml6ZU5vdGUoZWRpdG9yLCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEFkZCBjaGF0IG9wdGlvblxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVOYW1lID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKT8uYmFzZW5hbWUgfHwgJyc7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGVOYW1lLnN0YXJ0c1dpdGgoJ0NoYXQtJykpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKCdcdUQ4M0RcdURDQUMgU2VuZCBDaGF0IE1lc3NhZ2UnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdtZXNzYWdlLXNxdWFyZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNvbW1hbmRzLnNlbmRDaGF0TWVzc2FnZShlZGl0b3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoJ1x1RDgzRFx1RENBQyBTdGFydCBDaGF0IFNlc3Npb24nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdtZXNzYWdlLWNpcmNsZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNvbW1hbmRzLnN0YXJ0Q2hhdFNlc3Npb24oZWRpdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlZ2lzdGVyIGVkaXRvciBldmVudCBmb3IgbGl2ZSBzdWdnZXN0aW9uc1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1jaGFuZ2UnLCAoZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWJvdW5jZWRTdWdnZXN0aW9uKGVkaXRvcik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBPbGxhbWEgYXZhaWxhYmlsaXR5IG9uIHN0YXJ0dXBcbiAgICAgICAgdGhpcy5jaGVja09sbGFtYUNvbm5lY3Rpb24oKTtcblxuICAgICAgICBjb25zb2xlLmxvZygnU3luYXBzZSBwbHVnaW4gbG9hZGVkJyk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTeW5hcHNlIHBsdWdpbiB1bmxvYWRlZCcpO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICAvLyBVcGRhdGUgY29tbWFuZHMgd2l0aCBuZXcgc2V0dGluZ3NcbiAgICAgICAgdGhpcy5jb21tYW5kcy51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlLWluaXRpYWxpemUgZGVib3VuY2VkIHN1Z2dlc3Rpb24gd2l0aCBuZXcgZGVsYXlcbiAgICAgICAgdGhpcy5kZWJvdW5jZWRTdWdnZXN0aW9uID0gZGVib3VuY2UoXG4gICAgICAgICAgICAoZWRpdG9yOiBFZGl0b3IpID0+IHRoaXMuY29tbWFuZHMuZ2VuZXJhdGVMaXZlU3VnZ2VzdGlvbihlZGl0b3IpLFxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zdWdnZXN0aW9uRGVsYXlcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSBldmVudCBsaXN0ZW5lcnMgZm9yIGxpdmUgc3VnZ2VzdGlvbnNcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlTGl2ZVN1Z2dlc3Rpb25zKSB7XG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItY2hhbmdlJywgKGVkaXRvcjogRWRpdG9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVib3VuY2VkU3VnZ2VzdGlvbihlZGl0b3IpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBjaGVja09sbGFtYUNvbm5lY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IGlzQXZhaWxhYmxlID0gYXdhaXQgdGhpcy5vbGxhbWEuaXNBdmFpbGFibGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghaXNBdmFpbGFibGUpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXG4gICAgICAgICAgICAgICAgJ1N5bmFwc2U6IENhbm5vdCBjb25uZWN0IHRvIE9sbGFtYS4gUGxlYXNlIG1ha2Ugc3VyZSBPbGxhbWEgaXMgcnVubmluZyBvbiAnICsgXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5vbGxhbWFVcmwsIFxuICAgICAgICAgICAgICAgIDgwMDBcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdTeW5hcHNlOiBDb25uZWN0ZWQgdG8gT2xsYW1hIHN1Y2Nlc3NmdWxseScsIDMwMDApO1xuICAgICAgICB9XG4gICAgfVxufSIsICJleHBvcnQgaW50ZXJmYWNlIFN5bmFwc2VTZXR0aW5ncyB7XG4gICAgb2xsYW1hVXJsOiBzdHJpbmc7XG4gICAgb2xsYW1hTW9kZWw6IHN0cmluZztcbiAgICBhdXRvTGlua0VuYWJsZWQ6IGJvb2xlYW47XG4gICAgc3VtbWFyeUxvY2F0aW9uOiAndG9wJyB8ICdib3R0b20nO1xuICAgIGZsYXNoY2FyZEZvcm1hdDogJ3NpbXBsZScgfCAnc3BhY2VkJztcbiAgICBtYXhSZXNwb25zZUxlbmd0aDogbnVtYmVyO1xuICAgIGV4cGxhbmF0aW9uRm9sZGVyOiBzdHJpbmc7XG4gICAgZmxhc2hjYXJkRm9sZGVyOiBzdHJpbmc7XG4gICAgdXNlU3VtbWFyeVlhbWw6IGJvb2xlYW47XG4gICAgY2hhdEZvbGRlcjogc3RyaW5nO1xuICAgIGVuYWJsZUxpdmVDaGF0OiBib29sZWFuO1xuICAgIGVuYWJsZUxpdmVTdWdnZXN0aW9uczogYm9vbGVhbjtcbiAgICBzdWdnZXN0aW9uRGVsYXk6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFN5bmFwc2VTZXR0aW5ncyA9IHtcbiAgICBvbGxhbWFVcmw6ICdodHRwOi8vbG9jYWxob3N0OjExNDM0JyxcbiAgICBvbGxhbWFNb2RlbDogJ2dlbW1hM246ZTJiJyxcbiAgICBhdXRvTGlua0VuYWJsZWQ6IHRydWUsXG4gICAgc3VtbWFyeUxvY2F0aW9uOiAndG9wJyxcbiAgICBmbGFzaGNhcmRGb3JtYXQ6ICdzaW1wbGUnLFxuICAgIG1heFJlc3BvbnNlTGVuZ3RoOiAxMDAwLFxuICAgIGV4cGxhbmF0aW9uRm9sZGVyOiAnRXhwbGFuYXRpb25zJyxcbiAgICBmbGFzaGNhcmRGb2xkZXI6ICdGbGFzaGNhcmRzJyxcbiAgICB1c2VTdW1tYXJ5WWFtbDogdHJ1ZSxcbiAgICBjaGF0Rm9sZGVyOiAnQ2hhdHMnLFxuICAgIGVuYWJsZUxpdmVDaGF0OiB0cnVlLFxuICAgIGVuYWJsZUxpdmVTdWdnZXN0aW9uczogZmFsc2UsXG4gICAgc3VnZ2VzdGlvbkRlbGF5OiAxMDAwXG59O1xuIiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBTeW5hcHNlUGx1Z2luIGZyb20gJy4uL21haW4nO1xuaW1wb3J0IHsgT2xsYW1hQ2xpZW50IH0gZnJvbSAnLi4vb2xsYW1hJztcblxuZXhwb3J0IGNsYXNzIFN5bmFwc2VTZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogU3luYXBzZVBsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFN5bmFwc2VQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1N5bmFwc2UgU2V0dGluZ3MnIH0pO1xuXG4gICAgICAgIC8vIE9sbGFtYSBDb25maWd1cmF0aW9uXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ09sbGFtYSBDb25maWd1cmF0aW9uJyB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdPbGxhbWEgVVJMJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdVUkwgd2hlcmUgT2xsYW1hIGlzIHJ1bm5pbmcgKGRlZmF1bHQ6IGh0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignaHR0cDovL2xvY2FsaG9zdDoxMTQzNCcpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9sbGFtYVVybClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9sbGFtYVVybCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnTW9kZWwnKVxuICAgICAgICAgICAgLnNldERlc2MoJ09sbGFtYSBtb2RlbCB0byB1c2UgKGUuZy4sIHBoaTM6bWluaSwgbGxhbWEyLCBtaXN0cmFsKScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3BoaTM6bWluaScpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9sbGFtYU1vZGVsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub2xsYW1hTW9kZWwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIFRlc3QgY29ubmVjdGlvbiBidXR0b25cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnVGVzdCBDb25uZWN0aW9uJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUZXN0IGNvbm5lY3Rpb24gdG8gT2xsYW1hJylcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdUZXN0JylcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsaWVudCA9IG5ldyBPbGxhbWFDbGllbnQodGhpcy5wbHVnaW4uc2V0dGluZ3Mub2xsYW1hVXJsLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbGxhbWFNb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQXZhaWxhYmxlID0gYXdhaXQgY2xpZW50LmlzQXZhaWxhYmxlKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNBdmFpbGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdcdTI3MTMgQ29ubmVjdGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uYnV0dG9uRWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyM0Y2FmNTAnO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoJ1Rlc3QnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uYnV0dG9uRWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdcdTI3MTcgRmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uYnV0dG9uRWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyNmNDQzMzYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoJ1Rlc3QnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uYnV0dG9uRWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAvLyBGZWF0dXJlIFNldHRpbmdzXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0ZlYXR1cmUgU2V0dGluZ3MnIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0F1dG8tbGlua2luZycpXG4gICAgICAgICAgICAuc2V0RGVzYygnQXV0b21hdGljYWxseSBjcmVhdGUgbGlua3Mgd2hlbiB1c2luZyBcIkV4cGxhaW4gJiBMaW5rXCInKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9MaW5rRW5hYmxlZClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9MaW5rRW5hYmxlZCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU3VtbWFyeSBMb2NhdGlvbicpXG4gICAgICAgICAgICAuc2V0RGVzYygnV2hlcmUgdG8gcGxhY2Ugc3VtbWFyaWVzIGluIG5vdGVzJylcbiAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ3RvcCcsICdUb3Agb2Ygbm90ZScpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignYm90dG9tJywgJ0JvdHRvbSBvZiBub3RlJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3VtbWFyeUxvY2F0aW9uKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWU6ICd0b3AnIHwgJ2JvdHRvbScpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3VtbWFyeUxvY2F0aW9uID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnVXNlIFlBTUwgZm9yIFN1bW1hcmllcycpXG4gICAgICAgICAgICAuc2V0RGVzYygnQWRkIHN1bW1hcmllcyB0byBub3RlIGZyb250bWF0dGVyIGFzIFlBTUwnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVN1bW1hcnlZYW1sKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlU3VtbWFyeVlhbWwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ01heCBSZXNwb25zZSBMZW5ndGgnKVxuICAgICAgICAgICAgLnNldERlc2MoJ01heGltdW0gbGVuZ3RoIGZvciBBSSByZXNwb25zZXMgKGNoYXJhY3RlcnMpJylcbiAgICAgICAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxuICAgICAgICAgICAgICAgIC5zZXRMaW1pdHMoNTAwLCAzMDAwLCAxMDApXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heFJlc3BvbnNlTGVuZ3RoKVxuICAgICAgICAgICAgICAgIC5zZXREeW5hbWljVG9vbHRpcCgpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhSZXNwb25zZUxlbmd0aCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIC8vIEZvbGRlciBvcmdhbml6YXRpb25cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnRm9sZGVyIE9yZ2FuaXphdGlvbicgfSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdFeHBsYW5hdGlvbnMgRm9sZGVyJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdGb2xkZXIgZm9yIGV4cGxhbmF0aW9uIG5vdGVzIChlbXB0eSBmb3IgdmF1bHQgcm9vdCknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFeHBsYW5hdGlvbnMnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHBsYW5hdGlvbkZvbGRlcilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4cGxhbmF0aW9uRm9sZGVyID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRmxhc2hjYXJkcyBGb2xkZXInKVxuICAgICAgICAgICAgLnNldERlc2MoJ0ZvbGRlciBmb3IgZmxhc2hjYXJkIG5vdGVzIChlbXB0eSBmb3IgdmF1bHQgcm9vdCknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdGbGFzaGNhcmRzJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZmxhc2hjYXJkRm9sZGVyKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmxhc2hjYXJkRm9sZGVyID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQ2hhdCBGb2xkZXInKVxuICAgICAgICAgICAgLnNldERlc2MoJ0ZvbGRlciBmb3IgY2hhdCBzZXNzaW9uIG5vdGVzIChlbXB0eSBmb3IgdmF1bHQgcm9vdCknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdDaGF0cycpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNoYXRGb2xkZXIpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jaGF0Rm9sZGVyID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgLy8gTGl2ZSBmZWF0dXJlc1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdMaXZlIEZlYXR1cmVzJyB9KTtcbiAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0VuYWJsZSBMaXZlIENoYXQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0VuYWJsZSBpbnRlcmFjdGl2ZSBjaGF0IHNlc3Npb25zIGluIG5vdGVzJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaXZlQ2hhdClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUxpdmVDaGF0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRW5hYmxlIExpdmUgU3VnZ2VzdGlvbnMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1Byb3ZpZGUgc3VnZ2VzdGlvbnMgYXMgeW91IHR5cGUgKGV4cGVyaW1lbnRhbCknKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUxpdmVTdWdnZXN0aW9ucylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUxpdmVTdWdnZXN0aW9ucyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1N1Z2dlc3Rpb24gRGVsYXknKVxuICAgICAgICAgICAgLnNldERlc2MoJ0RlbGF5IGJlZm9yZSBzaG93aW5nIHN1Z2dlc3Rpb25zIChtaWxsaXNlY29uZHMpJylcbiAgICAgICAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxuICAgICAgICAgICAgICAgIC5zZXRMaW1pdHMoNTAwLCA1MDAwLCAxMDApXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnN1Z2dlc3Rpb25EZWxheSlcbiAgICAgICAgICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3VnZ2VzdGlvbkRlbGF5ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgLnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnMpO1xuXG4gICAgICAgIC8vIFVzYWdlIEluc3RydWN0aW9uc1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdVc2FnZSBJbnN0cnVjdGlvbnMnIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25zID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGluc3RydWN0aW9ucy5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8cD48c3Ryb25nPkNvbW1hbmRzIGF2YWlsYWJsZTo8L3N0cm9uZz48L3A+XG4gICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgPGxpPjxzdHJvbmc+RXhwbGFpbiAmIExpbms6PC9zdHJvbmc+IFNlbGVjdCB0ZXh0IGFuZCB1c2UgY29tbWFuZCBwYWxldHRlIG9yIHJpZ2h0LWNsaWNrIG1lbnU8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT48c3Ryb25nPlN1bW1hcml6ZSBOb3RlOjwvc3Ryb25nPiBSdW4gY29tbWFuZCB0byBzdW1tYXJpemUgZW50aXJlIGN1cnJlbnQgbm90ZTwvbGk+XG4gICAgICAgICAgICAgICAgPGxpPjxzdHJvbmc+Q3JlYXRlIEZsYXNoY2FyZHM6PC9zdHJvbmc+IFNlbGVjdCB0ZXh0IHRvIGdlbmVyYXRlIHN0dWR5IGZsYXNoY2FyZHM8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT48c3Ryb25nPlN0YXJ0IENoYXQgU2Vzc2lvbjo8L3N0cm9uZz4gQmVnaW4gYW4gaW50ZXJhY3RpdmUgY2hhdCB3aXRoIHRoZSBBSTwvbGk+XG4gICAgICAgICAgICAgICAgPGxpPjxzdHJvbmc+U2VuZCBDaGF0IE1lc3NhZ2U6PC9zdHJvbmc+IEluIGEgY2hhdCBub3RlLCBzZW5kIHRoZSBjdXJyZW50IGxpbmUgdG8gdGhlIEFJPC9saT5cbiAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgICA8cD48c3Ryb25nPlJlcXVpcmVtZW50czo8L3N0cm9uZz4gTWFrZSBzdXJlIE9sbGFtYSBpcyBpbnN0YWxsZWQgYW5kIHJ1bm5pbmcgd2l0aCB5b3VyIHNlbGVjdGVkIG1vZGVsLjwvcD5cbiAgICAgICAgYDtcbiAgICB9XG59IiwgImV4cG9ydCBpbnRlcmZhY2UgT2xsYW1hUmVzcG9uc2Uge1xuICAgIHJlc3BvbnNlOiBzdHJpbmc7XG4gICAgZG9uZTogYm9vbGVhbjtcbiAgICBjb250ZXh0PzogbnVtYmVyW107XG59XG5cbmV4cG9ydCBjbGFzcyBPbGxhbWFDbGllbnQge1xuICAgIHByaXZhdGUgYmFzZVVybDogc3RyaW5nO1xuICAgIHByaXZhdGUgbW9kZWw6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKGJhc2VVcmw6IHN0cmluZywgbW9kZWw6IHN0cmluZykge1xuICAgICAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsLnJlcGxhY2UoL1xcLyQvLCAnJyk7IC8vIFJlbW92ZSB0cmFpbGluZyBzbGFzaFxuICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgfVxuXG4gICAgYXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuYmFzZVVybH0vYXBpL3RhZ3NgKTtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5vaztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGdlbmVyYXRlKHByb21wdDogc3RyaW5nLCBzeXN0ZW1Qcm9tcHQ/OiBzdHJpbmcsIGNoYXRIaXN0b3J5Pzogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIElmIGNoYXQgaGlzdG9yeSBpcyBwcm92aWRlZCwgZm9ybWF0IGl0IG5pY2VseVxuICAgICAgICAgICAgbGV0IGZ1bGxQcm9tcHQgPSBwcm9tcHQ7XG4gICAgICAgICAgICBpZiAoY2hhdEhpc3RvcnkgJiYgY2hhdEhpc3RvcnkudHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgZnVsbFByb21wdCA9IGBDaGF0IGhpc3Rvcnk6XFxuJHtjaGF0SGlzdG9yeX1cXG5cXG5DdXJyZW50IG1lc3NhZ2U6ICR7cHJvbXB0fWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0ge1xuICAgICAgICAgICAgICAgIG1vZGVsOiB0aGlzLm1vZGVsLFxuICAgICAgICAgICAgICAgIHByb21wdDogZnVsbFByb21wdCxcbiAgICAgICAgICAgICAgICBzeXN0ZW06IHN5c3RlbVByb21wdCB8fCAnJyxcbiAgICAgICAgICAgICAgICBzdHJlYW06IGZhbHNlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICAgICAgdG9wX3A6IDAuOSxcbiAgICAgICAgICAgICAgICAgICAgdG9wX2s6IDQwLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9hcGkvZ2VuZXJhdGVgLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBkYXRhOiBPbGxhbWFSZXNwb25zZSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLnJlc3BvbnNlLnRyaW0oKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGdlbmVyYXRlIHJlc3BvbnNlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2FwaS90YWdzYCk7XG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggbW9kZWxzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLm1vZGVscz8ubWFwKChtb2RlbDogYW55KSA9PiBtb2RlbC5uYW1lKSB8fCBbXTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG1vZGVsczonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgRWRpdG9yLCBURmlsZSwgTm90aWNlLCBBcHAsIE1hcmtkb3duVmlldyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IE9sbGFtYUNsaWVudCB9IGZyb20gJy4vb2xsYW1hJztcbmltcG9ydCB7IFN5bmFwc2VTZXR0aW5ncyB9IGZyb20gJy4vc2V0dGluZ3MnO1xuXG5leHBvcnQgY2xhc3MgU3luYXBzZUNvbW1hbmRzIHtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgb2xsYW1hOiBPbGxhbWFDbGllbnQ7XG4gICAgcHJpdmF0ZSBzZXR0aW5nczogU3luYXBzZVNldHRpbmdzO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIG9sbGFtYTogT2xsYW1hQ2xpZW50LCBzZXR0aW5nczogU3luYXBzZVNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLm9sbGFtYSA9IG9sbGFtYTtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIH1cblxuICAgIHVwZGF0ZVNldHRpbmdzKHNldHRpbmdzOiBTeW5hcHNlU2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgICAgICB0aGlzLm9sbGFtYSA9IG5ldyBPbGxhbWFDbGllbnQoc2V0dGluZ3Mub2xsYW1hVXJsLCBzZXR0aW5ncy5vbGxhbWFNb2RlbCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZXhwbGFpbkFuZExpbmsoZWRpdG9yOiBFZGl0b3IsIHNlbGVjdGVkVGV4dDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghc2VsZWN0ZWRUZXh0LnRyaW0oKSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIGV4cGxhaW4nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vdGljZUxvYWRpbmcgPSBuZXcgTm90aWNlKCdHZW5lcmF0aW5nIGV4cGxhbmF0aW9uLi4uJywgMCk7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgZXhwbGFuYXRpb25cbiAgICAgICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGEgaGVscGZ1bCBlZHVjYXRpb25hbCBhc3Npc3RhbnQuIENyZWF0ZSBhIGNsZWFyLCBjb25jaXNlIGV4cGxhbmF0aW9uIG9mIHRoZSBnaXZlbiBjb25jZXB0LiBcbiAgICAgICAgICAgIEZvcm1hdCB5b3VyIHJlc3BvbnNlIGFzIGEgd2VsbC1zdHJ1Y3R1cmVkIG5vdGUgd2l0aDpcbiAgICAgICAgICAgIDEuIEEgYnJpZWYgZGVmaW5pdGlvblxuICAgICAgICAgICAgMi4gS2V5IGNoYXJhY3RlcmlzdGljcyBvciBwcm9wZXJ0aWVzXG4gICAgICAgICAgICAzLiBBIHNpbXBsZSBhbmFsb2d5IG9yIGV4YW1wbGUgaWYgaGVscGZ1bFxuICAgICAgICAgICAgNC4gV2h5IHRoaXMgY29uY2VwdCBpcyBpbXBvcnRhbnRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgS2VlcCB0aGUgZXhwbGFuYXRpb24gdW5kZXIgJHt0aGlzLnNldHRpbmdzLm1heFJlc3BvbnNlTGVuZ3RofSBjaGFyYWN0ZXJzIGFuZCB1c2UgY2xlYXIsIGVkdWNhdGlvbmFsIGxhbmd1YWdlLmA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IGBFeHBsYWluIHRoaXMgY29uY2VwdDogXCIke3NlbGVjdGVkVGV4dH1cImA7XG4gICAgICAgICAgICBjb25zdCBleHBsYW5hdGlvbiA9IGF3YWl0IHRoaXMub2xsYW1hLmdlbmVyYXRlKHByb21wdCwgc3lzdGVtUHJvbXB0KTtcblxuICAgICAgICAgICAgLy8gQ3JlYXRlIG5vdGUgZmlsZW5hbWUgKHNhbml0aXplKVxuICAgICAgICAgICAgY29uc3Qgbm90ZVRpdGxlID0gdGhpcy5zYW5pdGl6ZUZpbGVOYW1lKHNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENyZWF0ZSBmb2xkZXIgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgICAgICAgYXdhaXQgdGhpcy5lbnN1cmVGb2xkZXJFeGlzdHModGhpcy5zZXR0aW5ncy5leHBsYW5hdGlvbkZvbGRlcik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENyZWF0ZSBwYXRoIHdpdGggZm9sZGVyXG4gICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGAke3RoaXMuc2V0dGluZ3MuZXhwbGFuYXRpb25Gb2xkZXJ9LyR7bm90ZVRpdGxlfS5tZGA7XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGlmIG5vdGUgYWxyZWFkeSBleGlzdHNcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG4gICAgICAgICAgICBpZiAoZXhpc3RpbmdGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBOb3RlIFwiJHtub3RlVGl0bGV9XCIgYWxyZWFkeSBleGlzdHNgKTtcbiAgICAgICAgICAgICAgICBub3RpY2VMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgbm90ZSBjb250ZW50XG4gICAgICAgICAgICBjb25zdCBub3RlQ29udGVudCA9IGAjICR7bm90ZVRpdGxlfVxuXG4ke2V4cGxhbmF0aW9ufVxuXG4tLS1cbipHZW5lcmF0ZWQgYnkgU3luYXBzZSBBSSpcbipDcmVhdGVkOiAke25ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9KmA7XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgbmV3IG5vdGVcbiAgICAgICAgICAgIGNvbnN0IG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZmlsZVBhdGgsIG5vdGVDb250ZW50KTtcblxuICAgICAgICAgICAgLy8gSW5zZXJ0IGxpbmsgaW4gY3VycmVudCBlZGl0b3JcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBgW1ske2ZpbGVQYXRoLnJlcGxhY2UoJy5tZCcsICcnKX18JHtub3RlVGl0bGV9XV1gO1xuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24obGluayk7XG5cbiAgICAgICAgICAgIC8vIE9wZW4gdGhlIG5ldyBub3RlXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLm9wZW5GaWxlKG5ld0ZpbGUpO1xuXG4gICAgICAgICAgICBub3RpY2VMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYENyZWF0ZWQgYW5kIGxpbmtlZCBub3RlOiAke25vdGVUaXRsZX1gKTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbm90aWNlTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXhwbGFpbiBhbmQgTGluayBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBzdW1tYXJpemVOb3RlKGVkaXRvcjogRWRpdG9yLCBjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCFjb250ZW50LnRyaW0oKSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gY29udGVudCB0byBzdW1tYXJpemUnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vdGljZUxvYWRpbmcgPSBuZXcgTm90aWNlKCdHZW5lcmF0aW5nIHN1bW1hcnkuLi4nLCAwKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgYSBoZWxwZnVsIGFzc2lzdGFudCB0aGF0IGNyZWF0ZXMgY29uY2lzZSBzdW1tYXJpZXMuIFxuICAgICAgICAgICAgQ3JlYXRlIGEgYnVsbGV0LXBvaW50IHN1bW1hcnkgKDMtNSBwb2ludHMpIG9mIHRoZSBtYWluIGlkZWFzIGluIHRoZSBnaXZlbiB0ZXh0LiBcbiAgICAgICAgICAgIEVhY2ggYnVsbGV0IHBvaW50IHNob3VsZCBiZSBjbGVhciBhbmQgY2FwdHVyZSBhIGtleSBjb25jZXB0LlxuICAgICAgICAgICAgRm9ybWF0IGFzIG1hcmtkb3duIGJ1bGxldHMgc3RhcnRpbmcgd2l0aCBcIi0gXCIuYDtcblxuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gYFN1bW1hcml6ZSB0aGlzIGNvbnRlbnQ6XFxuXFxuJHtjb250ZW50fWA7XG4gICAgICAgICAgICBjb25zdCBzdW1tYXJ5ID0gYXdhaXQgdGhpcy5vbGxhbWEuZ2VuZXJhdGUocHJvbXB0LCBzeXN0ZW1Qcm9tcHQpO1xuXG4gICAgICAgICAgICAvLyBGb3JtYXQgc3VtbWFyeSBiYXNlZCBvbiBzZXR0aW5nc1xuICAgICAgICAgICAgbGV0IHN1bW1hcnlTZWN0aW9uO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy51c2VTdW1tYXJ5WWFtbCkge1xuICAgICAgICAgICAgICAgIC8vIEZvcm1hdCBhcyBZQU1MXG4gICAgICAgICAgICAgICAgc3VtbWFyeVNlY3Rpb24gPSBgLS0tXG5zdW1tYXJ5OlxuJHtzdW1tYXJ5LnNwbGl0KCdcXG4nKS5tYXAobGluZSA9PiBgICAke2xpbmV9YCkuam9pbignXFxuJyl9XG4tLS1cblxuYDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gRm9ybWF0IGFzIHJlZ3VsYXIgbWFya2Rvd25cbiAgICAgICAgICAgICAgICBzdW1tYXJ5U2VjdGlvbiA9IGAjIyBTdW1tYXJ5XG5cbiR7c3VtbWFyeX1cblxuLS0tXG5cbmA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEluc2VydCBzdW1tYXJ5IGF0IHNwZWNpZmllZCBsb2NhdGlvblxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3Muc3VtbWFyeUxvY2F0aW9uID09PSAndG9wJykge1xuICAgICAgICAgICAgICAgIC8vIEZpbmQgZmlyc3QgaGVhZGluZyBvciBpbnNlcnQgYXQgYmVnaW5uaW5nXG4gICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICBsZXQgaW5zZXJ0SW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFNraXAgZnJvbnQgbWF0dGVyIGlmIGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1swXT8uc3RhcnRzV2l0aCgnLS0tJykpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZEZyb250TWF0dGVyID0gbGluZXMuZmluZEluZGV4KChsaW5lLCBpKSA9PiBpID4gMCAmJiBsaW5lLnN0YXJ0c1dpdGgoJy0tLScpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuZEZyb250TWF0dGVyICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0SW5kZXggPSBlbmRGcm9udE1hdHRlciArIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSdyZSB1c2luZyBZQU1MIGFuZCB0aGVyZSdzIGFscmVhZHkgZnJvbnRtYXR0ZXIsIHdlIG5lZWQgdG8gbWVyZ2UgdGhlbVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnVzZVN1bW1hcnlZYW1sICYmIGxpbmVzWzBdPy5zdGFydHNXaXRoKCctLS0nKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRGcm9udE1hdHRlciA9IGxpbmVzLmZpbmRJbmRleCgobGluZSwgaSkgPT4gaSA+IDAgJiYgbGluZS5zdGFydHNXaXRoKCctLS0nKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbmRGcm9udE1hdHRlciAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV4dHJhY3QgZXhpc3RpbmcgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRnJvbnRtYXR0ZXIgPSBsaW5lcy5zbGljZSgwLCBlbmRGcm9udE1hdHRlciArIDEpLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGNsb3NpbmcgZGVsaW1pdGVyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcGVuRnJvbnRtYXR0ZXIgPSBleGlzdGluZ0Zyb250bWF0dGVyLnJlcGxhY2UoLy0tLVxccyokLywgJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHN1bW1hcnkgdG8gZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1bW1hcnlZYW1sID0gYHN1bW1hcnk6XG4ke3N1bW1hcnkuc3BsaXQoJ1xcbicpLm1hcChsaW5lID0+IGAgICR7bGluZX1gKS5qb2luKCdcXG4nKX1cbi0tLWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDb21iaW5lXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDb250ZW50ID0gb3BlbkZyb250bWF0dGVyICsgc3VtbWFyeVlhbWwgKyAnXFxuXFxuJyArIGxpbmVzLnNsaWNlKGVuZEZyb250TWF0dGVyICsgMSkuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0VmFsdWUobmV3Q29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub3RpY2VMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1N1bW1hcnkgYWRkZWQgdG8gZnJvbnRtYXR0ZXInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBbXG4gICAgICAgICAgICAgICAgICAgIC4uLmxpbmVzLnNsaWNlKDAsIGluc2VydEluZGV4KSxcbiAgICAgICAgICAgICAgICAgICAgJycsXG4gICAgICAgICAgICAgICAgICAgIHN1bW1hcnlTZWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICAuLi5saW5lcy5zbGljZShpbnNlcnRJbmRleClcbiAgICAgICAgICAgICAgICBdLmpvaW4oJ1xcbicpO1xuXG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldFZhbHVlKG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYXQgYm90dG9tXG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldFZhbHVlKGNvbnRlbnQgKyAnXFxuXFxuJyArIHN1bW1hcnlTZWN0aW9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbm90aWNlTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdTdW1tYXJ5IGFkZGVkIHRvIG5vdGUnKTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbm90aWNlTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignU3VtbWFyaXplIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGNyZWF0ZUZsYXNoY2FyZHMoZWRpdG9yOiBFZGl0b3IsIHNlbGVjdGVkVGV4dDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghc2VsZWN0ZWRUZXh0LnRyaW0oKSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIGNyZWF0ZSBmbGFzaGNhcmRzIGZyb20nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vdGljZUxvYWRpbmcgPSBuZXcgTm90aWNlKCdDcmVhdGluZyBmbGFzaGNhcmRzLi4uJywgMCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGEgaGVscGZ1bCBhc3Npc3RhbnQgdGhhdCBjcmVhdGVzIHN0dWR5IGZsYXNoY2FyZHMuIFxuICAgICAgICAgICAgRnJvbSB0aGUgZ2l2ZW4gdGV4dCwgaWRlbnRpZnkgMy03IGtleSBjb25jZXB0cyBhbmQgY3JlYXRlIGZsYXNoY2FyZHMgaW4gdGhpcyBleGFjdCBmb3JtYXQ6XG5cbiAgICAgICAgICAgICoqUToqKiBRdWVzdGlvbiBoZXJlP1xuICAgICAgICAgICAgKipBOioqIEFuc3dlciBoZXJlXG5cbiAgICAgICAgICAgIE1ha2UgcXVlc3Rpb25zIGNsZWFyIGFuZCBzcGVjaWZpYy4gQW5zd2VycyBzaG91bGQgYmUgY29uY2lzZSBidXQgY29tcGxldGUuXG4gICAgICAgICAgICBGb2N1cyBvbiB0aGUgbW9zdCBpbXBvcnRhbnQgY29uY2VwdHMgZm9yIGxlYXJuaW5nIGFuZCByZXRlbnRpb24uYDtcblxuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSBmbGFzaGNhcmRzIGZyb20gdGhpcyBjb250ZW50OlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgICAgICBjb25zdCBmbGFzaGNhcmRzID0gYXdhaXQgdGhpcy5vbGxhbWEuZ2VuZXJhdGUocHJvbXB0LCBzeXN0ZW1Qcm9tcHQpO1xuXG4gICAgICAgICAgICAvLyBEZWNpZGUgaWYgd2Ugc2hvdWxkIGNyZWF0ZSBhIG5ldyBmbGFzaGNhcmQgbm90ZSBvciBpbnNlcnQgaW50byBjdXJyZW50IG5vdGVcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgY29uc3Qgbm90ZVRpdGxlID0gYWN0aXZlRmlsZSA/IGFjdGl2ZUZpbGUuYmFzZW5hbWUgOiBcIlVudGl0bGVkXCI7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENyZWF0ZSBmbGFzaGNhcmRzIG5vdGUgaW4gZGVkaWNhdGVkIGZvbGRlclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5lbnN1cmVGb2xkZXJFeGlzdHModGhpcy5zZXR0aW5ncy5mbGFzaGNhcmRGb2xkZXIpO1xuICAgICAgICAgICAgY29uc3QgZmxhc2hjYXJkRmlsZU5hbWUgPSBgJHt0aGlzLnNldHRpbmdzLmZsYXNoY2FyZEZvbGRlcn0vJHtub3RlVGl0bGV9IC0gRmxhc2hjYXJkcy5tZGA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGZsYXNoY2FyZENvbnRlbnQgPSBgIyBGbGFzaGNhcmRzIGZvciAke25vdGVUaXRsZX1cblxuJHtmbGFzaGNhcmRzfVxuXG4tLS1cbipHZW5lcmF0ZWQgZnJvbTogW1ske2FjdGl2ZUZpbGUgPyBhY3RpdmVGaWxlLnBhdGgucmVwbGFjZSgnLm1kJywgJycpIDogJ1Vua25vd24gc291cmNlJ31dXSpcbipDcmVhdGVkOiAke25ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9KlxuYDtcblxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgZmxhc2hjYXJkIGZpbGUgZXhpc3RzIGFuZCBhcHBlbmQgb3IgY3JlYXRlXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmxhc2hjYXJkRmlsZU5hbWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZXhpc3RpbmdGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdG8gZXhpc3RpbmcgZmlsZVxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZXhpc3RpbmdGaWxlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdDb250ZW50ID0gZXhpc3RpbmdDb250ZW50ICsgXCJcXG5cXG4jIyBOZXcgRmxhc2hjYXJkc1xcblxcblwiICsgZmxhc2hjYXJkcztcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZXhpc3RpbmdGaWxlLCBuZXdDb250ZW50KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBPcGVuIHRoZSBmaWxlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShleGlzdGluZ0ZpbGUpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIG5vdGljZUxvYWRpbmcuaGlkZSgpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0FkZGVkIGZsYXNoY2FyZHMgdG8gZXhpc3Rpbmcgbm90ZScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGZpbGVcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdGaWxlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZsYXNoY2FyZEZpbGVOYW1lLCBmbGFzaGNhcmRDb250ZW50KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBPcGVuIHRoZSBmaWxlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShuZXdGaWxlKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBub3RpY2VMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdDcmVhdGVkIG5ldyBmbGFzaGNhcmRzIG5vdGUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQWxzbyBhZGQgbGluayB0byBjdXJyZW50IG5vdGVcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBgXFxuXFxuW1ske2ZsYXNoY2FyZEZpbGVOYW1lLnJlcGxhY2UoJy5tZCcsICcnKX18Rmxhc2hjYXJkcyBmb3IgdGhpcyBub3RlXV1cXG5gO1xuICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgZWRpdG9yLnNldExpbmUoY3Vyc29yLmxpbmUsIGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKSArIGxpbmspO1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBub3RpY2VMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDcmVhdGUgRmxhc2hjYXJkcyBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBzdGFydENoYXRTZXNzaW9uKGVkaXRvcjogRWRpdG9yKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vIENyZWF0ZSBhIG5ldyBjaGF0IG5vdGUgaW4gdGhlIGNoYXQgZm9sZGVyXG4gICAgICAgIGF3YWl0IHRoaXMuZW5zdXJlRm9sZGVyRXhpc3RzKHRoaXMuc2V0dGluZ3MuY2hhdEZvbGRlcik7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvWzouXS9nLCAnLScpO1xuICAgICAgICBjb25zdCBjaGF0RmlsZU5hbWUgPSBgJHt0aGlzLnNldHRpbmdzLmNoYXRGb2xkZXJ9L0NoYXQtJHt0aW1lc3RhbXB9Lm1kYDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGNoYXRUZW1wbGF0ZSA9IGAjIENoYXQgU2Vzc2lvbiAke25ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKX1cblxuIyMgQ29udGV4dFxuKlRoaXMgaXMgYSBjaGF0IHNlc3Npb24gd2l0aCBTeW5hcHNlIEFJLiBUeXBlIHlvdXIgbWVzc2FnZXMgYWZ0ZXIgdGhlID4gcHJvbXB0LipcblxuIyMgQ2hhdFxuXG4+IFxuXG5gO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbmV3RmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShjaGF0RmlsZU5hbWUsIGNoYXRUZW1wbGF0ZSk7XG4gICAgICAgIFxuICAgICAgICAvLyBPcGVuIHRoZSBmaWxlXG4gICAgICAgIGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpO1xuICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKG5ld0ZpbGUpO1xuICAgICAgICBcbiAgICAgICAgLy8gUG9zaXRpb24gY3Vyc29yIGF0IHRoZSBwcm9tcHRcbiAgICAgICAgY29uc3QgbmV3RWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKG5ld0VkaXRvcikge1xuICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjaGF0VGVtcGxhdGUuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0TGluZSA9IGxpbmVzLmZpbmRJbmRleChsaW5lID0+IGxpbmUgPT09ICc+ICcpO1xuICAgICAgICAgICAgaWYgKHByb21wdExpbmUgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgbmV3RWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IHByb21wdExpbmUsIGNoOiAyIH0pO1xuICAgICAgICAgICAgICAgIG5ld0VkaXRvci5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBuZXcgTm90aWNlKCdTdGFydGVkIG5ldyBjaGF0IHNlc3Npb24nKTtcbiAgICB9XG5cbiAgICBhc3luYyBzZW5kQ2hhdE1lc3NhZ2UoZWRpdG9yOiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gRmluZCB0aGUgY3VycmVudCBjaGF0IG1lc3NhZ2UgKGxpbmUgc3RhcnRpbmcgd2l0aCAnPicpXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZTtcbiAgICAgICAgXG4gICAgICAgIC8vIExvY2F0ZSB0aGUgcHJvbXB0XG4gICAgICAgIGxldCBwcm9tcHRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgIHdoaWxlIChwcm9tcHRMaW5lID49IDAgJiYgIWxpbmVzW3Byb21wdExpbmVdLnN0YXJ0c1dpdGgoJz4nKSkge1xuICAgICAgICAgICAgcHJvbXB0TGluZS0tO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAocHJvbXB0TGluZSA8IDApIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIGNoYXQgcHJvbXB0IGZvdW5kLiBQbGVhc2Ugc3RhcnQgbWVzc2FnZSB3aXRoID4nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBtZXNzYWdlXG4gICAgICAgIGNvbnN0IHVzZXJNZXNzYWdlID0gbGluZXNbcHJvbXB0TGluZV0uc3Vic3RyaW5nKDIpLnRyaW0oKTtcbiAgICAgICAgaWYgKCF1c2VyTWVzc2FnZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIHR5cGUgYSBtZXNzYWdlIGZpcnN0Jyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgY2hhdCB3aXRoIHRoZSB1c2VyIG1lc3NhZ2VcbiAgICAgICAgbGluZXNbcHJvbXB0TGluZV0gPSBgPiAke3VzZXJNZXNzYWdlfWA7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgYSBsb2FkaW5nIGluZGljYXRvclxuICAgICAgICBsaW5lcy5zcGxpY2UocHJvbXB0TGluZSArIDEsIDAsICdcXG5fU3luYXBzZSBpcyB0aGlua2luZy4uLl8nKTtcbiAgICAgICAgZWRpdG9yLnNldFZhbHVlKGxpbmVzLmpvaW4oJ1xcbicpKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBjaGF0IGhpc3RvcnkgZm9yIGNvbnRleHRcbiAgICAgICAgY29uc3QgY2hhdEhpc3RvcnkgPSB0aGlzLmV4dHJhY3RDaGF0SGlzdG9yeShsaW5lcywgcHJvbXB0TGluZSk7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgcmVzcG9uc2VcbiAgICAgICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGEgaGVscGZ1bCBBSSBhc3Npc3RhbnQgaW4gYSBjaGF0IHNlc3Npb24uIFxuICAgICAgICAgICAgUHJvdmlkZSB0aG91Z2h0ZnVsLCBjb25jaXNlIHJlc3BvbnNlcyB0byB0aGUgdXNlcidzIHF1ZXN0aW9ucy5cbiAgICAgICAgICAgIFVzZSBtYXJrZG93biBmb3JtYXR0aW5nIHdoZW4gYXBwcm9wcmlhdGUuXG4gICAgICAgICAgICBSZWZlcmVuY2UgcHJpb3IgbWVzc2FnZXMgaW4gdGhlIGNvbnZlcnNhdGlvbiB3aGVuIHJlbGV2YW50LmA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5vbGxhbWEuZ2VuZXJhdGUodXNlck1lc3NhZ2UsIHN5c3RlbVByb21wdCwgY2hhdEhpc3RvcnkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBSZW1vdmUgbG9hZGluZyBpbmRpY2F0b3JcbiAgICAgICAgICAgIGxpbmVzLnNwbGljZShwcm9tcHRMaW5lICsgMSwgMSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBBSSByZXNwb25zZSBhbmQgbmV3IHByb21wdFxuICAgICAgICAgICAgbGluZXMuc3BsaWNlKHByb21wdExpbmUgKyAxLCAwLCBcbiAgICAgICAgICAgICAgICBgXFxuJHtyZXNwb25zZX1cXG5gLFxuICAgICAgICAgICAgICAgIGA+IGBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGVkaXRvci5zZXRWYWx1ZShsaW5lcy5qb2luKCdcXG4nKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNldCBjdXJzb3IgdG8gbmV3IHByb21wdFxuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IHByb21wdExpbmUgKyAzLCBjaDogMiB9KTtcbiAgICAgICAgICAgIGVkaXRvci5mb2N1cygpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NoYXQgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBSZW1vdmUgbG9hZGluZyBpbmRpY2F0b3IgYW5kIGFkZCBlcnJvciBtZXNzYWdlXG4gICAgICAgICAgICBsaW5lcy5zcGxpY2UocHJvbXB0TGluZSArIDEsIDEpO1xuICAgICAgICAgICAgbGluZXMuc3BsaWNlKHByb21wdExpbmUgKyAxLCAwLCAnX0Vycm9yOiBDb3VsZCBub3QgZ2VuZXJhdGUgcmVzcG9uc2VfJyk7XG4gICAgICAgICAgICBlZGl0b3Iuc2V0VmFsdWUobGluZXMuam9pbignXFxuJykpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIGFzeW5jIGdlbmVyYXRlTGl2ZVN1Z2dlc3Rpb24oZWRpdG9yOiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmVuYWJsZUxpdmVTdWdnZXN0aW9ucykgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGN1cnJlbnQgY29udGV4dFxuICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBjdXJzb3IubGluZTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBhIGZldyBsaW5lcyBiZWZvcmUgY3VycmVudCBsaW5lIGZvciBjb250ZXh0XG4gICAgICAgIGNvbnN0IGNvbnRleHRMaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpLnNsaWNlKE1hdGgubWF4KDAsIGN1cnJlbnRMaW5lIC0gMTApLCBjdXJyZW50TGluZSArIDEpO1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gY29udGV4dExpbmVzLmpvaW4oJ1xcbicpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnRleHQudHJpbSgpLmxlbmd0aCA8IDEwKSByZXR1cm47IC8vIE5vdCBlbm91Z2ggY29udGV4dFxuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHN1Z2dlc3Rpb25cbiAgICAgICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGFuIEFJIHdyaXRpbmcgYXNzaXN0YW50LiBcbiAgICAgICAgICAgIEJhc2VkIG9uIHRoZSBjb250ZXh0IHByb3ZpZGVkLCBzdWdnZXN0IGEgYnJpZWYgY29udGludWF0aW9uICgxLTIgc2VudGVuY2VzIG1heCkuXG4gICAgICAgICAgICBNYWtlIHlvdXIgc3VnZ2VzdGlvbiBkaXJlY3RseSByZWxldmFudCB0byB3aGF0J3MgYmVpbmcgd3JpdHRlbi5cbiAgICAgICAgICAgIERvIG5vdCByZXBlYXQgd2hhdCdzIGFscmVhZHkgd3JpdHRlbi5gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMub2xsYW1hLmdlbmVyYXRlKGBDb250aW51ZSB0aGlzIHRleHQ6ICR7Y29udGV4dH1gLCBzeXN0ZW1Qcm9tcHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBEaXNwbGF5IHN1Z2dlc3Rpb24gYXMgZ2hvc3QgdGV4dCBvciBub3RpY2VcbiAgICAgICAgICAgIC8vIFRoaXMgd291bGQgdHlwaWNhbGx5IGJlIGltcGxlbWVudGVkIHRocm91Z2ggYSBtb3JlIGNvbXBsZXggVUkgY29tcG9uZW50XG4gICAgICAgICAgICAvLyBGb3Igbm93LCB3ZSdsbCB1c2UgYSBub3RpY2VcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFN1Z2dlc3Rpb246ICR7cmVzcG9uc2Uuc3Vic3RyaW5nKDAsIDEwMCl9JHtyZXNwb25zZS5sZW5ndGggPiAxMDAgPyAnLi4uJyA6ICcnfWAsIDUwMDApO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignU3VnZ2VzdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHNhbml0aXplRmlsZU5hbWUodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgLy8gUmVtb3ZlIG9yIHJlcGxhY2UgaW52YWxpZCBjaGFyYWN0ZXJzIGZvciBmaWxlIG5hbWVzXG4gICAgICAgIHJldHVybiB0ZXh0XG4gICAgICAgICAgICAucmVwbGFjZSgvW15cXHdcXHMtXS9nLCAnJykgLy8gUmVtb3ZlIHNwZWNpYWwgY2hhcmFjdGVycyBleGNlcHQgd29yZCBjaGFycywgc3BhY2VzLCBoeXBoZW5zXG4gICAgICAgICAgICAucmVwbGFjZSgvXFxzKy9nLCAnICcpIC8vIFJlcGxhY2UgbXVsdGlwbGUgc3BhY2VzIHdpdGggc2luZ2xlIHNwYWNlXG4gICAgICAgICAgICAudHJpbSgpXG4gICAgICAgICAgICAuc3Vic3RyaW5nKDAsIDUwKTsgLy8gTGltaXQgbGVuZ3RoXG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgYXN5bmMgZW5zdXJlRm9sZGVyRXhpc3RzKGZvbGRlclBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIWZvbGRlclBhdGgpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZvbGRlcnMgPSBmb2xkZXJQYXRoLnNwbGl0KCcvJykuZmlsdGVyKHAgPT4gcC50cmltKCkpO1xuICAgICAgICBsZXQgY3VycmVudFBhdGggPSAnJztcbiAgICAgICAgXG4gICAgICAgIGZvciAoY29uc3QgZm9sZGVyIG9mIGZvbGRlcnMpIHtcbiAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gY3VycmVudFBhdGggPyBgJHtjdXJyZW50UGF0aH0vJHtmb2xkZXJ9YCA6IGZvbGRlcjtcbiAgICAgICAgICAgIGlmICghdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGN1cnJlbnRQYXRoKSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihjdXJyZW50UGF0aCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGNyZWF0ZSBmb2xkZXIgJHtjdXJyZW50UGF0aH06YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBwcml2YXRlIGdldEFjdGl2ZUVkaXRvcigpOiBFZGl0b3IgfCBudWxsIHtcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIHJldHVybiB2aWV3Py5lZGl0b3IgfHwgbnVsbDtcbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBleHRyYWN0Q2hhdEhpc3RvcnkobGluZXM6IHN0cmluZ1tdLCBjdXJyZW50UHJvbXB0TGluZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAgICAgLy8gRXh0cmFjdCBhbGwgcHJldmlvdXMgZXhjaGFuZ2VzIHRvIGdpdmUgY29udGV4dCB0byB0aGUgQUlcbiAgICAgICAgbGV0IGNoYXRIaXN0b3J5ID0gJyc7XG4gICAgICAgIGxldCBpbkNoYXQgPSBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3VycmVudFByb21wdExpbmU7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSd2ZSByZWFjaGVkIHRoZSBjaGF0IHNlY3Rpb25cbiAgICAgICAgICAgIGlmIChsaW5lID09PSAnIyMgQ2hhdCcpIHtcbiAgICAgICAgICAgICAgICBpbkNoYXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoaW5DaGF0KSB7XG4gICAgICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgnPiAnKSkge1xuICAgICAgICAgICAgICAgICAgICBjaGF0SGlzdG9yeSArPSBgVXNlcjogJHtsaW5lLnN1YnN0cmluZygyKX1cXG5gO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluZS50cmltKCkgJiYgIWxpbmUuc3RhcnRzV2l0aCgnXycpICYmIGxpbmUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYXRIaXN0b3J5ICs9IGBBSTogJHtsaW5lfVxcbmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY2hhdEhpc3Rvcnk7XG4gICAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBcUU7OztBQ2dCOUQsSUFBTSxtQkFBb0M7QUFBQSxFQUM3QyxXQUFXO0FBQUEsRUFDWCxhQUFhO0FBQUEsRUFDYixpQkFBaUI7QUFBQSxFQUNqQixpQkFBaUI7QUFBQSxFQUNqQixpQkFBaUI7QUFBQSxFQUNqQixtQkFBbUI7QUFBQSxFQUNuQixtQkFBbUI7QUFBQSxFQUNuQixpQkFBaUI7QUFBQSxFQUNqQixnQkFBZ0I7QUFBQSxFQUNoQixZQUFZO0FBQUEsRUFDWixnQkFBZ0I7QUFBQSxFQUNoQix1QkFBdUI7QUFBQSxFQUN2QixpQkFBaUI7QUFDckI7OztBQzlCQSxzQkFBK0M7OztBQ014QyxJQUFNLGVBQU4sTUFBbUI7QUFBQSxFQUl0QixZQUFZLFNBQWlCLE9BQWU7QUFDeEMsU0FBSyxVQUFVLFFBQVEsUUFBUSxPQUFPLEVBQUU7QUFDeEMsU0FBSyxRQUFRO0FBQUEsRUFDakI7QUFBQSxFQUVBLE1BQU0sY0FBZ0M7QUFDbEMsUUFBSTtBQUNBLFlBQU0sV0FBVyxNQUFNLE1BQU0sR0FBRyxLQUFLLGtCQUFrQjtBQUN2RCxhQUFPLFNBQVM7QUFBQSxJQUNwQixTQUFTLE9BQVA7QUFDRSxhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFBQSxFQUVBLE1BQU0sU0FBUyxRQUFnQixjQUF1QixhQUF1QztBQUN6RixRQUFJO0FBRUEsVUFBSSxhQUFhO0FBQ2pCLFVBQUksZUFBZSxZQUFZLEtBQUssR0FBRztBQUNuQyxxQkFBYTtBQUFBLEVBQWtCO0FBQUE7QUFBQSxtQkFBbUM7QUFBQSxN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SyxRQUFRLENBQUMsU0FBUztBQUNuQixpQkFDSyxTQUFTLDZCQUFzQixFQUMvQixRQUFRLGdCQUFnQixFQUN4QixRQUFRLFlBQVk7QUFDakIsb0JBQU0sS0FBSyxTQUFTLGdCQUFnQixNQUFNO0FBQUEsWUFDOUMsQ0FBQztBQUFBLFVBQ1QsQ0FBQztBQUFBLFFBQ0wsT0FBTztBQUNILGVBQUssUUFBUSxDQUFDLFNBQVM7QUFDbkIsaUJBQ0ssU0FBUyw4QkFBdUIsRUFDaEMsUUFBUSxnQkFBZ0IsRUFDeEIsUUFBUSxZQUFZO0FBQ2pCLG9CQUFNLEtBQUssU0FBUyxpQkFBaUIsTUFBTTtBQUFBLFlBQy9DLENBQUM7QUFBQSxVQUNULENBQUM7QUFBQSxRQUNMO0FBQUEsTUFDSixDQUFDO0FBQUEsSUFDTDtBQUdBLFFBQUksS0FBSyxTQUFTLHVCQUF1QjtBQUNyQyxXQUFLO0FBQUEsUUFDRCxLQUFLLElBQUksVUFBVSxHQUFHLGlCQUFpQixDQUFDLFdBQW1CO0FBQ3ZELGVBQUssb0JBQW9CLE1BQU07QUFBQSxRQUNuQyxDQUFDO0FBQUEsTUFDTDtBQUFBLElBQ0o7QUFHQSxTQUFLLHNCQUFzQjtBQUUzQixZQUFRLElBQUksdUJBQXVCO0FBQUEsRUFDdkM7QUFBQSxFQUVBLFdBQVc7QUFDUCxZQUFRLElBQUkseUJBQXlCO0FBQUEsRUFDekM7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixTQUFLLFdBQVcsT0FBTyxPQUFPLENBQUMsR0FBRyxrQkFBa0IsTUFBTSxLQUFLLFNBQVMsQ0FBQztBQUFBLEVBQzdFO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDakIsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBRWpDLFNBQUssU0FBUyxlQUFlLEtBQUssUUFBUTtBQUcxQyxTQUFLLDBCQUFzQjtBQUFBLE1BQ3ZCLENBQUMsV0FBbUIsS0FBSyxTQUFTLHVCQUF1QixNQUFNO0FBQUEsTUFDL0QsS0FBSyxTQUFTO0FBQUEsSUFDbEI7QUFHQSxRQUFJLEtBQUssU0FBUyx1QkFBdUI7QUFDckMsV0FBSztBQUFBLFFBQ0QsS0FBSyxJQUFJLFVBQVUsR0FBRyxpQkFBaUIsQ0FBQyxXQUFtQjtBQUN2RCxlQUFLLG9CQUFvQixNQUFNO0FBQUEsUUFDbkMsQ0FBQztBQUFBLE1BQ0w7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBYyx3QkFBd0I7QUFDbEMsVUFBTSxjQUFjLE1BQU0sS0FBSyxPQUFPLFlBQVk7QUFFbEQsUUFBSSxDQUFDLGFBQWE7QUFDZCxVQUFJO0FBQUEsUUFDQSw4RUFDQSxLQUFLLFNBQVM7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUFBLElBQ0osT0FBTztBQUNILFVBQUksd0JBQU8sNkNBQTZDLEdBQUk7QUFBQSxJQUNoRTtBQUFBLEVBQ0o7QUFDSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJuZXdDb250ZW50Il0KfQo=
