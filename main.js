/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => SynapsePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/settings.ts
var DEFAULT_SETTINGS = {
  ollamaUrl: "http://localhost:11434",
  ollamaModel: "gemma3n:e2b",
  autoLinkEnabled: true,
  summaryLocation: "top",
  flashcardFormat: "simple",
  maxResponseLength: 1e3,
  explanationFolder: "Synapse/Explanations",
  flashcardFolder: "Synapse/Flashcards",
  useSummaryYaml: true,
  chatFolder: "Synapse/Chats",
  enableLiveChat: true,
  enableLiveSuggestions: false,
  suggestionDelay: 3e3,
  showGhostText: true,
  allowQuickAccept: true,
  templatePath: "",
  useTemplateForExplanations: false,
  globalSystemPrompt: "You are a helpful educational assistant providing concise, accurate information.",
  chatSystemPrompt: "You are a helpful AI assistant in a chat session. Provide thoughtful, concise responses to the user's questions. Use markdown formatting when appropriate. Reference prior messages in the conversation when relevant.",
  explanationSystemPrompt: "You are a helpful educational assistant. Create a clear, concise explanation of the given concept. Format your response as a well-structured note with:\n1. A brief definition\n2. Key characteristics or properties\n3. A simple analogy or example if helpful\n4. Why this concept is important\n\nKeep the explanation under {{maxResponseLength}} characters and use clear, educational language.",
  summarySystemPrompt: 'You are a helpful assistant that creates concise summaries. Create a bullet-point summary (3-5 points) of the main ideas in the given text. Each bullet point should be clear and capture a key concept. Format as markdown bullets starting with "- ".',
  flashcardSystemPrompt: "You are a helpful assistant that creates study flashcards. From the given text, identify 3-7 key concepts and create flashcards in this exact format:\n\n**Q:** Question here?\n**A:** Answer here\n\nMake questions clear and specific. Answers should be concise but complete. Focus on the most important concepts for learning and retention.",
  customTemplateVariables: {},
  addSynapseTag: true,
  synapseTag: "synapse"
};

// src/ui/SettingsTab.ts
var import_obsidian = require("obsidian");

// src/ollama.ts
var OllamaClient = class {
  constructor(baseUrl, model) {
    this.baseUrl = baseUrl.replace(/\/$/, "");
    this.model = model;
  }
  async isAvailable() {
    try {
      const response = await fetch(`${this.baseUrl}/api/tags`);
      return response.ok;
    } catch (error) {
      return false;
    }
  }
  async generate(prompt, systemPrompt, chatHistory) {
    try {
      let fullPrompt = prompt;
      if (chatHistory && chatHistory.trim()) {
        fullPrompt = `Chat history:
${chatHistory}

Current message: ${prompt}`;
      }
      const requestBody = {
        model: this.model,
        prompt: fullPrompt,
        system: systemPrompt || "",
        stream: false,
        options: {
          temperature: 0.7,
          top_p: 0.9,
          top_k: 40
        }
      };
      const response = await fetch(`${this.baseUrl}/api/generate`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(requestBody)
      });
      if (!response.ok) {
        throw new Error(`Ollama API error: ${response.status}`);
      }
      const data = await response.json();
      return data.response.trim();
    } catch (error) {
      throw new Error(`Failed to generate response: ${error.message}`);
    }
  }
  async getAvailableModels() {
    var _a;
    try {
      const response = await fetch(`${this.baseUrl}/api/tags`);
      if (!response.ok) {
        throw new Error(`Failed to fetch models: ${response.status}`);
      }
      const data = await response.json();
      return ((_a = data.models) == null ? void 0 : _a.map((model) => model.name)) || [];
    } catch (error) {
      console.error("Error fetching models:", error);
      return [];
    }
  }
};

// src/ui/SettingsTab.ts
var SynapseSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.addClass("synapse-settings");
    const tabContainer = containerEl.createDiv("synapse-settings-tabs");
    const tabContent = containerEl.createDiv("synapse-settings-content");
    const generalTab = tabContainer.createDiv("synapse-tab");
    generalTab.setText("General");
    generalTab.addClass("active");
    const promptsTab = tabContainer.createDiv("synapse-tab");
    promptsTab.setText("AI Prompts");
    const templatesTab = tabContainer.createDiv("synapse-tab");
    templatesTab.setText("Templates");
    const advancedTab = tabContainer.createDiv("synapse-tab");
    advancedTab.setText("Advanced");
    const generalContent = tabContent.createDiv("synapse-tab-content");
    generalContent.addClass("active");
    const promptsContent = tabContent.createDiv("synapse-tab-content");
    promptsContent.style.display = "none";
    const templatesContent = tabContent.createDiv("synapse-tab-content");
    templatesContent.style.display = "none";
    const advancedContent = tabContent.createDiv("synapse-tab-content");
    advancedContent.style.display = "none";
    const tabs = [generalTab, promptsTab, templatesTab, advancedTab];
    const contents = [generalContent, promptsContent, templatesContent, advancedContent];
    tabs.forEach((tab, index) => {
      tab.addEventListener("click", () => {
        tabs.forEach((t) => t.removeClass("active"));
        contents.forEach((c) => c.style.display = "none");
        tab.addClass("active");
        contents[index].style.display = "block";
      });
    });
    generalContent.createEl("h3", { text: "Ollama" });
    new import_obsidian.Setting(generalContent).setName("Ollama URL").setDesc("URL where Ollama is running (default: http://localhost:11434)").addText((text) => text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.ollamaUrl).onChange(async (value) => {
      this.plugin.settings.ollamaUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(generalContent).setName("Model").setDesc("Ollama model to use (e.g., phi3:mini, gemma3n:e2b, mistral)").addText((text) => text.setPlaceholder("phi3:mini").setValue(this.plugin.settings.ollamaModel).onChange(async (value) => {
      this.plugin.settings.ollamaModel = value;
      await this.plugin.saveSettings();
    }));
    const modelContainer = generalContent.createDiv("synapse-model-selector");
    const modelSetting = new import_obsidian.Setting(modelContainer).setName("Select Available Model").setDesc("Choose from models available in your Ollama installation");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      dropdown.addOption("", "Loading models...");
      dropdown.setValue("");
      dropdown.onChange(async (value) => {
        if (value) {
          this.plugin.settings.ollamaModel = value;
          await this.plugin.saveSettings();
        }
      });
    });
    this.loadAvailableModels(modelDropdown);
    new import_obsidian.Setting(generalContent).setName("Test Connection").setDesc("Test connection to Ollama").addButton((button) => {
      button.setButtonText("Test");
      button.setCta();
      button.buttonEl.addClass("synapse-test-button");
      button.onClick(async () => {
        const client = new OllamaClient(this.plugin.settings.ollamaUrl, this.plugin.settings.ollamaModel);
        const isAvailable = await client.isAvailable();
        if (isAvailable) {
          button.setButtonText("\u2713 Connected");
          button.buttonEl.style.backgroundColor = "#4caf50";
          setTimeout(() => {
            button.setButtonText("Test");
            button.buttonEl.style.backgroundColor = "";
          }, 2e3);
        } else {
          button.setButtonText("\u2717 Failed");
          button.buttonEl.style.backgroundColor = "#f44336";
          setTimeout(() => {
            button.setButtonText("Test");
            button.buttonEl.style.backgroundColor = "";
          }, 2e3);
        }
      });
    });
    generalContent.createEl("h3", { text: "Features" });
    new import_obsidian.Setting(generalContent).setName("Auto-linking").setDesc('Automatically create links when using "Explain & Link"').addToggle((toggle) => toggle.setValue(this.plugin.settings.autoLinkEnabled).onChange(async (value) => {
      this.plugin.settings.autoLinkEnabled = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(generalContent).setName("Summary Location").setDesc("Where to place summaries in notes").addDropdown((dropdown) => dropdown.addOption("top", "Top of note").addOption("bottom", "Bottom of note").setValue(this.plugin.settings.summaryLocation).onChange(async (value) => {
      this.plugin.settings.summaryLocation = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(generalContent).setName("Use YAML for Summaries").setDesc("Add summaries to note frontmatter as YAML").addToggle((toggle) => toggle.setValue(this.plugin.settings.useSummaryYaml).onChange(async (value) => {
      this.plugin.settings.useSummaryYaml = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(generalContent).setName("Max Response Length").setDesc("Maximum length for AI responses (characters)").addSlider((slider) => slider.setLimits(500, 3e3, 100).setValue(this.plugin.settings.maxResponseLength).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.maxResponseLength = value;
      await this.plugin.saveSettings();
    }));
    generalContent.createEl("h3", { text: "Folder Organization" });
    new import_obsidian.Setting(generalContent).setName("Explanations Folder").setDesc("Folder for explanation notes (empty for vault root)").addText((text) => text.setPlaceholder("Explanations").setValue(this.plugin.settings.explanationFolder).onChange(async (value) => {
      this.plugin.settings.explanationFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(generalContent).setName("Flashcards Folder").setDesc("Folder for flashcard notes (empty for vault root)").addText((text) => text.setPlaceholder("Flashcards").setValue(this.plugin.settings.flashcardFolder).onChange(async (value) => {
      this.plugin.settings.flashcardFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(generalContent).setName("Chat Folder").setDesc("Folder for chat session notes (empty for vault root)").addText((text) => text.setPlaceholder("Chats").setValue(this.plugin.settings.chatFolder).onChange(async (value) => {
      this.plugin.settings.chatFolder = value;
      await this.plugin.saveSettings();
    }));
    generalContent.createEl("h3", { text: "Note Tagging" });
    new import_obsidian.Setting(generalContent).setName("Add Tags to Notes").setDesc("Automatically add tags to all notes created by Synapse").addToggle((toggle) => toggle.setValue(this.plugin.settings.addSynapseTag).onChange(async (value) => {
      this.plugin.settings.addSynapseTag = value;
      await this.plugin.saveSettings();
      tagInput.setDisabled(!value);
    }));
    let tagInput;
    tagInput = new import_obsidian.Setting(generalContent).setName("Tags").setDesc("Tags to add to notes (comma separated, # optional)").addText((text) => text.setPlaceholder("synapse, ai-generated").setValue(this.plugin.settings.synapseTag).onChange(async (value) => {
      this.plugin.settings.synapseTag = value;
      await this.plugin.saveSettings();
    })).setDisabled(!this.plugin.settings.addSynapseTag);
    promptsContent.createEl("p", {
      text: "Customize the system prompts used for different features. You can use variables like {{maxResponseLength}}, {{date}}, and {{model}}."
    });
    promptsContent.createEl("h3", { text: "Global System Prompt" });
    const globalPromptSetting = new import_obsidian.Setting(promptsContent).setName("Global System Prompt").setDesc("Default system prompt used when no specific prompt is provided");
    let globalPromptArea;
    globalPromptSetting.addTextArea((textarea) => {
      globalPromptArea = textarea;
      textarea.setValue(this.plugin.settings.globalSystemPrompt).setPlaceholder("You are a helpful assistant...").onChange(async (value) => {
        this.plugin.settings.globalSystemPrompt = value;
        await this.plugin.saveSettings();
      });
      textarea.inputEl.rows = 4;
      textarea.inputEl.cols = 50;
    });
    promptsContent.createEl("h3", { text: "Explanation Prompt" });
    const explanationPromptSetting = new import_obsidian.Setting(promptsContent).setName("Explanation System Prompt").setDesc("System prompt used for generating explanations");
    let explanationPromptArea;
    explanationPromptSetting.addTextArea((textarea) => {
      explanationPromptArea = textarea;
      textarea.setValue(this.plugin.settings.explanationSystemPrompt).setPlaceholder("Create a clear, concise explanation...").onChange(async (value) => {
        this.plugin.settings.explanationSystemPrompt = value;
        await this.plugin.saveSettings();
      });
      textarea.inputEl.rows = 6;
      textarea.inputEl.cols = 50;
    });
    promptsContent.createEl("h3", { text: "Summary Prompt" });
    const summaryPromptSetting = new import_obsidian.Setting(promptsContent).setName("Summary System Prompt").setDesc("System prompt used for generating summaries");
    let summaryPromptArea;
    summaryPromptSetting.addTextArea((textarea) => {
      summaryPromptArea = textarea;
      textarea.setValue(this.plugin.settings.summarySystemPrompt).setPlaceholder("Create a bullet-point summary...").onChange(async (value) => {
        this.plugin.settings.summarySystemPrompt = value;
        await this.plugin.saveSettings();
      });
      textarea.inputEl.rows = 4;
      textarea.inputEl.cols = 50;
    });
    promptsContent.createEl("h3", { text: "Flashcard Prompt" });
    const flashcardPromptSetting = new import_obsidian.Setting(promptsContent).setName("Flashcard System Prompt").setDesc("System prompt used for generating flashcards");
    let flashcardPromptArea;
    flashcardPromptSetting.addTextArea((textarea) => {
      flashcardPromptArea = textarea;
      textarea.setValue(this.plugin.settings.flashcardSystemPrompt).setPlaceholder("Create flashcards in this format...").onChange(async (value) => {
        this.plugin.settings.flashcardSystemPrompt = value;
        await this.plugin.saveSettings();
      });
      textarea.inputEl.rows = 6;
      textarea.inputEl.cols = 50;
    });
    promptsContent.createEl("h3", { text: "Chat Prompt" });
    const chatPromptSetting = new import_obsidian.Setting(promptsContent).setName("Chat System Prompt").setDesc("System prompt used for chat sessions");
    let chatPromptArea;
    chatPromptSetting.addTextArea((textarea) => {
      chatPromptArea = textarea;
      textarea.setValue(this.plugin.settings.chatSystemPrompt).setPlaceholder("You are a helpful AI assistant...").onChange(async (value) => {
        this.plugin.settings.chatSystemPrompt = value;
        await this.plugin.saveSettings();
      });
      textarea.inputEl.rows = 4;
      textarea.inputEl.cols = 50;
    });
    new import_obsidian.Setting(promptsContent).setName("Reset Prompts").setDesc("Reset all prompts to default values").addButton((button) => {
      button.setButtonText("Reset to Defaults");
      button.onClick(async () => {
        if (confirm("Are you sure you want to reset all prompts to default values?")) {
          this.plugin.settings.globalSystemPrompt = this.plugin.DEFAULT_SETTINGS.globalSystemPrompt;
          this.plugin.settings.explanationSystemPrompt = this.plugin.DEFAULT_SETTINGS.explanationSystemPrompt;
          this.plugin.settings.summarySystemPrompt = this.plugin.DEFAULT_SETTINGS.summarySystemPrompt;
          this.plugin.settings.flashcardSystemPrompt = this.plugin.DEFAULT_SETTINGS.flashcardSystemPrompt;
          this.plugin.settings.chatSystemPrompt = this.plugin.DEFAULT_SETTINGS.chatSystemPrompt;
          globalPromptArea.setValue(this.plugin.settings.globalSystemPrompt);
          explanationPromptArea.setValue(this.plugin.settings.explanationSystemPrompt);
          summaryPromptArea.setValue(this.plugin.settings.summarySystemPrompt);
          flashcardPromptArea.setValue(this.plugin.settings.flashcardSystemPrompt);
          chatPromptArea.setValue(this.plugin.settings.chatSystemPrompt);
          await this.plugin.saveSettings();
          new Notice("All prompts reset to defaults");
        }
      });
    });
    templatesContent.createEl("p", {
      text: "Configure templates for generated notes. Templates support variables like {{title}}, {{content}}, {{date}}, and custom variables."
    });
    new import_obsidian.Setting(templatesContent).setName("Template File").setDesc("Select a template file for explanation notes").addText((text) => text.setPlaceholder("path/to/template.md").setValue(this.plugin.settings.templatePath).onChange(async (value) => {
      this.plugin.settings.templatePath = value;
      await this.plugin.saveSettings();
    })).addButton((button) => {
      button.setButtonText("Browse");
      button.onClick(async () => {
        const modal = this.createFileSelectionModal((file) => {
          var _a;
          if (file) {
            this.plugin.settings.templatePath = file.path;
            const textInput = (_a = button.buttonEl.parentElement) == null ? void 0 : _a.querySelector("input");
            if (textInput) {
              textInput.value = file.path;
            }
            this.plugin.saveSettings();
          }
        });
        modal.open();
      });
    });
    new import_obsidian.Setting(templatesContent).setName("Use Template for Explanations").setDesc("Use the selected template file for explanation notes").addToggle((toggle) => toggle.setValue(this.plugin.settings.useTemplateForExplanations).onChange(async (value) => {
      this.plugin.settings.useTemplateForExplanations = value;
      await this.plugin.saveSettings();
    }));
    templatesContent.createEl("h3", { text: "Template Variables" });
    templatesContent.createEl("p", {
      text: "Built-in variables: {{title}}\n - note title, {{content}}\n - AI generated content, {{date}}\n - current date, {{query}}\n - original selected text"
    });
    templatesContent.createEl("h3", { text: "Custom Template Variables" });
    const customVarsContainer = templatesContent.createDiv("synapse-custom-vars");
    const refreshCustomVariables = () => {
      customVarsContainer.empty();
      for (const [key, value] of Object.entries(this.plugin.settings.customTemplateVariables)) {
        this.addCustomVariableRow(customVarsContainer, key, value);
      }
      const addVarButton = customVarsContainer.createEl("button", {
        text: "Add Custom Variable",
        cls: "synapse-add-var-button"
      });
      addVarButton.addEventListener("click", () => {
        const newKey = `variable${Object.keys(this.plugin.settings.customTemplateVariables).length + 1}`;
        this.plugin.settings.customTemplateVariables[newKey] = "";
        this.plugin.saveSettings();
        refreshCustomVariables();
      });
    };
    refreshCustomVariables();
    advancedContent.createEl("h3", { text: "Live Features" });
    new import_obsidian.Setting(advancedContent).setName("Enable Live Chat").setDesc("Enable interactive chat sessions in notes").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableLiveChat).onChange(async (value) => {
      this.plugin.settings.enableLiveChat = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(advancedContent).setName("Enable Live Suggestions").setDesc("Provide suggestions as you type (experimental)").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableLiveSuggestions).onChange(async (value) => {
      this.plugin.settings.enableLiveSuggestions = value;
      await this.plugin.saveSettings();
      this.updateLiveFeatureSettingsVisibility();
    }));
    const liveSuggestionsContainer = advancedContent.createDiv("synapse-live-settings");
    liveSuggestionsContainer.createEl("h4", { text: "Live Suggestions" });
    new import_obsidian.Setting(liveSuggestionsContainer).setName("Show Ghost Text").setDesc("Show suggested text completions as you type").addToggle((toggle) => toggle.setValue(this.plugin.settings.showGhostText).onChange(async (value) => {
      this.plugin.settings.showGhostText = value;
      await this.plugin.saveSettings();
    })).setDisabled(!this.plugin.settings.enableLiveSuggestions);
    new import_obsidian.Setting(liveSuggestionsContainer).setName("Allow Quick Accept").setDesc("Show accept button for suggestions").addToggle((toggle) => toggle.setValue(this.plugin.settings.allowQuickAccept).onChange(async (value) => {
      this.plugin.settings.allowQuickAccept = value;
      await this.plugin.saveSettings();
    })).setDisabled(!this.plugin.settings.enableLiveSuggestions);
    new import_obsidian.Setting(liveSuggestionsContainer).setName("Suggestion Delay").setDesc("Delay before showing suggestions (milliseconds)").addSlider((slider) => slider.setLimits(500, 5e3, 100).setValue(this.plugin.settings.suggestionDelay).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.suggestionDelay = value;
      await this.plugin.saveSettings();
    })).setDisabled(!this.plugin.settings.enableLiveSuggestions);
    this.updateLiveFeatureSettingsVisibility();
  }
  updateLiveFeatureSettingsVisibility() {
    const liveSettingsDiv = this.containerEl.querySelector(".synapse-live-settings");
    if (liveSettingsDiv) {
      liveSettingsDiv.style.display = this.plugin.settings.enableLiveSuggestions ? "block" : "none";
    }
  }
  async loadAvailableModels(dropdown) {
    try {
      dropdown.selectEl.empty();
      dropdown.addOption("", "Loading models...");
      const client = new OllamaClient(this.plugin.settings.ollamaUrl, "");
      const models = await client.getAvailableModels();
      dropdown.selectEl.empty();
      if (models.length === 0) {
        dropdown.addOption("", "No models found");
      } else {
        models.forEach((model) => {
          dropdown.addOption(model, model);
        });
        if (models.includes(this.plugin.settings.ollamaModel)) {
          dropdown.setValue(this.plugin.settings.ollamaModel);
        }
      }
    } catch (error) {
      console.error("Error loading models:", error);
      dropdown.selectEl.empty();
      dropdown.addOption("", "Error loading models");
    }
  }
  addCustomVariableRow(container, key, value) {
    const row = container.createDiv("synapse-custom-var-row");
    const keyInput = row.createEl("input", {
      type: "text",
      value: key,
      placeholder: "Variable name"
    });
    const valueInput = row.createEl("input", {
      type: "text",
      value,
      placeholder: "Value"
    });
    const deleteButton = row.createEl("button", {
      text: "\u2715",
      cls: "synapse-delete-var-button"
    });
    keyInput.addEventListener("change", () => {
      delete this.plugin.settings.customTemplateVariables[key];
      this.plugin.settings.customTemplateVariables[keyInput.value] = valueInput.value;
      this.plugin.saveSettings();
    });
    valueInput.addEventListener("change", () => {
      this.plugin.settings.customTemplateVariables[key] = valueInput.value;
      this.plugin.saveSettings();
    });
    deleteButton.addEventListener("click", () => {
      delete this.plugin.settings.customTemplateVariables[key];
      this.plugin.saveSettings();
      row.remove();
    });
  }
  createFileSelectionModal(callback) {
    const { modal, contentEl } = this.createModal("Select Template File");
    const searchEl = contentEl.createEl("input", {
      type: "text",
      placeholder: "Search files..."
    });
    const fileListEl = contentEl.createDiv("synapse-file-list");
    const markdownFiles = this.app.vault.getMarkdownFiles();
    const displayFiles = (files) => {
      fileListEl.empty();
      if (files.length === 0) {
        fileListEl.createEl("div", { text: "No files found" });
        return;
      }
      for (const file of files) {
        const fileItem = fileListEl.createDiv("synapse-file-item");
        fileItem.setText(file.path);
        fileItem.addEventListener("click", () => {
          callback(file);
          modal.close();
        });
      }
    };
    displayFiles(markdownFiles);
    searchEl.addEventListener("input", () => {
      const searchTerm = searchEl.value.toLowerCase();
      const filteredFiles = markdownFiles.filter(
        (file) => file.path.toLowerCase().includes(searchTerm)
      );
      displayFiles(filteredFiles);
    });
    const footerEl = contentEl.createDiv("synapse-modal-footer");
    const cancelButton = footerEl.createEl("button", { text: "Cancel" });
    cancelButton.addEventListener("click", () => {
      callback(null);
      modal.close();
    });
    return modal;
  }
  createModal(title) {
    const modal = new (require("obsidian")).Modal(this.app);
    modal.titleEl.setText(title);
    modal.contentEl.addClass("synapse-modal");
    return { modal, contentEl: modal.contentEl };
  }
};

// src/commands.ts
var import_obsidian2 = require("obsidian");
var SynapseCommands = class {
  constructor(app, ollama, settings) {
    this.app = app;
    this.ollama = ollama;
    this.settings = settings;
  }
  updateSettings(settings) {
    this.settings = settings;
    this.ollama = new OllamaClient(settings.ollamaUrl, settings.ollamaModel);
  }
  async explainAndLink(editor, selectedText) {
    if (!selectedText.trim()) {
      new import_obsidian2.Notice("Please select text to explain");
      return;
    }
    const noticeLoading = new import_obsidian2.Notice("Generating explanation...", 0);
    try {
      const systemPrompt = this.processTemplateVariables(this.settings.explanationSystemPrompt);
      const prompt = `Explain this concept: "${selectedText}"`;
      const explanation = await this.ollama.generate(prompt, systemPrompt);
      const noteTitle = this.sanitizeFileName(selectedText);
      await this.ensureFolderExists(this.settings.explanationFolder);
      const filePath = `${this.settings.explanationFolder}/${noteTitle}.md`;
      const existingFile = this.app.vault.getAbstractFileByPath(filePath);
      if (existingFile instanceof import_obsidian2.TFile) {
        new import_obsidian2.Notice(`Note "${noteTitle}" already exists`);
        noticeLoading.hide();
        return;
      }
      let noteContent;
      if (this.settings.useTemplateForExplanations && this.settings.templatePath) {
        noteContent = await this.generateFromTemplate(
          this.settings.templatePath,
          {
            title: noteTitle,
            content: explanation,
            date: new Date().toLocaleDateString(),
            query: selectedText,
            tags: this.getTagsString(),
            ...this.settings.customTemplateVariables
          }
        );
      } else {
        const tagsLine = this.getTagsString() ? `
tags: ${this.getTagsString()}` : "";
        noteContent = `# ${noteTitle}${tagsLine}

${explanation}

---
*Generated by Synapse AI*
*Created: ${new Date().toLocaleDateString()}*`;
      }
      const newFile = await this.app.vault.create(filePath, noteContent);
      const link = `[[${filePath.replace(".md", "")}|${noteTitle}]]`;
      editor.replaceSelection(link);
      await this.app.workspace.getLeaf().openFile(newFile);
      noticeLoading.hide();
      new import_obsidian2.Notice(`Created and linked note: ${noteTitle}`);
    } catch (error) {
      noticeLoading.hide();
      new import_obsidian2.Notice(`Error: ${error.message}`);
      console.error("Explain and Link error:", error);
    }
  }
  async summarizeNote(editor, content) {
    var _a, _b;
    if (!content.trim()) {
      new import_obsidian2.Notice("No content to summarize");
      return;
    }
    const noticeLoading = new import_obsidian2.Notice("Generating summary...", 0);
    try {
      const systemPrompt = this.processTemplateVariables(this.settings.summarySystemPrompt);
      const prompt = `Summarize this content:

${content}`;
      const summary = await this.ollama.generate(prompt, systemPrompt);
      let summarySection;
      if (this.settings.useSummaryYaml) {
        summarySection = `---
summary:
${summary.split("\n").map((line) => `  ${line}`).join("\n")}
---

`;
      } else {
        summarySection = `## Summary

${summary}

---

`;
      }
      if (this.settings.summaryLocation === "top") {
        const lines = content.split("\n");
        let insertIndex = 0;
        if ((_a = lines[0]) == null ? void 0 : _a.startsWith("---")) {
          let endFrontMatter = lines.findIndex((line, i) => i > 0 && line.startsWith("---"));
          if (endFrontMatter !== -1) {
            insertIndex = endFrontMatter + 1;
          }
        }
        if (this.settings.useSummaryYaml && ((_b = lines[0]) == null ? void 0 : _b.startsWith("---"))) {
          const endFrontMatter = lines.findIndex((line, i) => i > 0 && line.startsWith("---"));
          if (endFrontMatter !== -1) {
            const existingFrontmatter = lines.slice(0, endFrontMatter + 1).join("\n");
            const openFrontmatter = existingFrontmatter.replace(/---\s*$/, "");
            const summaryYaml = `summary:
${summary.split("\n").map((line) => `  ${line}`).join("\n")}
---`;
            const newContent2 = openFrontmatter + summaryYaml + "\n\n" + lines.slice(endFrontMatter + 1).join("\n");
            editor.setValue(newContent2);
            noticeLoading.hide();
            new import_obsidian2.Notice("Summary added to frontmatter");
            return;
          }
        }
        const newContent = [
          ...lines.slice(0, insertIndex),
          "",
          summarySection,
          ...lines.slice(insertIndex)
        ].join("\n");
        editor.setValue(newContent);
      } else {
        editor.setValue(content + "\n\n" + summarySection);
      }
      noticeLoading.hide();
      new import_obsidian2.Notice("Summary added to note");
    } catch (error) {
      noticeLoading.hide();
      new import_obsidian2.Notice(`Error: ${error.message}`);
      console.error("Summarize error:", error);
    }
  }
  async createFlashcards(editor, selectedText) {
    if (!selectedText.trim()) {
      new import_obsidian2.Notice("Please select text to create flashcards from");
      return;
    }
    const noticeLoading = new import_obsidian2.Notice("Creating flashcards...", 0);
    try {
      const systemPrompt = this.processTemplateVariables(this.settings.flashcardSystemPrompt);
      const prompt = `Create flashcards from this content:

${selectedText}`;
      const flashcards = await this.ollama.generate(prompt, systemPrompt);
      const activeFile = this.app.workspace.getActiveFile();
      const noteTitle = activeFile ? activeFile.basename : "Untitled";
      await this.ensureFolderExists(this.settings.flashcardFolder);
      const flashcardFileName = `${this.settings.flashcardFolder}/${noteTitle} - Flashcards.md`;
      const tagsLine = this.getTagsString() ? `
tags: ${this.getTagsString()}` : "";
      const flashcardContent = `# Flashcards for ${noteTitle}${tagsLine}

${flashcards}

---
*Generated from: [[${activeFile ? activeFile.path.replace(".md", "") : "Unknown source"}]]*
*Created: ${new Date().toLocaleDateString()}*
`;
      const existingFile = this.app.vault.getAbstractFileByPath(flashcardFileName);
      if (existingFile instanceof import_obsidian2.TFile) {
        const existingContent = await this.app.vault.read(existingFile);
        const newContent = existingContent + "\n\n## New Flashcards\n\n" + flashcards;
        await this.app.vault.modify(existingFile, newContent);
        await this.app.workspace.getLeaf().openFile(existingFile);
        noticeLoading.hide();
        new import_obsidian2.Notice("Added flashcards to existing note");
      } else {
        const newFile = await this.app.vault.create(flashcardFileName, flashcardContent);
        await this.app.workspace.getLeaf().openFile(newFile);
        noticeLoading.hide();
        new import_obsidian2.Notice("Created new flashcards note");
      }
      const link = `

[[${flashcardFileName.replace(".md", "")}|Flashcards for this note]]
`;
      const cursor = editor.getCursor();
      editor.setLine(cursor.line, editor.getLine(cursor.line) + link);
    } catch (error) {
      noticeLoading.hide();
      new import_obsidian2.Notice(`Error: ${error.message}`);
      console.error("Create Flashcards error:", error);
    }
  }
  async startChatSession(editor) {
    await this.ensureFolderExists(this.settings.chatFolder);
    const timestamp = new Date().toISOString().replace(/[:.]/g, "-");
    const chatFileName = `${this.settings.chatFolder}/Chat-${timestamp}.md`;
    const tagsLine = this.getTagsString() ? `
tags: ${this.getTagsString()}` : "";
    const chatTemplate = `# Chat Session ${new Date().toLocaleString()}${tagsLine}

## Context
*This is a chat session with Synapse AI. Type your messages after the > prompt.*

## Chat

> 

`;
    const newFile = await this.app.vault.create(chatFileName, chatTemplate);
    const leaf = this.app.workspace.getLeaf();
    await leaf.openFile(newFile);
    const newEditor = this.getActiveEditor();
    if (newEditor) {
      const lines = chatTemplate.split("\n");
      const promptLine = lines.findIndex((line) => line === "> ");
      if (promptLine !== -1) {
        newEditor.setCursor({ line: promptLine, ch: 2 });
        newEditor.focus();
      }
    }
    new import_obsidian2.Notice("Started new chat session");
  }
  async sendChatMessage(editor) {
    const content = editor.getValue();
    const lines = content.split("\n");
    const currentLine = editor.getCursor().line;
    let promptLine = currentLine;
    while (promptLine >= 0 && !lines[promptLine].startsWith(">")) {
      promptLine--;
    }
    if (promptLine < 0) {
      new import_obsidian2.Notice("No chat prompt found. Please start message with >");
      return;
    }
    const userMessage = lines[promptLine].substring(2).trim();
    if (!userMessage) {
      new import_obsidian2.Notice("Please type a message first");
      return;
    }
    lines[promptLine] = `> ${userMessage}`;
    lines.splice(promptLine + 1, 0, "\n_Synapse is thinking..._");
    editor.setValue(lines.join("\n"));
    const chatHistory = this.extractChatHistory(lines, promptLine);
    try {
      const systemPrompt = this.processTemplateVariables(this.settings.chatSystemPrompt);
      const response = await this.ollama.generate(userMessage, systemPrompt, chatHistory);
      lines.splice(promptLine + 1, 1);
      lines.splice(
        promptLine + 1,
        0,
        `
${response}
`,
        `> `
      );
      const scrollInfo = editor.getScrollInfo ? editor.getScrollInfo() : null;
      editor.setValue(lines.join("\n"));
      setTimeout(() => {
        const updatedContent = editor.getValue();
        const updatedLines = updatedContent.split("\n");
        let newPromptLine = -1;
        for (let i = promptLine + 1; i < updatedLines.length; i++) {
          if (updatedLines[i] === "> ") {
            newPromptLine = i;
            break;
          }
        }
        if (newPromptLine >= 0) {
          editor.setCursor({ line: newPromptLine, ch: 2 });
          const cmEditor = editor.cm;
          if (cmEditor) {
            if (cmEditor.scrollIntoView) {
              cmEditor.scrollIntoView({
                line: newPromptLine,
                ch: 2
              }, 100);
            }
          } else {
            editor.scrollIntoView({
              from: { line: newPromptLine, ch: 0 },
              to: { line: newPromptLine, ch: 2 }
            }, true);
          }
          const editorElement = document.querySelector(".cm-scroller");
          if (editorElement) {
            editorElement.scrollTop = editorElement.scrollHeight;
          }
          editor.focus();
        }
      }, 100);
    } catch (error) {
      new import_obsidian2.Notice(`Error: ${error.message}`);
      console.error("Chat error:", error);
      lines.splice(promptLine + 1, 1);
      lines.splice(promptLine + 1, 0, "_Error: Could not generate response_");
      editor.setValue(lines.join("\n"));
    }
  }
  async generateLiveSuggestion(editor) {
    if (!this.settings.enableLiveSuggestions)
      return;
    const content = editor.getValue();
    const cursor = editor.getCursor();
    const currentLine = cursor.line;
    const contextLines = content.split("\n").slice(Math.max(0, currentLine - 10), currentLine + 5);
    const context = contextLines.join("\n");
    if (context.trim().length < 5)
      return;
    try {
      const systemPrompt = `You are an AI writing assistant. 
            Based on the context provided, suggest a brief continuation (1-3 words maximum).
            Make your suggestion directly relevant to what's being written.
            Do not repeat what's already written. 
            Only return the continuation text. Do not include any additional text or formatting.`;
      const response = await this.ollama.generate(`Continue this text: ${context}`, systemPrompt);
      this.displayGhostText(editor, response);
    } catch (error) {
      console.error("Suggestion error:", error);
    }
  }
  displayGhostText(editor, text) {
    if (!this.settings.showGhostText)
      return;
    const notice = new import_obsidian2.Notice(`Suggestion: ${text.substring(0, 50)}${text.length > 50 ? "..." : ""}`, 5e3);
    if (this.settings.allowQuickAccept) {
      const noticeEl = notice.noticeEl;
      const buttonContainer = noticeEl.createDiv("synapse-suggestion-actions");
      const acceptButton = buttonContainer.createEl("button", {
        text: "Accept",
        cls: "synapse-accept-button"
      });
      acceptButton.addEventListener("click", () => {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
        notice.hide();
      });
    }
  }
  // New method to process template variables in prompts
  processTemplateVariables(text) {
    let processed = text;
    processed = processed.replace(/{{maxResponseLength}}/g, this.settings.maxResponseLength.toString());
    processed = processed.replace(/{{model}}/g, this.settings.ollamaModel);
    processed = processed.replace(/{{date}}/g, new Date().toLocaleDateString());
    for (const [key, value] of Object.entries(this.settings.customTemplateVariables)) {
      processed = processed.replace(new RegExp(`{{${key}}}`, "g"), value);
    }
    return processed;
  }
  // New method to generate note content from template
  async generateFromTemplate(templatePath, variables) {
    try {
      const templateFile = this.app.vault.getAbstractFileByPath(templatePath);
      if (!(templateFile instanceof import_obsidian2.TFile)) {
        throw new Error(`Template file not found: ${templatePath}`);
      }
      let templateContent = await this.app.vault.read(templateFile);
      for (const [key, value] of Object.entries(variables)) {
        templateContent = templateContent.replace(new RegExp(`{{${key}}}`, "g"), value);
      }
      return templateContent;
    } catch (error) {
      console.error("Template error:", error);
      throw new Error(`Failed to process template: ${error.message}`);
    }
  }
  sanitizeFileName(text) {
    return text.replace(/[^\w\s-]/g, "").replace(/\s+/g, " ").trim().substring(0, 50);
  }
  async ensureFolderExists(folderPath) {
    if (!folderPath)
      return;
    const folders = folderPath.split("/").filter((p) => p.trim());
    let currentPath = "";
    for (const folder of folders) {
      currentPath = currentPath ? `${currentPath}/${folder}` : folder;
      if (!this.app.vault.getAbstractFileByPath(currentPath)) {
        try {
          await this.app.vault.createFolder(currentPath);
        } catch (error) {
          console.error(`Failed to create folder ${currentPath}:`, error);
        }
      }
    }
  }
  getActiveEditor() {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    return (view == null ? void 0 : view.editor) || null;
  }
  extractChatHistory(lines, currentPromptLine) {
    let chatHistory = "";
    let inChat = false;
    for (let i = 0; i < currentPromptLine; i++) {
      const line = lines[i];
      if (line === "## Chat") {
        inChat = true;
        continue;
      }
      if (inChat) {
        if (line.startsWith("> ")) {
          chatHistory += `User: ${line.substring(2)}
`;
        } else if (line.trim() && !line.startsWith("_") && line !== "") {
          chatHistory += `AI: ${line}
`;
        }
      }
    }
    return chatHistory;
  }
  // Helper method to get formatted tags string
  getTagsString() {
    if (!this.settings.addSynapseTag || !this.settings.synapseTag) {
      return "";
    }
    const tags = this.settings.synapseTag.split(",").map((tag) => tag.trim()).filter((tag) => tag).map((tag) => {
      return tag.startsWith("#") ? tag : `#${tag}`;
    });
    return tags.join(" ");
  }
};

// src/main.ts
var SynapsePlugin = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.DEFAULT_SETTINGS = DEFAULT_SETTINGS;
  }
  async onload() {
    await this.loadSettings();
    this.ollama = new OllamaClient(this.settings.ollamaUrl, this.settings.ollamaModel);
    this.commands = new SynapseCommands(this.app, this.ollama, this.settings);
    this.debouncedSuggestion = (0, import_obsidian3.debounce)(
      (editor) => this.commands.generateLiveSuggestion(editor),
      this.settings.suggestionDelay
    );
    this.addSettingTab(new SynapseSettingsTab(this.app, this));
    this.addCommand({
      id: "explain-and-link",
      name: "Explain & Link Selected Text",
      editorCallback: (editor) => {
        const selectedText = editor.getSelection();
        this.commands.explainAndLink(editor, selectedText);
      }
    });
    this.addCommand({
      id: "summarize-note",
      name: "Summarize Current Note",
      editorCallback: (editor) => {
        const content = editor.getValue();
        this.commands.summarizeNote(editor, content);
      }
    });
    this.addCommand({
      id: "create-flashcards",
      name: "Create Flashcards from Selection",
      editorCallback: (editor) => {
        const selectedText = editor.getSelection();
        this.commands.createFlashcards(editor, selectedText);
      }
    });
    this.addCommand({
      id: "start-chat",
      name: "Start New Chat Session",
      editorCallback: (editor) => {
        this.commands.startChatSession(editor);
      }
    });
    this.addCommand({
      id: "send-chat-message",
      name: "Send Chat Message",
      editorCallback: (editor) => {
        this.commands.sendChatMessage(editor);
      }
    });
    this.addCommand({
      id: "toggle-live-suggestions",
      name: "Toggle Live Suggestions",
      callback: () => {
        this.settings.enableLiveSuggestions = !this.settings.enableLiveSuggestions;
        this.saveSettings();
        new import_obsidian3.Notice(`Live suggestions ${this.settings.enableLiveSuggestions ? "enabled" : "disabled"}`);
      }
    });
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor) => {
        var _a;
        const selectedText = editor.getSelection();
        if (selectedText) {
          menu.addItem((item) => {
            item.setTitle("\u{1F9E0} Explain & Link").setIcon("brain-circuit").onClick(async () => {
              await this.commands.explainAndLink(editor, selectedText);
            });
          });
          menu.addItem((item) => {
            item.setTitle("\u{1F3B4} Create Flashcards").setIcon("card-stack").onClick(async () => {
              await this.commands.createFlashcards(editor, selectedText);
            });
          });
        }
        menu.addItem((item) => {
          item.setTitle("\u{1F4DD} Summarize Note").setIcon("list-checks").onClick(async () => {
            const content = editor.getValue();
            await this.commands.summarizeNote(editor, content);
          });
        });
        const fileName = ((_a = this.app.workspace.getActiveFile()) == null ? void 0 : _a.basename) || "";
        if (fileName.startsWith("Chat-")) {
          menu.addItem((item) => {
            item.setTitle("\u{1F4AC} Send Chat Message").setIcon("message-square").onClick(async () => {
              await this.commands.sendChatMessage(editor);
            });
          });
        } else {
          menu.addItem((item) => {
            item.setTitle("\u{1F4AC} Start Chat Session").setIcon("message-circle").onClick(async () => {
              await this.commands.startChatSession(editor);
            });
          });
        }
      })
    );
    this.registerLiveSuggestionEvents();
    this.checkOllamaConnection();
    console.log("Synapse plugin loaded");
  }
  onunload() {
    console.log("Synapse plugin unloaded");
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.commands.updateSettings(this.settings);
    this.debouncedSuggestion = (0, import_obsidian3.debounce)(
      (editor) => this.commands.generateLiveSuggestion(editor),
      this.settings.suggestionDelay
    );
    this.registerLiveSuggestionEvents();
  }
  registerLiveSuggestionEvents() {
    if (this.liveSuggestionEvent) {
      this.app.workspace.off("editor-change", this.liveSuggestionEvent);
    }
    if (this.settings.enableLiveSuggestions) {
      this.liveSuggestionEvent = this.app.workspace.on("editor-change", (editor) => {
        this.debouncedSuggestion(editor);
      });
      this.registerEvent(this.liveSuggestionEvent);
    }
  }
  async checkOllamaConnection() {
    const isAvailable = await this.ollama.isAvailable();
    if (!isAvailable) {
      new import_obsidian3.Notice(
        "Synapse: Cannot connect to Ollama. Please make sure Ollama is running on " + this.settings.ollamaUrl,
        8e3
      );
    } else {
      new import_obsidian3.Notice("Synapse: Connected to Ollama successfully", 3e3);
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy91aS9TZXR0aW5nc1RhYi50cyIsICJzcmMvb2xsYW1hLnRzIiwgInNyYy9jb21tYW5kcy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTWVudSwgTm90aWNlLCBkZWJvdW5jZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IFN5bmFwc2VTZXR0aW5ncywgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJy4vc2V0dGluZ3MnO1xuaW1wb3J0IHsgU3luYXBzZVNldHRpbmdzVGFiIH0gZnJvbSAnLi91aS9TZXR0aW5nc1RhYic7XG5pbXBvcnQgeyBPbGxhbWFDbGllbnQgfSBmcm9tICcuL29sbGFtYSc7XG5pbXBvcnQgeyBTeW5hcHNlQ29tbWFuZHMgfSBmcm9tICcuL2NvbW1hbmRzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3luYXBzZVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IFN5bmFwc2VTZXR0aW5ncztcbiAgICBvbGxhbWE6IE9sbGFtYUNsaWVudDtcbiAgICBjb21tYW5kczogU3luYXBzZUNvbW1hbmRzO1xuICAgIGRlYm91bmNlZFN1Z2dlc3Rpb246IGFueTtcbiAgICBsaXZlU3VnZ2VzdGlvbkV2ZW50OiBhbnk7XG4gICAgREVGQVVMVF9TRVRUSU5HUyA9IERFRkFVTFRfU0VUVElOR1M7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBPbGxhbWEgY2xpZW50IGFuZCBjb21tYW5kc1xuICAgICAgICB0aGlzLm9sbGFtYSA9IG5ldyBPbGxhbWFDbGllbnQodGhpcy5zZXR0aW5ncy5vbGxhbWFVcmwsIHRoaXMuc2V0dGluZ3Mub2xsYW1hTW9kZWwpO1xuICAgICAgICB0aGlzLmNvbW1hbmRzID0gbmV3IFN5bmFwc2VDb21tYW5kcyh0aGlzLmFwcCwgdGhpcy5vbGxhbWEsIHRoaXMuc2V0dGluZ3MpO1xuXG4gICAgICAgIC8vIFNldCB1cCBkZWJvdW5jZWQgc3VnZ2VzdGlvbiB3aXRoIG1vcmUgYWR2YW5jZWQgZmVhdHVyZXNcbiAgICAgICAgdGhpcy5kZWJvdW5jZWRTdWdnZXN0aW9uID0gZGVib3VuY2UoXG4gICAgICAgICAgICAoZWRpdG9yOiBFZGl0b3IpID0+IHRoaXMuY29tbWFuZHMuZ2VuZXJhdGVMaXZlU3VnZ2VzdGlvbihlZGl0b3IpLFxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zdWdnZXN0aW9uRGVsYXlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU3luYXBzZVNldHRpbmdzVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cbiAgICAgICAgLy8gUmVnaXN0ZXIgY29tbWFuZHNcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnZXhwbGFpbi1hbmQtbGluaycsXG4gICAgICAgICAgICBuYW1lOiAnRXhwbGFpbiAmIExpbmsgU2VsZWN0ZWQgVGV4dCcsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRUZXh0ID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIHRoaXMuY29tbWFuZHMuZXhwbGFpbkFuZExpbmsoZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnc3VtbWFyaXplLW5vdGUnLFxuICAgICAgICAgICAgbmFtZTogJ1N1bW1hcml6ZSBDdXJyZW50IE5vdGUnLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvcikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRzLnN1bW1hcml6ZU5vdGUoZWRpdG9yLCBjb250ZW50KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2NyZWF0ZS1mbGFzaGNhcmRzJyxcbiAgICAgICAgICAgIG5hbWU6ICdDcmVhdGUgRmxhc2hjYXJkcyBmcm9tIFNlbGVjdGlvbicsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRUZXh0ID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIHRoaXMuY29tbWFuZHMuY3JlYXRlRmxhc2hjYXJkcyhlZGl0b3IsIHNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBuZXcgY2hhdCBjb21tYW5kc1xuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzdGFydC1jaGF0JyxcbiAgICAgICAgICAgIG5hbWU6ICdTdGFydCBOZXcgQ2hhdCBTZXNzaW9uJyxcbiAgICAgICAgICAgIGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRzLnN0YXJ0Q2hhdFNlc3Npb24oZWRpdG9yKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnc2VuZC1jaGF0LW1lc3NhZ2UnLFxuICAgICAgICAgICAgbmFtZTogJ1NlbmQgQ2hhdCBNZXNzYWdlJyxcbiAgICAgICAgICAgIGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRzLnNlbmRDaGF0TWVzc2FnZShlZGl0b3IpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWRkIG5ldyBjb21tYW5kIGZvciBMaXZlIENvcGlsb3RcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAndG9nZ2xlLWxpdmUtc3VnZ2VzdGlvbnMnLFxuICAgICAgICAgICAgbmFtZTogJ1RvZ2dsZSBMaXZlIFN1Z2dlc3Rpb25zJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnMgPSAhdGhpcy5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnM7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBMaXZlIHN1Z2dlc3Rpb25zICR7dGhpcy5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnMgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBZGQgY29udGV4dCBtZW51IGl0ZW1zXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLW1lbnUnLCAobWVudTogTWVudSwgZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoJ1x1RDgzRVx1RERFMCBFeHBsYWluICYgTGluaycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ2JyYWluLWNpcmN1aXQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5jb21tYW5kcy5leHBsYWluQW5kTGluayhlZGl0b3IsIHNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZSgnXHVEODNDXHVERkI0IENyZWF0ZSBGbGFzaGNhcmRzJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbignY2FyZC1zdGFjaycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNvbW1hbmRzLmNyZWF0ZUZsYXNoY2FyZHMoZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKCdcdUQ4M0RcdURDREQgU3VtbWFyaXplIE5vdGUnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ2xpc3QtY2hlY2tzJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5jb21tYW5kcy5zdW1tYXJpemVOb3RlKGVkaXRvciwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBBZGQgY2hhdCBvcHRpb25cbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlTmFtZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk/LmJhc2VuYW1lIHx8ICcnO1xuICAgICAgICAgICAgICAgIGlmIChmaWxlTmFtZS5zdGFydHNXaXRoKCdDaGF0LScpKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZSgnXHVEODNEXHVEQ0FDIFNlbmQgQ2hhdCBNZXNzYWdlJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbignbWVzc2FnZS1zcXVhcmUnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5jb21tYW5kcy5zZW5kQ2hhdE1lc3NhZ2UoZWRpdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKCdcdUQ4M0RcdURDQUMgU3RhcnQgQ2hhdCBTZXNzaW9uJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbignbWVzc2FnZS1jaXJjbGUnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5jb21tYW5kcy5zdGFydENoYXRTZXNzaW9uKGVkaXRvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICAvLyBSZWdpc3RlciBlZGl0b3IgZXZlbnQgZm9yIGxpdmUgc3VnZ2VzdGlvbnNcbiAgICAgICAgdGhpcy5yZWdpc3RlckxpdmVTdWdnZXN0aW9uRXZlbnRzKCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgT2xsYW1hIGF2YWlsYWJpbGl0eSBvbiBzdGFydHVwXG4gICAgICAgIHRoaXMuY2hlY2tPbGxhbWFDb25uZWN0aW9uKCk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1N5bmFwc2UgcGx1Z2luIGxvYWRlZCcpO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnU3luYXBzZSBwbHVnaW4gdW5sb2FkZWQnKTtcbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgLy8gVXBkYXRlIGNvbW1hbmRzIHdpdGggbmV3IHNldHRpbmdzXG4gICAgICAgIHRoaXMuY29tbWFuZHMudXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIFxuICAgICAgICAvLyBSZS1pbml0aWFsaXplIGRlYm91bmNlZCBzdWdnZXN0aW9uIHdpdGggbmV3IGRlbGF5XG4gICAgICAgIHRoaXMuZGVib3VuY2VkU3VnZ2VzdGlvbiA9IGRlYm91bmNlKFxuICAgICAgICAgICAgKGVkaXRvcjogRWRpdG9yKSA9PiB0aGlzLmNvbW1hbmRzLmdlbmVyYXRlTGl2ZVN1Z2dlc3Rpb24oZWRpdG9yKSxcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc3VnZ2VzdGlvbkRlbGF5XG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgZXZlbnQgbGlzdGVuZXJzIGZvciBsaXZlIHN1Z2dlc3Rpb25zXG4gICAgICAgIHRoaXMucmVnaXN0ZXJMaXZlU3VnZ2VzdGlvbkV2ZW50cygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVnaXN0ZXJMaXZlU3VnZ2VzdGlvbkV2ZW50cygpIHtcbiAgICAgICAgLy8gVW5yZWdpc3RlciBleGlzdGluZyBldmVudCBpZiBuZWVkZWRcbiAgICAgICAgaWYgKHRoaXMubGl2ZVN1Z2dlc3Rpb25FdmVudCkge1xuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9mZignZWRpdG9yLWNoYW5nZScsIHRoaXMubGl2ZVN1Z2dlc3Rpb25FdmVudCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBPbmx5IHJlZ2lzdGVyIGlmIGZlYXR1cmUgaXMgZW5hYmxlZFxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMubGl2ZVN1Z2dlc3Rpb25FdmVudCA9IHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLWNoYW5nZScsIChlZGl0b3I6IEVkaXRvcikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVib3VuY2VkU3VnZ2VzdGlvbihlZGl0b3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5saXZlU3VnZ2VzdGlvbkV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgY2hlY2tPbGxhbWFDb25uZWN0aW9uKCkge1xuICAgICAgICBjb25zdCBpc0F2YWlsYWJsZSA9IGF3YWl0IHRoaXMub2xsYW1hLmlzQXZhaWxhYmxlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWlzQXZhaWxhYmxlKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKFxuICAgICAgICAgICAgICAgICdTeW5hcHNlOiBDYW5ub3QgY29ubmVjdCB0byBPbGxhbWEuIFBsZWFzZSBtYWtlIHN1cmUgT2xsYW1hIGlzIHJ1bm5pbmcgb24gJyArIFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Mub2xsYW1hVXJsLCBcbiAgICAgICAgICAgICAgICA4MDAwXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnU3luYXBzZTogQ29ubmVjdGVkIHRvIE9sbGFtYSBzdWNjZXNzZnVsbHknLCAzMDAwKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBTeW5hcHNlU2V0dGluZ3Mge1xuICAgIG9sbGFtYVVybDogc3RyaW5nO1xuICAgIG9sbGFtYU1vZGVsOiBzdHJpbmc7XG4gICAgYXV0b0xpbmtFbmFibGVkOiBib29sZWFuO1xuICAgIHN1bW1hcnlMb2NhdGlvbjogJ3RvcCcgfCAnYm90dG9tJztcbiAgICBmbGFzaGNhcmRGb3JtYXQ6ICdzaW1wbGUnIHwgJ3NwYWNlZCc7XG4gICAgbWF4UmVzcG9uc2VMZW5ndGg6IG51bWJlcjtcbiAgICBleHBsYW5hdGlvbkZvbGRlcjogc3RyaW5nO1xuICAgIGZsYXNoY2FyZEZvbGRlcjogc3RyaW5nO1xuICAgIHVzZVN1bW1hcnlZYW1sOiBib29sZWFuO1xuICAgIGNoYXRGb2xkZXI6IHN0cmluZztcbiAgICBlbmFibGVMaXZlQ2hhdDogYm9vbGVhbjtcbiAgICBlbmFibGVMaXZlU3VnZ2VzdGlvbnM6IGJvb2xlYW47XG4gICAgc3VnZ2VzdGlvbkRlbGF5OiBudW1iZXI7XG4gICAgc2hvd0dob3N0VGV4dDogYm9vbGVhbjtcbiAgICBhbGxvd1F1aWNrQWNjZXB0OiBib29sZWFuO1xuICAgIHRlbXBsYXRlUGF0aDogc3RyaW5nO1xuICAgIHVzZVRlbXBsYXRlRm9yRXhwbGFuYXRpb25zOiBib29sZWFuO1xuICAgIGdsb2JhbFN5c3RlbVByb21wdDogc3RyaW5nO1xuICAgIGNoYXRTeXN0ZW1Qcm9tcHQ6IHN0cmluZztcbiAgICBleHBsYW5hdGlvblN5c3RlbVByb21wdDogc3RyaW5nO1xuICAgIHN1bW1hcnlTeXN0ZW1Qcm9tcHQ6IHN0cmluZztcbiAgICBmbGFzaGNhcmRTeXN0ZW1Qcm9tcHQ6IHN0cmluZztcbiAgICBjdXN0b21UZW1wbGF0ZVZhcmlhYmxlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICBhZGRTeW5hcHNlVGFnOiBib29sZWFuO1xuICAgIHN5bmFwc2VUYWc6IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFN5bmFwc2VTZXR0aW5ncyA9IHtcbiAgICBvbGxhbWFVcmw6ICdodHRwOi8vbG9jYWxob3N0OjExNDM0JyxcbiAgICBvbGxhbWFNb2RlbDogJ2dlbW1hM246ZTJiJyxcbiAgICBhdXRvTGlua0VuYWJsZWQ6IHRydWUsXG4gICAgc3VtbWFyeUxvY2F0aW9uOiAndG9wJyxcbiAgICBmbGFzaGNhcmRGb3JtYXQ6ICdzaW1wbGUnLFxuICAgIG1heFJlc3BvbnNlTGVuZ3RoOiAxMDAwLFxuICAgIGV4cGxhbmF0aW9uRm9sZGVyOiAnU3luYXBzZS9FeHBsYW5hdGlvbnMnLFxuICAgIGZsYXNoY2FyZEZvbGRlcjogJ1N5bmFwc2UvRmxhc2hjYXJkcycsXG4gICAgdXNlU3VtbWFyeVlhbWw6IHRydWUsXG4gICAgY2hhdEZvbGRlcjogJ1N5bmFwc2UvQ2hhdHMnLFxuICAgIGVuYWJsZUxpdmVDaGF0OiB0cnVlLFxuICAgIGVuYWJsZUxpdmVTdWdnZXN0aW9uczogZmFsc2UsXG4gICAgc3VnZ2VzdGlvbkRlbGF5OiAzMDAwLFxuICAgIHNob3dHaG9zdFRleHQ6IHRydWUsXG4gICAgYWxsb3dRdWlja0FjY2VwdDogdHJ1ZSxcbiAgICB0ZW1wbGF0ZVBhdGg6ICcnLFxuICAgIHVzZVRlbXBsYXRlRm9yRXhwbGFuYXRpb25zOiBmYWxzZSxcbiAgICBnbG9iYWxTeXN0ZW1Qcm9tcHQ6ICdZb3UgYXJlIGEgaGVscGZ1bCBlZHVjYXRpb25hbCBhc3Npc3RhbnQgcHJvdmlkaW5nIGNvbmNpc2UsIGFjY3VyYXRlIGluZm9ybWF0aW9uLicsXG4gICAgY2hhdFN5c3RlbVByb21wdDogJ1lvdSBhcmUgYSBoZWxwZnVsIEFJIGFzc2lzdGFudCBpbiBhIGNoYXQgc2Vzc2lvbi4gUHJvdmlkZSB0aG91Z2h0ZnVsLCBjb25jaXNlIHJlc3BvbnNlcyB0byB0aGUgdXNlclxcJ3MgcXVlc3Rpb25zLiBVc2UgbWFya2Rvd24gZm9ybWF0dGluZyB3aGVuIGFwcHJvcHJpYXRlLiBSZWZlcmVuY2UgcHJpb3IgbWVzc2FnZXMgaW4gdGhlIGNvbnZlcnNhdGlvbiB3aGVuIHJlbGV2YW50LicsXG4gICAgZXhwbGFuYXRpb25TeXN0ZW1Qcm9tcHQ6ICdZb3UgYXJlIGEgaGVscGZ1bCBlZHVjYXRpb25hbCBhc3Npc3RhbnQuIENyZWF0ZSBhIGNsZWFyLCBjb25jaXNlIGV4cGxhbmF0aW9uIG9mIHRoZSBnaXZlbiBjb25jZXB0LiBGb3JtYXQgeW91ciByZXNwb25zZSBhcyBhIHdlbGwtc3RydWN0dXJlZCBub3RlIHdpdGg6XFxuMS4gQSBicmllZiBkZWZpbml0aW9uXFxuMi4gS2V5IGNoYXJhY3RlcmlzdGljcyBvciBwcm9wZXJ0aWVzXFxuMy4gQSBzaW1wbGUgYW5hbG9neSBvciBleGFtcGxlIGlmIGhlbHBmdWxcXG40LiBXaHkgdGhpcyBjb25jZXB0IGlzIGltcG9ydGFudFxcblxcbktlZXAgdGhlIGV4cGxhbmF0aW9uIHVuZGVyIHt7bWF4UmVzcG9uc2VMZW5ndGh9fSBjaGFyYWN0ZXJzIGFuZCB1c2UgY2xlYXIsIGVkdWNhdGlvbmFsIGxhbmd1YWdlLicsXG4gICAgc3VtbWFyeVN5c3RlbVByb21wdDogJ1lvdSBhcmUgYSBoZWxwZnVsIGFzc2lzdGFudCB0aGF0IGNyZWF0ZXMgY29uY2lzZSBzdW1tYXJpZXMuIENyZWF0ZSBhIGJ1bGxldC1wb2ludCBzdW1tYXJ5ICgzLTUgcG9pbnRzKSBvZiB0aGUgbWFpbiBpZGVhcyBpbiB0aGUgZ2l2ZW4gdGV4dC4gRWFjaCBidWxsZXQgcG9pbnQgc2hvdWxkIGJlIGNsZWFyIGFuZCBjYXB0dXJlIGEga2V5IGNvbmNlcHQuIEZvcm1hdCBhcyBtYXJrZG93biBidWxsZXRzIHN0YXJ0aW5nIHdpdGggXCItIFwiLicsXG4gICAgZmxhc2hjYXJkU3lzdGVtUHJvbXB0OiAnWW91IGFyZSBhIGhlbHBmdWwgYXNzaXN0YW50IHRoYXQgY3JlYXRlcyBzdHVkeSBmbGFzaGNhcmRzLiBGcm9tIHRoZSBnaXZlbiB0ZXh0LCBpZGVudGlmeSAzLTcga2V5IGNvbmNlcHRzIGFuZCBjcmVhdGUgZmxhc2hjYXJkcyBpbiB0aGlzIGV4YWN0IGZvcm1hdDpcXG5cXG4qKlE6KiogUXVlc3Rpb24gaGVyZT9cXG4qKkE6KiogQW5zd2VyIGhlcmVcXG5cXG5NYWtlIHF1ZXN0aW9ucyBjbGVhciBhbmQgc3BlY2lmaWMuIEFuc3dlcnMgc2hvdWxkIGJlIGNvbmNpc2UgYnV0IGNvbXBsZXRlLiBGb2N1cyBvbiB0aGUgbW9zdCBpbXBvcnRhbnQgY29uY2VwdHMgZm9yIGxlYXJuaW5nIGFuZCByZXRlbnRpb24uJyxcbiAgICBjdXN0b21UZW1wbGF0ZVZhcmlhYmxlczoge30sXG4gICAgYWRkU3luYXBzZVRhZzogdHJ1ZSxcbiAgICBzeW5hcHNlVGFnOiAnc3luYXBzZSdcbn07XG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBUZXh0QXJlYUNvbXBvbmVudCwgRHJvcGRvd25Db21wb25lbnQsIFRGaWxlLCBCdXR0b25Db21wb25lbnQgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgU3luYXBzZVBsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IE9sbGFtYUNsaWVudCB9IGZyb20gJy4uL29sbGFtYSc7XG5cbmV4cG9ydCBjbGFzcyBTeW5hcHNlU2V0dGluZ3NUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IFN5bmFwc2VQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBTeW5hcHNlUGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICAgICAgY29udGFpbmVyRWwuYWRkQ2xhc3MoJ3N5bmFwc2Utc2V0dGluZ3MnKTtcblxuICAgICAgICAvLyBDcmVhdGUgdGFicyBmb3IgYmV0dGVyIG9yZ2FuaXphdGlvblxuICAgICAgICBjb25zdCB0YWJDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoJ3N5bmFwc2Utc2V0dGluZ3MtdGFicycpO1xuICAgICAgICBjb25zdCB0YWJDb250ZW50ID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCdzeW5hcHNlLXNldHRpbmdzLWNvbnRlbnQnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSB0YWIgYnV0dG9uc1xuICAgICAgICBjb25zdCBnZW5lcmFsVGFiID0gdGFiQ29udGFpbmVyLmNyZWF0ZURpdignc3luYXBzZS10YWInKTtcbiAgICAgICAgZ2VuZXJhbFRhYi5zZXRUZXh0KCdHZW5lcmFsJyk7XG4gICAgICAgIGdlbmVyYWxUYWIuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcHJvbXB0c1RhYiA9IHRhYkNvbnRhaW5lci5jcmVhdGVEaXYoJ3N5bmFwc2UtdGFiJyk7XG4gICAgICAgIHByb21wdHNUYWIuc2V0VGV4dCgnQUkgUHJvbXB0cycpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgdGVtcGxhdGVzVGFiID0gdGFiQ29udGFpbmVyLmNyZWF0ZURpdignc3luYXBzZS10YWInKTtcbiAgICAgICAgdGVtcGxhdGVzVGFiLnNldFRleHQoJ1RlbXBsYXRlcycpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgYWR2YW5jZWRUYWIgPSB0YWJDb250YWluZXIuY3JlYXRlRGl2KCdzeW5hcHNlLXRhYicpO1xuICAgICAgICBhZHZhbmNlZFRhYi5zZXRUZXh0KCdBZHZhbmNlZCcpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIGNvbnRlbnQgc2VjdGlvbnNcbiAgICAgICAgY29uc3QgZ2VuZXJhbENvbnRlbnQgPSB0YWJDb250ZW50LmNyZWF0ZURpdignc3luYXBzZS10YWItY29udGVudCcpO1xuICAgICAgICBnZW5lcmFsQ29udGVudC5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBwcm9tcHRzQ29udGVudCA9IHRhYkNvbnRlbnQuY3JlYXRlRGl2KCdzeW5hcHNlLXRhYi1jb250ZW50Jyk7XG4gICAgICAgIHByb21wdHNDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0ZW1wbGF0ZXNDb250ZW50ID0gdGFiQ29udGVudC5jcmVhdGVEaXYoJ3N5bmFwc2UtdGFiLWNvbnRlbnQnKTtcbiAgICAgICAgdGVtcGxhdGVzQ29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgYWR2YW5jZWRDb250ZW50ID0gdGFiQ29udGVudC5jcmVhdGVEaXYoJ3N5bmFwc2UtdGFiLWNvbnRlbnQnKTtcbiAgICAgICAgYWR2YW5jZWRDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIFxuICAgICAgICAvLyBTZXQgdXAgdGFiIHN3aXRjaGluZ1xuICAgICAgICBjb25zdCB0YWJzID0gW2dlbmVyYWxUYWIsIHByb21wdHNUYWIsIHRlbXBsYXRlc1RhYiwgYWR2YW5jZWRUYWJdO1xuICAgICAgICBjb25zdCBjb250ZW50cyA9IFtnZW5lcmFsQ29udGVudCwgcHJvbXB0c0NvbnRlbnQsIHRlbXBsYXRlc0NvbnRlbnQsIGFkdmFuY2VkQ29udGVudF07XG4gICAgICAgIFxuICAgICAgICB0YWJzLmZvckVhY2goKHRhYiwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIHRhYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0YWJzLmZvckVhY2godCA9PiB0LnJlbW92ZUNsYXNzKCdhY3RpdmUnKSk7XG4gICAgICAgICAgICAgICAgY29udGVudHMuZm9yRWFjaChjID0+IGMuc3R5bGUuZGlzcGxheSA9ICdub25lJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGFiLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICBjb250ZW50c1tpbmRleF0uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gR0VORVJBTCBTRVRUSU5HU1xuXG4gICAgICAgIC8vIE9sbGFtYSBDb25maWd1cmF0aW9uXG4gICAgICAgIGdlbmVyYWxDb250ZW50LmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ09sbGFtYScgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoZ2VuZXJhbENvbnRlbnQpXG4gICAgICAgICAgICAuc2V0TmFtZSgnT2xsYW1hIFVSTCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnVVJMIHdoZXJlIE9sbGFtYSBpcyBydW5uaW5nIChkZWZhdWx0OiBodHRwOi8vbG9jYWxob3N0OjExNDM0KScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbGxhbWFVcmwpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbGxhbWFVcmwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGdlbmVyYWxDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ01vZGVsJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdPbGxhbWEgbW9kZWwgdG8gdXNlIChlLmcuLCBwaGkzOm1pbmksIGdlbW1hM246ZTJiLCBtaXN0cmFsKScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3BoaTM6bWluaScpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9sbGFtYU1vZGVsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub2xsYW1hTW9kZWwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIEF2YWlsYWJsZSBtb2RlbHMgZHJvcGRvd25cbiAgICAgICAgY29uc3QgbW9kZWxDb250YWluZXIgPSBnZW5lcmFsQ29udGVudC5jcmVhdGVEaXYoJ3N5bmFwc2UtbW9kZWwtc2VsZWN0b3InKTtcbiAgICAgICAgY29uc3QgbW9kZWxTZXR0aW5nID0gbmV3IFNldHRpbmcobW9kZWxDb250YWluZXIpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU2VsZWN0IEF2YWlsYWJsZSBNb2RlbCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnQ2hvb3NlIGZyb20gbW9kZWxzIGF2YWlsYWJsZSBpbiB5b3VyIE9sbGFtYSBpbnN0YWxsYXRpb24nKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBtb2RlbERyb3Bkb3duOiBEcm9wZG93bkNvbXBvbmVudDtcbiAgICAgICAgbW9kZWxTZXR0aW5nLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcbiAgICAgICAgICAgIG1vZGVsRHJvcGRvd24gPSBkcm9wZG93bjtcbiAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbignJywgJ0xvYWRpbmcgbW9kZWxzLi4uJyk7XG4gICAgICAgICAgICBkcm9wZG93bi5zZXRWYWx1ZSgnJyk7XG4gICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub2xsYW1hTW9kZWwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gTG9hZCBhdmFpbGFibGUgbW9kZWxzXG4gICAgICAgIHRoaXMubG9hZEF2YWlsYWJsZU1vZGVscyhtb2RlbERyb3Bkb3duKTtcblxuICAgICAgICAvLyBUZXN0IGNvbm5lY3Rpb24gYnV0dG9uXG4gICAgICAgIG5ldyBTZXR0aW5nKGdlbmVyYWxDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ1Rlc3QgQ29ubmVjdGlvbicpXG4gICAgICAgICAgICAuc2V0RGVzYygnVGVzdCBjb25uZWN0aW9uIHRvIE9sbGFtYScpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoJ1Rlc3QnKTtcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0Q3RhKCk7XG4gICAgICAgICAgICAgICAgLy8gXHU0RkVFXHU1OTBEXHVGRjFBXHU1MjA2XHU1RjAwXHU4QzAzXHU3NTI4XHU2NUI5XHU2Q0Q1XHU4MDBDXHU0RTBEXHU2NjJGXHU5NEZFXHU1RjBGXHU4QzAzXHU3NTI4XG4gICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKCdzeW5hcHNlLXRlc3QtYnV0dG9uJyk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGllbnQgPSBuZXcgT2xsYW1hQ2xpZW50KHRoaXMucGx1Z2luLnNldHRpbmdzLm9sbGFtYVVybCwgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub2xsYW1hTW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0F2YWlsYWJsZSA9IGF3YWl0IGNsaWVudC5pc0F2YWlsYWJsZSgpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQXZhaWxhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dCgnXHUyNzEzIENvbm5lY3RlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjNGNhZjUwJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdUZXN0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dCgnXHUyNzE3IEZhaWxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjZjQ0MzM2JztcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdUZXN0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEZlYXR1cmVzXG4gICAgICAgIGdlbmVyYWxDb250ZW50LmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0ZlYXR1cmVzJyB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhnZW5lcmFsQ29udGVudClcbiAgICAgICAgICAgIC5zZXROYW1lKCdBdXRvLWxpbmtpbmcnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgY3JlYXRlIGxpbmtzIHdoZW4gdXNpbmcgXCJFeHBsYWluICYgTGlua1wiJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvTGlua0VuYWJsZWQpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvTGlua0VuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGdlbmVyYWxDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ1N1bW1hcnkgTG9jYXRpb24nKVxuICAgICAgICAgICAgLnNldERlc2MoJ1doZXJlIHRvIHBsYWNlIHN1bW1hcmllcyBpbiBub3RlcycpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4gZHJvcGRvd25cbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCd0b3AnLCAnVG9wIG9mIG5vdGUnKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2JvdHRvbScsICdCb3R0b20gb2Ygbm90ZScpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnN1bW1hcnlMb2NhdGlvbilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiAndG9wJyB8ICdib3R0b20nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnN1bW1hcnlMb2NhdGlvbiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKGdlbmVyYWxDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ1VzZSBZQU1MIGZvciBTdW1tYXJpZXMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0FkZCBzdW1tYXJpZXMgdG8gbm90ZSBmcm9udG1hdHRlciBhcyBZQU1MJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VTdW1tYXJ5WWFtbClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVN1bW1hcnlZYW1sID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhnZW5lcmFsQ29udGVudClcbiAgICAgICAgICAgIC5zZXROYW1lKCdNYXggUmVzcG9uc2UgTGVuZ3RoJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdNYXhpbXVtIGxlbmd0aCBmb3IgQUkgcmVzcG9uc2VzIChjaGFyYWN0ZXJzKScpXG4gICAgICAgICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcbiAgICAgICAgICAgICAgICAuc2V0TGltaXRzKDUwMCwgMzAwMCwgMTAwKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhSZXNwb25zZUxlbmd0aClcbiAgICAgICAgICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4UmVzcG9uc2VMZW5ndGggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAvLyBGb2xkZXIgb3JnYW5pemF0aW9uXG4gICAgICAgIGdlbmVyYWxDb250ZW50LmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0ZvbGRlciBPcmdhbml6YXRpb24nIH0pO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoZ2VuZXJhbENvbnRlbnQpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRXhwbGFuYXRpb25zIEZvbGRlcicpXG4gICAgICAgICAgICAuc2V0RGVzYygnRm9sZGVyIGZvciBleHBsYW5hdGlvbiBub3RlcyAoZW1wdHkgZm9yIHZhdWx0IHJvb3QpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRXhwbGFuYXRpb25zJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhwbGFuYXRpb25Gb2xkZXIpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHBsYW5hdGlvbkZvbGRlciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKGdlbmVyYWxDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ0ZsYXNoY2FyZHMgRm9sZGVyJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdGb2xkZXIgZm9yIGZsYXNoY2FyZCBub3RlcyAoZW1wdHkgZm9yIHZhdWx0IHJvb3QpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRmxhc2hjYXJkcycpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZsYXNoY2FyZEZvbGRlcilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZsYXNoY2FyZEZvbGRlciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKGdlbmVyYWxDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ0NoYXQgRm9sZGVyJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdGb2xkZXIgZm9yIGNoYXQgc2Vzc2lvbiBub3RlcyAoZW1wdHkgZm9yIHZhdWx0IHJvb3QpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignQ2hhdHMnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jaGF0Rm9sZGVyKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2hhdEZvbGRlciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdGFnIHNldHRpbmdzIHRvIGdlbmVyYWwgY29udGVudFxuICAgICAgICBnZW5lcmFsQ29udGVudC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdOb3RlIFRhZ2dpbmcnIH0pO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoZ2VuZXJhbENvbnRlbnQpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQWRkIFRhZ3MgdG8gTm90ZXMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgYWRkIHRhZ3MgdG8gYWxsIG5vdGVzIGNyZWF0ZWQgYnkgU3luYXBzZScpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWRkU3luYXBzZVRhZylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmFkZFN5bmFwc2VUYWcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdmlzaWJpbGl0eSBvZiB0YWcgaW5wdXQgYmFzZWQgb24gdG9nZ2xlIHN0YXRlXG4gICAgICAgICAgICAgICAgICAgIHRhZ0lucHV0LnNldERpc2FibGVkKCF2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHRhZyBpbnB1dCBzZXR0aW5nXG4gICAgICAgIGxldCB0YWdJbnB1dDogU2V0dGluZztcbiAgICAgICAgdGFnSW5wdXQgPSBuZXcgU2V0dGluZyhnZW5lcmFsQ29udGVudClcbiAgICAgICAgICAgIC5zZXROYW1lKCdUYWdzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUYWdzIHRvIGFkZCB0byBub3RlcyAoY29tbWEgc2VwYXJhdGVkLCAjIG9wdGlvbmFsKScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3N5bmFwc2UsIGFpLWdlbmVyYXRlZCcpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnN5bmFwc2VUYWcpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5hcHNlVGFnID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgLnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5hZGRTeW5hcHNlVGFnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAvLyBQUk9NUFRTIFNFVFRJTkdTXG4gICAgICAgIHByb21wdHNDb250ZW50LmNyZWF0ZUVsKCdwJywgeyBcbiAgICAgICAgICAgIHRleHQ6ICdDdXN0b21pemUgdGhlIHN5c3RlbSBwcm9tcHRzIHVzZWQgZm9yIGRpZmZlcmVudCBmZWF0dXJlcy4gWW91IGNhbiB1c2UgdmFyaWFibGVzIGxpa2Uge3ttYXhSZXNwb25zZUxlbmd0aH19LCB7e2RhdGV9fSwgYW5kIHt7bW9kZWx9fS4nXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEdsb2JhbCBzeXN0ZW0gcHJvbXB0XG4gICAgICAgIHByb21wdHNDb250ZW50LmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0dsb2JhbCBTeXN0ZW0gUHJvbXB0JyB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGdsb2JhbFByb21wdFNldHRpbmcgPSBuZXcgU2V0dGluZyhwcm9tcHRzQ29udGVudClcbiAgICAgICAgICAgIC5zZXROYW1lKCdHbG9iYWwgU3lzdGVtIFByb21wdCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnRGVmYXVsdCBzeXN0ZW0gcHJvbXB0IHVzZWQgd2hlbiBubyBzcGVjaWZpYyBwcm9tcHQgaXMgcHJvdmlkZWQnKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBnbG9iYWxQcm9tcHRBcmVhOiBUZXh0QXJlYUNvbXBvbmVudDtcbiAgICAgICAgZ2xvYmFsUHJvbXB0U2V0dGluZy5hZGRUZXh0QXJlYSh0ZXh0YXJlYSA9PiB7XG4gICAgICAgICAgICBnbG9iYWxQcm9tcHRBcmVhID0gdGV4dGFyZWE7XG4gICAgICAgICAgICB0ZXh0YXJlYVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxTeXN0ZW1Qcm9tcHQpXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdZb3UgYXJlIGEgaGVscGZ1bCBhc3Npc3RhbnQuLi4nKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsU3lzdGVtUHJvbXB0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0ZXh0YXJlYS5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICAgICAgdGV4dGFyZWEuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEV4cGxhbmF0aW9uIHN5c3RlbSBwcm9tcHRcbiAgICAgICAgcHJvbXB0c0NvbnRlbnQuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnRXhwbGFuYXRpb24gUHJvbXB0JyB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGV4cGxhbmF0aW9uUHJvbXB0U2V0dGluZyA9IG5ldyBTZXR0aW5nKHByb21wdHNDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ0V4cGxhbmF0aW9uIFN5c3RlbSBQcm9tcHQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1N5c3RlbSBwcm9tcHQgdXNlZCBmb3IgZ2VuZXJhdGluZyBleHBsYW5hdGlvbnMnKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBleHBsYW5hdGlvblByb21wdEFyZWE6IFRleHRBcmVhQ29tcG9uZW50O1xuICAgICAgICBleHBsYW5hdGlvblByb21wdFNldHRpbmcuYWRkVGV4dEFyZWEodGV4dGFyZWEgPT4ge1xuICAgICAgICAgICAgZXhwbGFuYXRpb25Qcm9tcHRBcmVhID0gdGV4dGFyZWE7XG4gICAgICAgICAgICB0ZXh0YXJlYVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHBsYW5hdGlvblN5c3RlbVByb21wdClcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0NyZWF0ZSBhIGNsZWFyLCBjb25jaXNlIGV4cGxhbmF0aW9uLi4uJylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4cGxhbmF0aW9uU3lzdGVtUHJvbXB0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0ZXh0YXJlYS5pbnB1dEVsLnJvd3MgPSA2O1xuICAgICAgICAgICAgdGV4dGFyZWEuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFN1bW1hcnkgc3lzdGVtIHByb21wdFxuICAgICAgICBwcm9tcHRzQ29udGVudC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdTdW1tYXJ5IFByb21wdCcgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdW1tYXJ5UHJvbXB0U2V0dGluZyA9IG5ldyBTZXR0aW5nKHByb21wdHNDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ1N1bW1hcnkgU3lzdGVtIFByb21wdCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnU3lzdGVtIHByb21wdCB1c2VkIGZvciBnZW5lcmF0aW5nIHN1bW1hcmllcycpO1xuICAgICAgICBcbiAgICAgICAgbGV0IHN1bW1hcnlQcm9tcHRBcmVhOiBUZXh0QXJlYUNvbXBvbmVudDtcbiAgICAgICAgc3VtbWFyeVByb21wdFNldHRpbmcuYWRkVGV4dEFyZWEodGV4dGFyZWEgPT4ge1xuICAgICAgICAgICAgc3VtbWFyeVByb21wdEFyZWEgPSB0ZXh0YXJlYTtcbiAgICAgICAgICAgIHRleHRhcmVhXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnN1bW1hcnlTeXN0ZW1Qcm9tcHQpXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdDcmVhdGUgYSBidWxsZXQtcG9pbnQgc3VtbWFyeS4uLicpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdW1tYXJ5U3lzdGVtUHJvbXB0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0ZXh0YXJlYS5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICAgICAgdGV4dGFyZWEuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEZsYXNoY2FyZCBzeXN0ZW0gcHJvbXB0XG4gICAgICAgIHByb21wdHNDb250ZW50LmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0ZsYXNoY2FyZCBQcm9tcHQnIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmxhc2hjYXJkUHJvbXB0U2V0dGluZyA9IG5ldyBTZXR0aW5nKHByb21wdHNDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ0ZsYXNoY2FyZCBTeXN0ZW0gUHJvbXB0JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdTeXN0ZW0gcHJvbXB0IHVzZWQgZm9yIGdlbmVyYXRpbmcgZmxhc2hjYXJkcycpO1xuICAgICAgICBcbiAgICAgICAgbGV0IGZsYXNoY2FyZFByb21wdEFyZWE6IFRleHRBcmVhQ29tcG9uZW50O1xuICAgICAgICBmbGFzaGNhcmRQcm9tcHRTZXR0aW5nLmFkZFRleHRBcmVhKHRleHRhcmVhID0+IHtcbiAgICAgICAgICAgIGZsYXNoY2FyZFByb21wdEFyZWEgPSB0ZXh0YXJlYTtcbiAgICAgICAgICAgIHRleHRhcmVhXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZsYXNoY2FyZFN5c3RlbVByb21wdClcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0NyZWF0ZSBmbGFzaGNhcmRzIGluIHRoaXMgZm9ybWF0Li4uJylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZsYXNoY2FyZFN5c3RlbVByb21wdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGV4dGFyZWEuaW5wdXRFbC5yb3dzID0gNjtcbiAgICAgICAgICAgIHRleHRhcmVhLmlucHV0RWwuY29scyA9IDUwO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDaGF0IHN5c3RlbSBwcm9tcHRcbiAgICAgICAgcHJvbXB0c0NvbnRlbnQuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ2hhdCBQcm9tcHQnIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY2hhdFByb21wdFNldHRpbmcgPSBuZXcgU2V0dGluZyhwcm9tcHRzQ29udGVudClcbiAgICAgICAgICAgIC5zZXROYW1lKCdDaGF0IFN5c3RlbSBQcm9tcHQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1N5c3RlbSBwcm9tcHQgdXNlZCBmb3IgY2hhdCBzZXNzaW9ucycpO1xuICAgICAgICBcbiAgICAgICAgbGV0IGNoYXRQcm9tcHRBcmVhOiBUZXh0QXJlYUNvbXBvbmVudDtcbiAgICAgICAgY2hhdFByb21wdFNldHRpbmcuYWRkVGV4dEFyZWEodGV4dGFyZWEgPT4ge1xuICAgICAgICAgICAgY2hhdFByb21wdEFyZWEgPSB0ZXh0YXJlYTtcbiAgICAgICAgICAgIHRleHRhcmVhXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNoYXRTeXN0ZW1Qcm9tcHQpXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdZb3UgYXJlIGEgaGVscGZ1bCBBSSBhc3Npc3RhbnQuLi4nKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2hhdFN5c3RlbVByb21wdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGV4dGFyZWEuaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgICAgIHRleHRhcmVhLmlucHV0RWwuY29scyA9IDUwO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZXNldCBwcm9tcHRzIGJ1dHRvblxuICAgICAgICBuZXcgU2V0dGluZyhwcm9tcHRzQ29udGVudClcbiAgICAgICAgICAgIC5zZXROYW1lKCdSZXNldCBQcm9tcHRzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdSZXNldCBhbGwgcHJvbXB0cyB0byBkZWZhdWx0IHZhbHVlcycpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoJ1Jlc2V0IHRvIERlZmF1bHRzJyk7XG4gICAgICAgICAgICAgICAgLy8gXHU0RkVFXHU1OTBEXHVGRjFBXHU0RTBEXHU4OTgxXHU5NEZFXHU1RjBGXHU4QzAzXHU3NTI4XG4gICAgICAgICAgICAgICAgYnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBDb25maXJtIGJlZm9yZSByZXNldHRpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZXNldCBhbGwgcHJvbXB0cyB0byBkZWZhdWx0IHZhbHVlcz8nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsU3lzdGVtUHJvbXB0ID0gdGhpcy5wbHVnaW4uREVGQVVMVF9TRVRUSU5HUy5nbG9iYWxTeXN0ZW1Qcm9tcHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHBsYW5hdGlvblN5c3RlbVByb21wdCA9IHRoaXMucGx1Z2luLkRFRkFVTFRfU0VUVElOR1MuZXhwbGFuYXRpb25TeXN0ZW1Qcm9tcHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdW1tYXJ5U3lzdGVtUHJvbXB0ID0gdGhpcy5wbHVnaW4uREVGQVVMVF9TRVRUSU5HUy5zdW1tYXJ5U3lzdGVtUHJvbXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmxhc2hjYXJkU3lzdGVtUHJvbXB0ID0gdGhpcy5wbHVnaW4uREVGQVVMVF9TRVRUSU5HUy5mbGFzaGNhcmRTeXN0ZW1Qcm9tcHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jaGF0U3lzdGVtUHJvbXB0ID0gdGhpcy5wbHVnaW4uREVGQVVMVF9TRVRUSU5HUy5jaGF0U3lzdGVtUHJvbXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGV4dCBhcmVhc1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsUHJvbXB0QXJlYS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxTeXN0ZW1Qcm9tcHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwbGFuYXRpb25Qcm9tcHRBcmVhLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmV4cGxhbmF0aW9uU3lzdGVtUHJvbXB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bW1hcnlQcm9tcHRBcmVhLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnN1bW1hcnlTeXN0ZW1Qcm9tcHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmxhc2hjYXJkUHJvbXB0QXJlYS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5mbGFzaGNhcmRTeXN0ZW1Qcm9tcHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhdFByb21wdEFyZWEuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY2hhdFN5c3RlbVByb21wdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnQWxsIHByb21wdHMgcmVzZXQgdG8gZGVmYXVsdHMnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVEVNUExBVEVTIFNFVFRJTkdTXG4gICAgICAgIHRlbXBsYXRlc0NvbnRlbnQuY3JlYXRlRWwoJ3AnLCB7IFxuICAgICAgICAgICAgdGV4dDogJ0NvbmZpZ3VyZSB0ZW1wbGF0ZXMgZm9yIGdlbmVyYXRlZCBub3Rlcy4gVGVtcGxhdGVzIHN1cHBvcnQgdmFyaWFibGVzIGxpa2Uge3t0aXRsZX19LCB7e2NvbnRlbnR9fSwge3tkYXRlfX0sIGFuZCBjdXN0b20gdmFyaWFibGVzLidcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVGVtcGxhdGUgZmlsZSBzZWxlY3RvclxuICAgICAgICBuZXcgU2V0dGluZyh0ZW1wbGF0ZXNDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ1RlbXBsYXRlIEZpbGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1NlbGVjdCBhIHRlbXBsYXRlIGZpbGUgZm9yIGV4cGxhbmF0aW9uIG5vdGVzJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigncGF0aC90by90ZW1wbGF0ZS5tZCcpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlUGF0aClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlUGF0aCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoJ0Jyb3dzZScpO1xuICAgICAgICAgICAgICAgIC8vIFx1NEZFRVx1NTkwRFx1RkYxQVx1NEUwRFx1ODk4MVx1OTRGRVx1NUYwRlx1OEMwM1x1NzUyOFxuICAgICAgICAgICAgICAgIGJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9kYWwgPSB0aGlzLmNyZWF0ZUZpbGVTZWxlY3Rpb25Nb2RhbCgoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZVBhdGggPSBmaWxlLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dElucHV0ID0gYnV0dG9uLmJ1dHRvbkVsLnBhcmVudEVsZW1lbnQ/LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGV4dElucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRJbnB1dC52YWx1ZSA9IGZpbGUucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBFbmFibGUgdGVtcGxhdGUgdXNhZ2VcbiAgICAgICAgbmV3IFNldHRpbmcodGVtcGxhdGVzQ29udGVudClcbiAgICAgICAgICAgIC5zZXROYW1lKCdVc2UgVGVtcGxhdGUgZm9yIEV4cGxhbmF0aW9ucycpXG4gICAgICAgICAgICAuc2V0RGVzYygnVXNlIHRoZSBzZWxlY3RlZCB0ZW1wbGF0ZSBmaWxlIGZvciBleHBsYW5hdGlvbiBub3RlcycpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlVGVtcGxhdGVGb3JFeHBsYW5hdGlvbnMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VUZW1wbGF0ZUZvckV4cGxhbmF0aW9ucyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gVGVtcGxhdGUgcHJldmlld1xuICAgICAgICB0ZW1wbGF0ZXNDb250ZW50LmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1RlbXBsYXRlIFZhcmlhYmxlcycgfSk7XG4gICAgICAgIFxuICAgICAgICB0ZW1wbGF0ZXNDb250ZW50LmNyZWF0ZUVsKCdwJywgeyBcbiAgICAgICAgICAgIHRleHQ6ICdCdWlsdC1pbiB2YXJpYWJsZXM6IHt7dGl0bGV9fVxcbiAtIG5vdGUgdGl0bGUsIHt7Y29udGVudH19XFxuIC0gQUkgZ2VuZXJhdGVkIGNvbnRlbnQsIHt7ZGF0ZX19XFxuIC0gY3VycmVudCBkYXRlLCB7e3F1ZXJ5fX1cXG4gLSBvcmlnaW5hbCBzZWxlY3RlZCB0ZXh0JyBcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ3VzdG9tIHRlbXBsYXRlIHZhcmlhYmxlc1xuICAgICAgICB0ZW1wbGF0ZXNDb250ZW50LmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0N1c3RvbSBUZW1wbGF0ZSBWYXJpYWJsZXMnIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQ29udGFpbmVyIGZvciBjdXN0b20gdmFyaWFibGVzXG4gICAgICAgIGNvbnN0IGN1c3RvbVZhcnNDb250YWluZXIgPSB0ZW1wbGF0ZXNDb250ZW50LmNyZWF0ZURpdignc3luYXBzZS1jdXN0b20tdmFycycpO1xuICAgICAgICBcbiAgICAgICAgLy8gRnVuY3Rpb24gdG8gcmVmcmVzaCBjdXN0b20gdmFyaWFibGVzIGRpc3BsYXlcbiAgICAgICAgY29uc3QgcmVmcmVzaEN1c3RvbVZhcmlhYmxlcyA9ICgpID0+IHtcbiAgICAgICAgICAgIGN1c3RvbVZhcnNDb250YWluZXIuZW1wdHkoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGV4aXN0aW5nIHZhcmlhYmxlc1xuICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tVGVtcGxhdGVWYXJpYWJsZXMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRDdXN0b21WYXJpYWJsZVJvdyhjdXN0b21WYXJzQ29udGFpbmVyLCBrZXksIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGJ1dHRvbiB0byBhZGQgbmV3IHZhcmlhYmxlXG4gICAgICAgICAgICBjb25zdCBhZGRWYXJCdXR0b24gPSBjdXN0b21WYXJzQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7XG4gICAgICAgICAgICAgICAgdGV4dDogJ0FkZCBDdXN0b20gVmFyaWFibGUnLFxuICAgICAgICAgICAgICAgIGNsczogJ3N5bmFwc2UtYWRkLXZhci1idXR0b24nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgYWRkVmFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0tleSA9IGB2YXJpYWJsZSR7T2JqZWN0LmtleXModGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tVGVtcGxhdGVWYXJpYWJsZXMpLmxlbmd0aCArIDF9YDtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21UZW1wbGF0ZVZhcmlhYmxlc1tuZXdLZXldID0gJyc7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgcmVmcmVzaEN1c3RvbVZhcmlhYmxlcygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvLyBJbml0aWFsIGRpc3BsYXkgb2YgY3VzdG9tIHZhcmlhYmxlc1xuICAgICAgICByZWZyZXNoQ3VzdG9tVmFyaWFibGVzKCk7XG5cbiAgICAgICAgLy8gQURWQU5DRUQgU0VUVElOR1NcbiAgICAgICAgLy8gTGl2ZSBmZWF0dXJlc1xuICAgICAgICBhZHZhbmNlZENvbnRlbnQuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnTGl2ZSBGZWF0dXJlcycgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoYWR2YW5jZWRDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ0VuYWJsZSBMaXZlIENoYXQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0VuYWJsZSBpbnRlcmFjdGl2ZSBjaGF0IHNlc3Npb25zIGluIG5vdGVzJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaXZlQ2hhdClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUxpdmVDaGF0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoYWR2YW5jZWRDb250ZW50KVxuICAgICAgICAgICAgLnNldE5hbWUoJ0VuYWJsZSBMaXZlIFN1Z2dlc3Rpb25zJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdQcm92aWRlIHN1Z2dlc3Rpb25zIGFzIHlvdSB0eXBlIChleHBlcmltZW50YWwpJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdmlzaWJpbGl0eSBvZiByZWxhdGVkIHNldHRpbmdzXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTGl2ZUZlYXR1cmVTZXR0aW5nc1Zpc2liaWxpdHkoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gQWRkIHNpbXBsaWZpZWQgTGl2ZSBDb3BpbG90IHNldHRpbmdzXG4gICAgICAgIGNvbnN0IGxpdmVTdWdnZXN0aW9uc0NvbnRhaW5lciA9IGFkdmFuY2VkQ29udGVudC5jcmVhdGVEaXYoJ3N5bmFwc2UtbGl2ZS1zZXR0aW5ncycpO1xuICAgICAgICBsaXZlU3VnZ2VzdGlvbnNDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnTGl2ZSBTdWdnZXN0aW9ucycgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKGxpdmVTdWdnZXN0aW9uc0NvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKCdTaG93IEdob3N0IFRleHQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1Nob3cgc3VnZ2VzdGVkIHRleHQgY29tcGxldGlvbnMgYXMgeW91IHR5cGUnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dHaG9zdFRleHQpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93R2hvc3RUZXh0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgLnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnMpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGxpdmVTdWdnZXN0aW9uc0NvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKCdBbGxvdyBRdWljayBBY2NlcHQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1Nob3cgYWNjZXB0IGJ1dHRvbiBmb3Igc3VnZ2VzdGlvbnMnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFsbG93UXVpY2tBY2NlcHQpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hbGxvd1F1aWNrQWNjZXB0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgLnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnMpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhsaXZlU3VnZ2VzdGlvbnNDb250YWluZXIpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU3VnZ2VzdGlvbiBEZWxheScpXG4gICAgICAgICAgICAuc2V0RGVzYygnRGVsYXkgYmVmb3JlIHNob3dpbmcgc3VnZ2VzdGlvbnMgKG1pbGxpc2Vjb25kcyknKVxuICAgICAgICAgICAgLmFkZFNsaWRlcihzbGlkZXIgPT4gc2xpZGVyXG4gICAgICAgICAgICAgICAgLnNldExpbWl0cyg1MDAsIDUwMDAsIDEwMClcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3VnZ2VzdGlvbkRlbGF5KVxuICAgICAgICAgICAgICAgIC5zZXREeW5hbWljVG9vbHRpcCgpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdWdnZXN0aW9uRGVsYXkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAuc2V0RGlzYWJsZWQoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUxpdmVTdWdnZXN0aW9ucyk7XG5cbiAgICAgICAgLy8gSGVscGVyIG1ldGhvZCB0byBzaG93L2hpZGUgc2V0dGluZ3MgYmFzZWQgb24gZmVhdHVyZSBlbmFibGVtZW50XG4gICAgICAgIHRoaXMudXBkYXRlTGl2ZUZlYXR1cmVTZXR0aW5nc1Zpc2liaWxpdHkoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZUxpdmVGZWF0dXJlU2V0dGluZ3NWaXNpYmlsaXR5KCkge1xuICAgICAgICBjb25zdCBsaXZlU2V0dGluZ3NEaXYgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5zeW5hcHNlLWxpdmUtc2V0dGluZ3MnKTtcbiAgICAgICAgaWYgKGxpdmVTZXR0aW5nc0Rpdikge1xuICAgICAgICAgICAgbGl2ZVNldHRpbmdzRGl2LnN0eWxlLmRpc3BsYXkgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaXZlU3VnZ2VzdGlvbnMgPyAnYmxvY2snIDogJ25vbmUnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkQXZhaWxhYmxlTW9kZWxzKGRyb3Bkb3duOiBEcm9wZG93bkNvbXBvbmVudCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gQ2xlYXIgZHJvcGRvd25cbiAgICAgICAgICAgIGRyb3Bkb3duLnNlbGVjdEVsLmVtcHR5KCk7XG4gICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oJycsICdMb2FkaW5nIG1vZGVscy4uLicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDcmVhdGUgbmV3IE9sbGFtYSBjbGllbnRcbiAgICAgICAgICAgIGNvbnN0IGNsaWVudCA9IG5ldyBPbGxhbWFDbGllbnQodGhpcy5wbHVnaW4uc2V0dGluZ3Mub2xsYW1hVXJsLCAnJyk7XG4gICAgICAgICAgICBjb25zdCBtb2RlbHMgPSBhd2FpdCBjbGllbnQuZ2V0QXZhaWxhYmxlTW9kZWxzKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBkcm9wZG93biB3aXRoIGF2YWlsYWJsZSBtb2RlbHNcbiAgICAgICAgICAgIGRyb3Bkb3duLnNlbGVjdEVsLmVtcHR5KCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtb2RlbHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKCcnLCAnTm8gbW9kZWxzIGZvdW5kJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKG1vZGVsLCBtb2RlbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gU2VsZWN0IGN1cnJlbnQgbW9kZWwgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgaWYgKG1vZGVscy5pbmNsdWRlcyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbGxhbWFNb2RlbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub2xsYW1hTW9kZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgbW9kZWxzOicsIGVycm9yKTtcbiAgICAgICAgICAgIGRyb3Bkb3duLnNlbGVjdEVsLmVtcHR5KCk7XG4gICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oJycsICdFcnJvciBsb2FkaW5nIG1vZGVscycpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhZGRDdXN0b21WYXJpYWJsZVJvdyhjb250YWluZXI6IEhUTUxFbGVtZW50LCBrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZykge1xuICAgICAgICBjb25zdCByb3cgPSBjb250YWluZXIuY3JlYXRlRGl2KCdzeW5hcHNlLWN1c3RvbS12YXItcm93Jyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUga2V5IGlucHV0XG4gICAgICAgIGNvbnN0IGtleUlucHV0ID0gcm93LmNyZWF0ZUVsKCdpbnB1dCcsIHtcbiAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIHZhbHVlOiBrZXksXG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogJ1ZhcmlhYmxlIG5hbWUnXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIHZhbHVlIGlucHV0XG4gICAgICAgIGNvbnN0IHZhbHVlSW5wdXQgPSByb3cuY3JlYXRlRWwoJ2lucHV0Jywge1xuICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdWYWx1ZSdcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgZGVsZXRlIGJ1dHRvblxuICAgICAgICBjb25zdCBkZWxldGVCdXR0b24gPSByb3cuY3JlYXRlRWwoJ2J1dHRvbicsIHtcbiAgICAgICAgICAgIHRleHQ6ICdcdTI3MTUnLFxuICAgICAgICAgICAgY2xzOiAnc3luYXBzZS1kZWxldGUtdmFyLWJ1dHRvbidcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgIGtleUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIC8vIFJlbW92ZSBvbGQga2V5XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tVGVtcGxhdGVWYXJpYWJsZXNba2V5XTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIHdpdGggbmV3IGtleVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tVGVtcGxhdGVWYXJpYWJsZXNba2V5SW5wdXQudmFsdWVdID0gdmFsdWVJbnB1dC52YWx1ZTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHZhbHVlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tVGVtcGxhdGVWYXJpYWJsZXNba2V5XSA9IHZhbHVlSW5wdXQudmFsdWU7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tVGVtcGxhdGVWYXJpYWJsZXNba2V5XTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgcm93LnJlbW92ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUZpbGVTZWxlY3Rpb25Nb2RhbChjYWxsYmFjazogKGZpbGU6IFRGaWxlIHwgbnVsbCkgPT4gdm9pZCkge1xuICAgICAgICBjb25zdCB7IG1vZGFsLCBjb250ZW50RWwgfSA9IHRoaXMuY3JlYXRlTW9kYWwoJ1NlbGVjdCBUZW1wbGF0ZSBGaWxlJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgc2VhcmNoIGlucHV0XG4gICAgICAgIGNvbnN0IHNlYXJjaEVsID0gY29udGVudEVsLmNyZWF0ZUVsKCdpbnB1dCcsIHtcbiAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnU2VhcmNoIGZpbGVzLi4uJ1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSBmaWxlIGxpc3QgY29udGFpbmVyXG4gICAgICAgIGNvbnN0IGZpbGVMaXN0RWwgPSBjb250ZW50RWwuY3JlYXRlRGl2KCdzeW5hcHNlLWZpbGUtbGlzdCcpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGFsbCBtYXJrZG93biBmaWxlcyBpbiB2YXVsdFxuICAgICAgICBjb25zdCBtYXJrZG93bkZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICBcbiAgICAgICAgLy8gRnVuY3Rpb24gdG8gZGlzcGxheSBmaWxlc1xuICAgICAgICBjb25zdCBkaXNwbGF5RmlsZXMgPSAoZmlsZXM6IFRGaWxlW10pID0+IHtcbiAgICAgICAgICAgIGZpbGVMaXN0RWwuZW1wdHkoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGZpbGVMaXN0RWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogJ05vIGZpbGVzIGZvdW5kJyB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVJdGVtID0gZmlsZUxpc3RFbC5jcmVhdGVEaXYoJ3N5bmFwc2UtZmlsZS1pdGVtJyk7XG4gICAgICAgICAgICAgICAgZmlsZUl0ZW0uc2V0VGV4dChmaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGZpbGVJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIC8vIEluaXRpYWwgZGlzcGxheSBvZiBhbGwgZmlsZXNcbiAgICAgICAgZGlzcGxheUZpbGVzKG1hcmtkb3duRmlsZXMpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHNlYXJjaCBmdW5jdGlvbmFsaXR5XG4gICAgICAgIHNlYXJjaEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2VhcmNoVGVybSA9IHNlYXJjaEVsLnZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBjb25zdCBmaWx0ZXJlZEZpbGVzID0gbWFya2Rvd25GaWxlcy5maWx0ZXIoZmlsZSA9PiBcbiAgICAgICAgICAgICAgICBmaWxlLnBhdGgudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGRpc3BsYXlGaWxlcyhmaWx0ZXJlZEZpbGVzKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgY2FuY2VsIGJ1dHRvblxuICAgICAgICBjb25zdCBmb290ZXJFbCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ3N5bmFwc2UtbW9kYWwtZm9vdGVyJyk7XG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IGZvb3RlckVsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdDYW5jZWwnIH0pO1xuICAgICAgICBjYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgICAgIG1vZGFsLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG1vZGFsO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlTW9kYWwodGl0bGU6IHN0cmluZykge1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyAocmVxdWlyZSgnb2JzaWRpYW4nKS5Nb2RhbCkodGhpcy5hcHApIGFzIGFueTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KHRpdGxlKTtcbiAgICAgICAgbW9kYWwuY29udGVudEVsLmFkZENsYXNzKCdzeW5hcHNlLW1vZGFsJyk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4geyBtb2RhbCwgY29udGVudEVsOiBtb2RhbC5jb250ZW50RWwgfTtcbiAgICB9XG59IiwgImV4cG9ydCBpbnRlcmZhY2UgT2xsYW1hUmVzcG9uc2Uge1xuICAgIHJlc3BvbnNlOiBzdHJpbmc7XG4gICAgZG9uZTogYm9vbGVhbjtcbiAgICBjb250ZXh0PzogbnVtYmVyW107XG59XG5cbmV4cG9ydCBjbGFzcyBPbGxhbWFDbGllbnQge1xuICAgIHByaXZhdGUgYmFzZVVybDogc3RyaW5nO1xuICAgIHByaXZhdGUgbW9kZWw6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKGJhc2VVcmw6IHN0cmluZywgbW9kZWw6IHN0cmluZykge1xuICAgICAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsLnJlcGxhY2UoL1xcLyQvLCAnJyk7IC8vIFJlbW92ZSB0cmFpbGluZyBzbGFzaFxuICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgfVxuXG4gICAgYXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuYmFzZVVybH0vYXBpL3RhZ3NgKTtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5vaztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGdlbmVyYXRlKHByb21wdDogc3RyaW5nLCBzeXN0ZW1Qcm9tcHQ/OiBzdHJpbmcsIGNoYXRIaXN0b3J5Pzogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIElmIGNoYXQgaGlzdG9yeSBpcyBwcm92aWRlZCwgZm9ybWF0IGl0IG5pY2VseVxuICAgICAgICAgICAgbGV0IGZ1bGxQcm9tcHQgPSBwcm9tcHQ7XG4gICAgICAgICAgICBpZiAoY2hhdEhpc3RvcnkgJiYgY2hhdEhpc3RvcnkudHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgZnVsbFByb21wdCA9IGBDaGF0IGhpc3Rvcnk6XFxuJHtjaGF0SGlzdG9yeX1cXG5cXG5DdXJyZW50IG1lc3NhZ2U6ICR7cHJvbXB0fWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0ge1xuICAgICAgICAgICAgICAgIG1vZGVsOiB0aGlzLm1vZGVsLFxuICAgICAgICAgICAgICAgIHByb21wdDogZnVsbFByb21wdCxcbiAgICAgICAgICAgICAgICBzeXN0ZW06IHN5c3RlbVByb21wdCB8fCAnJyxcbiAgICAgICAgICAgICAgICBzdHJlYW06IGZhbHNlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICAgICAgdG9wX3A6IDAuOSxcbiAgICAgICAgICAgICAgICAgICAgdG9wX2s6IDQwLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9hcGkvZ2VuZXJhdGVgLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBkYXRhOiBPbGxhbWFSZXNwb25zZSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLnJlc3BvbnNlLnRyaW0oKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGdlbmVyYXRlIHJlc3BvbnNlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2FwaS90YWdzYCk7XG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggbW9kZWxzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLm1vZGVscz8ubWFwKChtb2RlbDogYW55KSA9PiBtb2RlbC5uYW1lKSB8fCBbXTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG1vZGVsczonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgRWRpdG9yLCBURmlsZSwgTm90aWNlLCBBcHAsIE1hcmtkb3duVmlldyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IE9sbGFtYUNsaWVudCB9IGZyb20gJy4vb2xsYW1hJztcbmltcG9ydCB7IFN5bmFwc2VTZXR0aW5ncyB9IGZyb20gJy4vc2V0dGluZ3MnO1xuXG5leHBvcnQgY2xhc3MgU3luYXBzZUNvbW1hbmRzIHtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgb2xsYW1hOiBPbGxhbWFDbGllbnQ7XG4gICAgcHJpdmF0ZSBzZXR0aW5nczogU3luYXBzZVNldHRpbmdzO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIG9sbGFtYTogT2xsYW1hQ2xpZW50LCBzZXR0aW5nczogU3luYXBzZVNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLm9sbGFtYSA9IG9sbGFtYTtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIH1cblxuICAgIHVwZGF0ZVNldHRpbmdzKHNldHRpbmdzOiBTeW5hcHNlU2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgICAgICB0aGlzLm9sbGFtYSA9IG5ldyBPbGxhbWFDbGllbnQoc2V0dGluZ3Mub2xsYW1hVXJsLCBzZXR0aW5ncy5vbGxhbWFNb2RlbCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZXhwbGFpbkFuZExpbmsoZWRpdG9yOiBFZGl0b3IsIHNlbGVjdGVkVGV4dDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghc2VsZWN0ZWRUZXh0LnRyaW0oKSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIGV4cGxhaW4nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vdGljZUxvYWRpbmcgPSBuZXcgTm90aWNlKCdHZW5lcmF0aW5nIGV4cGxhbmF0aW9uLi4uJywgMCk7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgZXhwbGFuYXRpb25cbiAgICAgICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IHRoaXMucHJvY2Vzc1RlbXBsYXRlVmFyaWFibGVzKHRoaXMuc2V0dGluZ3MuZXhwbGFuYXRpb25TeXN0ZW1Qcm9tcHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSBgRXhwbGFpbiB0aGlzIGNvbmNlcHQ6IFwiJHtzZWxlY3RlZFRleHR9XCJgO1xuICAgICAgICAgICAgY29uc3QgZXhwbGFuYXRpb24gPSBhd2FpdCB0aGlzLm9sbGFtYS5nZW5lcmF0ZShwcm9tcHQsIHN5c3RlbVByb21wdCk7XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBub3RlIGZpbGVuYW1lIChzYW5pdGl6ZSlcbiAgICAgICAgICAgIGNvbnN0IG5vdGVUaXRsZSA9IHRoaXMuc2FuaXRpemVGaWxlTmFtZShzZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDcmVhdGUgZm9sZGVyIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZW5zdXJlRm9sZGVyRXhpc3RzKHRoaXMuc2V0dGluZ3MuZXhwbGFuYXRpb25Gb2xkZXIpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDcmVhdGUgcGF0aCB3aXRoIGZvbGRlclxuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBgJHt0aGlzLnNldHRpbmdzLmV4cGxhbmF0aW9uRm9sZGVyfS8ke25vdGVUaXRsZX0ubWRgO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBub3RlIGFscmVhZHkgZXhpc3RzXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuICAgICAgICAgICAgaWYgKGV4aXN0aW5nRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTm90ZSBcIiR7bm90ZVRpdGxlfVwiIGFscmVhZHkgZXhpc3RzYCk7XG4gICAgICAgICAgICAgICAgbm90aWNlTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDcmVhdGUgbmV3IG5vdGUgY29udGVudCAtIGVpdGhlciBmcm9tIHRlbXBsYXRlIG9yIGZyb20gc2NyYXRjaFxuICAgICAgICAgICAgbGV0IG5vdGVDb250ZW50O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy51c2VUZW1wbGF0ZUZvckV4cGxhbmF0aW9ucyAmJiB0aGlzLnNldHRpbmdzLnRlbXBsYXRlUGF0aCkge1xuICAgICAgICAgICAgICAgIC8vIFVzZSB0ZW1wbGF0ZSBpZiBlbmFibGVkIGFuZCB0ZW1wbGF0ZSBwYXRoIGlzIHNldFxuICAgICAgICAgICAgICAgIG5vdGVDb250ZW50ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUZyb21UZW1wbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy50ZW1wbGF0ZVBhdGgsIFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogbm90ZVRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogZXhwbGFuYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvTG9jYWxlRGF0ZVN0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnk6IHNlbGVjdGVkVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IHRoaXMuZ2V0VGFnc1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgLi4udGhpcy5zZXR0aW5ncy5jdXN0b21UZW1wbGF0ZVZhcmlhYmxlc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVXNlIGRlZmF1bHQgZm9ybWF0IHdpdGggb3B0aW9uYWwgdGFnc1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ3NMaW5lID0gdGhpcy5nZXRUYWdzU3RyaW5nKCkgPyBgXFxudGFnczogJHt0aGlzLmdldFRhZ3NTdHJpbmcoKX1gIDogJyc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbm90ZUNvbnRlbnQgPSBgIyAke25vdGVUaXRsZX0ke3RhZ3NMaW5lfVxuXG4ke2V4cGxhbmF0aW9ufVxuXG4tLS1cbipHZW5lcmF0ZWQgYnkgU3luYXBzZSBBSSpcbipDcmVhdGVkOiAke25ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9KmA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgbmV3IG5vdGVcbiAgICAgICAgICAgIGNvbnN0IG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZmlsZVBhdGgsIG5vdGVDb250ZW50KTtcblxuICAgICAgICAgICAgLy8gSW5zZXJ0IGxpbmsgaW4gY3VycmVudCBlZGl0b3JcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBgW1ske2ZpbGVQYXRoLnJlcGxhY2UoJy5tZCcsICcnKX18JHtub3RlVGl0bGV9XV1gO1xuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24obGluayk7XG5cbiAgICAgICAgICAgIC8vIE9wZW4gdGhlIG5ldyBub3RlXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLm9wZW5GaWxlKG5ld0ZpbGUpO1xuXG4gICAgICAgICAgICBub3RpY2VMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYENyZWF0ZWQgYW5kIGxpbmtlZCBub3RlOiAke25vdGVUaXRsZX1gKTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbm90aWNlTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXhwbGFpbiBhbmQgTGluayBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBzdW1tYXJpemVOb3RlKGVkaXRvcjogRWRpdG9yLCBjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCFjb250ZW50LnRyaW0oKSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gY29udGVudCB0byBzdW1tYXJpemUnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vdGljZUxvYWRpbmcgPSBuZXcgTm90aWNlKCdHZW5lcmF0aW5nIHN1bW1hcnkuLi4nLCAwKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gdGhpcy5wcm9jZXNzVGVtcGxhdGVWYXJpYWJsZXModGhpcy5zZXR0aW5ncy5zdW1tYXJ5U3lzdGVtUHJvbXB0KTtcblxuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gYFN1bW1hcml6ZSB0aGlzIGNvbnRlbnQ6XFxuXFxuJHtjb250ZW50fWA7XG4gICAgICAgICAgICBjb25zdCBzdW1tYXJ5ID0gYXdhaXQgdGhpcy5vbGxhbWEuZ2VuZXJhdGUocHJvbXB0LCBzeXN0ZW1Qcm9tcHQpO1xuXG4gICAgICAgICAgICAvLyBGb3JtYXQgc3VtbWFyeSBiYXNlZCBvbiBzZXR0aW5nc1xuICAgICAgICAgICAgbGV0IHN1bW1hcnlTZWN0aW9uO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy51c2VTdW1tYXJ5WWFtbCkge1xuICAgICAgICAgICAgICAgIC8vIEZvcm1hdCBhcyBZQU1MXG4gICAgICAgICAgICAgICAgc3VtbWFyeVNlY3Rpb24gPSBgLS0tXG5zdW1tYXJ5OlxuJHtzdW1tYXJ5LnNwbGl0KCdcXG4nKS5tYXAobGluZSA9PiBgICAke2xpbmV9YCkuam9pbignXFxuJyl9XG4tLS1cblxuYDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gRm9ybWF0IGFzIHJlZ3VsYXIgbWFya2Rvd25cbiAgICAgICAgICAgICAgICBzdW1tYXJ5U2VjdGlvbiA9IGAjIyBTdW1tYXJ5XG5cbiR7c3VtbWFyeX1cblxuLS0tXG5cbmA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEluc2VydCBzdW1tYXJ5IGF0IHNwZWNpZmllZCBsb2NhdGlvblxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3Muc3VtbWFyeUxvY2F0aW9uID09PSAndG9wJykge1xuICAgICAgICAgICAgICAgIC8vIEZpbmQgZmlyc3QgaGVhZGluZyBvciBpbnNlcnQgYXQgYmVnaW5uaW5nXG4gICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICBsZXQgaW5zZXJ0SW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFNraXAgZnJvbnQgbWF0dGVyIGlmIGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1swXT8uc3RhcnRzV2l0aCgnLS0tJykpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZEZyb250TWF0dGVyID0gbGluZXMuZmluZEluZGV4KChsaW5lLCBpKSA9PiBpID4gMCAmJiBsaW5lLnN0YXJ0c1dpdGgoJy0tLScpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuZEZyb250TWF0dGVyICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0SW5kZXggPSBlbmRGcm9udE1hdHRlciArIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSdyZSB1c2luZyBZQU1MIGFuZCB0aGVyZSdzIGFscmVhZHkgZnJvbnRtYXR0ZXIsIHdlIG5lZWQgdG8gbWVyZ2UgdGhlbVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnVzZVN1bW1hcnlZYW1sICYmIGxpbmVzWzBdPy5zdGFydHNXaXRoKCctLS0nKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRGcm9udE1hdHRlciA9IGxpbmVzLmZpbmRJbmRleCgobGluZSwgaSkgPT4gaSA+IDAgJiYgbGluZS5zdGFydHNXaXRoKCctLS0nKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbmRGcm9udE1hdHRlciAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV4dHJhY3QgZXhpc3RpbmcgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRnJvbnRtYXR0ZXIgPSBsaW5lcy5zbGljZSgwLCBlbmRGcm9udE1hdHRlciArIDEpLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGNsb3NpbmcgZGVsaW1pdGVyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcGVuRnJvbnRtYXR0ZXIgPSBleGlzdGluZ0Zyb250bWF0dGVyLnJlcGxhY2UoLy0tLVxccyokLywgJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHN1bW1hcnkgdG8gZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1bW1hcnlZYW1sID0gYHN1bW1hcnk6XG4ke3N1bW1hcnkuc3BsaXQoJ1xcbicpLm1hcChsaW5lID0+IGAgICR7bGluZX1gKS5qb2luKCdcXG4nKX1cbi0tLWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDb21iaW5lXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDb250ZW50ID0gb3BlbkZyb250bWF0dGVyICsgc3VtbWFyeVlhbWwgKyAnXFxuXFxuJyArIGxpbmVzLnNsaWNlKGVuZEZyb250TWF0dGVyICsgMSkuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0VmFsdWUobmV3Q29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub3RpY2VMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1N1bW1hcnkgYWRkZWQgdG8gZnJvbnRtYXR0ZXInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBbXG4gICAgICAgICAgICAgICAgICAgIC4uLmxpbmVzLnNsaWNlKDAsIGluc2VydEluZGV4KSxcbiAgICAgICAgICAgICAgICAgICAgJycsXG4gICAgICAgICAgICAgICAgICAgIHN1bW1hcnlTZWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICAuLi5saW5lcy5zbGljZShpbnNlcnRJbmRleClcbiAgICAgICAgICAgICAgICBdLmpvaW4oJ1xcbicpO1xuXG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldFZhbHVlKG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYXQgYm90dG9tXG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldFZhbHVlKGNvbnRlbnQgKyAnXFxuXFxuJyArIHN1bW1hcnlTZWN0aW9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbm90aWNlTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdTdW1tYXJ5IGFkZGVkIHRvIG5vdGUnKTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbm90aWNlTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignU3VtbWFyaXplIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGNyZWF0ZUZsYXNoY2FyZHMoZWRpdG9yOiBFZGl0b3IsIHNlbGVjdGVkVGV4dDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghc2VsZWN0ZWRUZXh0LnRyaW0oKSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIGNyZWF0ZSBmbGFzaGNhcmRzIGZyb20nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vdGljZUxvYWRpbmcgPSBuZXcgTm90aWNlKCdDcmVhdGluZyBmbGFzaGNhcmRzLi4uJywgMCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IHRoaXMucHJvY2Vzc1RlbXBsYXRlVmFyaWFibGVzKHRoaXMuc2V0dGluZ3MuZmxhc2hjYXJkU3lzdGVtUHJvbXB0KTtcblxuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gYENyZWF0ZSBmbGFzaGNhcmRzIGZyb20gdGhpcyBjb250ZW50OlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgICAgICBjb25zdCBmbGFzaGNhcmRzID0gYXdhaXQgdGhpcy5vbGxhbWEuZ2VuZXJhdGUocHJvbXB0LCBzeXN0ZW1Qcm9tcHQpO1xuXG4gICAgICAgICAgICAvLyBEZWNpZGUgaWYgd2Ugc2hvdWxkIGNyZWF0ZSBhIG5ldyBmbGFzaGNhcmQgbm90ZSBvciBpbnNlcnQgaW50byBjdXJyZW50IG5vdGVcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgY29uc3Qgbm90ZVRpdGxlID0gYWN0aXZlRmlsZSA/IGFjdGl2ZUZpbGUuYmFzZW5hbWUgOiBcIlVudGl0bGVkXCI7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENyZWF0ZSBmbGFzaGNhcmRzIG5vdGUgaW4gZGVkaWNhdGVkIGZvbGRlclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5lbnN1cmVGb2xkZXJFeGlzdHModGhpcy5zZXR0aW5ncy5mbGFzaGNhcmRGb2xkZXIpO1xuICAgICAgICAgICAgY29uc3QgZmxhc2hjYXJkRmlsZU5hbWUgPSBgJHt0aGlzLnNldHRpbmdzLmZsYXNoY2FyZEZvbGRlcn0vJHtub3RlVGl0bGV9IC0gRmxhc2hjYXJkcy5tZGA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCB0YWdzIGlmIGVuYWJsZWRcbiAgICAgICAgICAgIGNvbnN0IHRhZ3NMaW5lID0gdGhpcy5nZXRUYWdzU3RyaW5nKCkgPyBgXFxudGFnczogJHt0aGlzLmdldFRhZ3NTdHJpbmcoKX1gIDogJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGZsYXNoY2FyZENvbnRlbnQgPSBgIyBGbGFzaGNhcmRzIGZvciAke25vdGVUaXRsZX0ke3RhZ3NMaW5lfVxuXG4ke2ZsYXNoY2FyZHN9XG5cbi0tLVxuKkdlbmVyYXRlZCBmcm9tOiBbWyR7YWN0aXZlRmlsZSA/IGFjdGl2ZUZpbGUucGF0aC5yZXBsYWNlKCcubWQnLCAnJykgOiAnVW5rbm93biBzb3VyY2UnfV1dKlxuKkNyZWF0ZWQ6ICR7bmV3IERhdGUoKS50b0xvY2FsZURhdGVTdHJpbmcoKX0qXG5gO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBmbGFzaGNhcmQgZmlsZSBleGlzdHMgYW5kIGFwcGVuZCBvciBjcmVhdGVcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmbGFzaGNhcmRGaWxlTmFtZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0byBleGlzdGluZyBmaWxlXG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChleGlzdGluZ0ZpbGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBleGlzdGluZ0NvbnRlbnQgKyBcIlxcblxcbiMjIE5ldyBGbGFzaGNhcmRzXFxuXFxuXCIgKyBmbGFzaGNhcmRzO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShleGlzdGluZ0ZpbGUsIG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIE9wZW4gdGhlIGZpbGVcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLm9wZW5GaWxlKGV4aXN0aW5nRmlsZSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbm90aWNlTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnQWRkZWQgZmxhc2hjYXJkcyB0byBleGlzdGluZyBub3RlJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgZmlsZVxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZmxhc2hjYXJkRmlsZU5hbWUsIGZsYXNoY2FyZENvbnRlbnQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIE9wZW4gdGhlIGZpbGVcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLm9wZW5GaWxlKG5ld0ZpbGUpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIG5vdGljZUxvYWRpbmcuaGlkZSgpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0NyZWF0ZWQgbmV3IGZsYXNoY2FyZHMgbm90ZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBbHNvIGFkZCBsaW5rIHRvIGN1cnJlbnQgbm90ZVxuICAgICAgICAgICAgY29uc3QgbGluayA9IGBcXG5cXG5bWyR7Zmxhc2hjYXJkRmlsZU5hbWUucmVwbGFjZSgnLm1kJywgJycpfXxGbGFzaGNhcmRzIGZvciB0aGlzIG5vdGVdXVxcbmA7XG4gICAgICAgICAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICBlZGl0b3Iuc2V0TGluZShjdXJzb3IubGluZSwgZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpICsgbGluayk7XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIG5vdGljZUxvYWRpbmcuaGlkZSgpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NyZWF0ZSBGbGFzaGNhcmRzIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIHN0YXJ0Q2hhdFNlc3Npb24oZWRpdG9yOiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IGNoYXQgbm90ZSBpbiB0aGUgY2hhdCBmb2xkZXJcbiAgICAgICAgYXdhaXQgdGhpcy5lbnN1cmVGb2xkZXJFeGlzdHModGhpcy5zZXR0aW5ncy5jaGF0Rm9sZGVyKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5yZXBsYWNlKC9bOi5dL2csICctJyk7XG4gICAgICAgIGNvbnN0IGNoYXRGaWxlTmFtZSA9IGAke3RoaXMuc2V0dGluZ3MuY2hhdEZvbGRlcn0vQ2hhdC0ke3RpbWVzdGFtcH0ubWRgO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHRhZ3MgaWYgZW5hYmxlZFxuICAgICAgICBjb25zdCB0YWdzTGluZSA9IHRoaXMuZ2V0VGFnc1N0cmluZygpID8gYFxcbnRhZ3M6ICR7dGhpcy5nZXRUYWdzU3RyaW5nKCl9YCA6ICcnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY2hhdFRlbXBsYXRlID0gYCMgQ2hhdCBTZXNzaW9uICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfSR7dGFnc0xpbmV9XG5cbiMjIENvbnRleHRcbipUaGlzIGlzIGEgY2hhdCBzZXNzaW9uIHdpdGggU3luYXBzZSBBSS4gVHlwZSB5b3VyIG1lc3NhZ2VzIGFmdGVyIHRoZSA+IHByb21wdC4qXG5cbiMjIENoYXRcblxuPiBcblxuYDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoY2hhdEZpbGVOYW1lLCBjaGF0VGVtcGxhdGUpO1xuICAgICAgICBcbiAgICAgICAgLy8gT3BlbiB0aGUgZmlsZVxuICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKTtcbiAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShuZXdGaWxlKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFBvc2l0aW9uIGN1cnNvciBhdCB0aGUgcHJvbXB0XG4gICAgICAgIGNvbnN0IG5ld0VkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmIChuZXdFZGl0b3IpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gY2hhdFRlbXBsYXRlLnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdExpbmUgPSBsaW5lcy5maW5kSW5kZXgobGluZSA9PiBsaW5lID09PSAnPiAnKTtcbiAgICAgICAgICAgIGlmIChwcm9tcHRMaW5lICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIG5ld0VkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBwcm9tcHRMaW5lLCBjaDogMiB9KTtcbiAgICAgICAgICAgICAgICBuZXdFZGl0b3IuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgbmV3IE5vdGljZSgnU3RhcnRlZCBuZXcgY2hhdCBzZXNzaW9uJyk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2VuZENoYXRNZXNzYWdlKGVkaXRvcjogRWRpdG9yKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vIEZpbmQgdGhlIGN1cnJlbnQgY2hhdCBtZXNzYWdlIChsaW5lIHN0YXJ0aW5nIHdpdGggJz4nKVxuICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZWRpdG9yLmdldEN1cnNvcigpLmxpbmU7XG4gICAgICAgIFxuICAgICAgICAvLyBMb2NhdGUgdGhlIHByb21wdFxuICAgICAgICBsZXQgcHJvbXB0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICB3aGlsZSAocHJvbXB0TGluZSA+PSAwICYmICFsaW5lc1twcm9tcHRMaW5lXS5zdGFydHNXaXRoKCc+JykpIHtcbiAgICAgICAgICAgIHByb21wdExpbmUtLTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHByb21wdExpbmUgPCAwKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdObyBjaGF0IHByb21wdCBmb3VuZC4gUGxlYXNlIHN0YXJ0IG1lc3NhZ2Ugd2l0aCA+Jyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3QgbWVzc2FnZVxuICAgICAgICBjb25zdCB1c2VyTWVzc2FnZSA9IGxpbmVzW3Byb21wdExpbmVdLnN1YnN0cmluZygyKS50cmltKCk7XG4gICAgICAgIGlmICghdXNlck1lc3NhZ2UpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1BsZWFzZSB0eXBlIGEgbWVzc2FnZSBmaXJzdCcpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgdGhlIGNoYXQgd2l0aCB0aGUgdXNlciBtZXNzYWdlXG4gICAgICAgIGxpbmVzW3Byb21wdExpbmVdID0gYD4gJHt1c2VyTWVzc2FnZX1gO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGEgbG9hZGluZyBpbmRpY2F0b3JcbiAgICAgICAgbGluZXMuc3BsaWNlKHByb21wdExpbmUgKyAxLCAwLCAnXFxuX1N5bmFwc2UgaXMgdGhpbmtpbmcuLi5fJyk7XG4gICAgICAgIGVkaXRvci5zZXRWYWx1ZShsaW5lcy5qb2luKCdcXG4nKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgY2hhdCBoaXN0b3J5IGZvciBjb250ZXh0XG4gICAgICAgIGNvbnN0IGNoYXRIaXN0b3J5ID0gdGhpcy5leHRyYWN0Q2hhdEhpc3RvcnkobGluZXMsIHByb21wdExpbmUpO1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHJlc3BvbnNlXG4gICAgICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSB0aGlzLnByb2Nlc3NUZW1wbGF0ZVZhcmlhYmxlcyh0aGlzLnNldHRpbmdzLmNoYXRTeXN0ZW1Qcm9tcHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMub2xsYW1hLmdlbmVyYXRlKHVzZXJNZXNzYWdlLCBzeXN0ZW1Qcm9tcHQsIGNoYXRIaXN0b3J5KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVtb3ZlIGxvYWRpbmcgaW5kaWNhdG9yXG4gICAgICAgICAgICBsaW5lcy5zcGxpY2UocHJvbXB0TGluZSArIDEsIDEpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgQUkgcmVzcG9uc2UgYW5kIG5ldyBwcm9tcHRcbiAgICAgICAgICAgIGxpbmVzLnNwbGljZShwcm9tcHRMaW5lICsgMSwgMCwgXG4gICAgICAgICAgICAgICAgYFxcbiR7cmVzcG9uc2V9XFxuYCxcbiAgICAgICAgICAgICAgICBgPiBgXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTYXZlIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uXG4gICAgICAgICAgICBjb25zdCBzY3JvbGxJbmZvID0gZWRpdG9yLmdldFNjcm9sbEluZm8gPyBlZGl0b3IuZ2V0U2Nyb2xsSW5mbygpIDogbnVsbDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZWRpdG9yLnNldFZhbHVlKGxpbmVzLmpvaW4oJ1xcbicpKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSW1wcm92ZWQgY3Vyc29yIHBvc2l0aW9uaW5nIGFuZCB2aWV3IHNjcm9sbGluZyBsb2dpY1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IHVwZGF0ZWQgY29udGVudFxuICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlZExpbmVzID0gdXBkYXRlZENvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEZpbmQgdGhlIG5ldyBwcm9tcHQgbGluZSBhZnRlciB0aGUgY3VycmVudCBvbmVcbiAgICAgICAgICAgICAgICBsZXQgbmV3UHJvbXB0TGluZSA9IC0xO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBwcm9tcHRMaW5lICsgMTsgaSA8IHVwZGF0ZWRMaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlZExpbmVzW2ldID09PSAnPiAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdQcm9tcHRMaW5lID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIElmIHdlIGZvdW5kIHRoZSBuZXcgcHJvbXB0IGxpbmUsIHBvc2l0aW9uIGN1cnNvciBhZnRlciBcIj5cIlxuICAgICAgICAgICAgICAgIGlmIChuZXdQcm9tcHRMaW5lID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogbmV3UHJvbXB0TGluZSwgY2g6IDIgfSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBTY3JvbGwgdG8gdGhlIG5ldyBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY21FZGl0b3IgPSAoZWRpdG9yIGFzIGFueSkuY207XG4gICAgICAgICAgICAgICAgICAgIGlmIChjbUVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29kZU1pcnJvciA2XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY21FZGl0b3Iuc2Nyb2xsSW50b1ZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbUVkaXRvci5zY3JvbGxJbnRvVmlldyh7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lOiBuZXdQcm9tcHRMaW5lLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2g6IDIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTsgLy8gMTAwcHggbWFyZ2luIGZyb20gYm90dG9tXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2Ugc2Nyb2xsSW50b1ZpZXcgQVBJIChpZiBhdmFpbGFibGUpXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2Nyb2xsSW50b1ZpZXcoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IHsgbGluZTogbmV3UHJvbXB0TGluZSwgY2g6IDAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bzogeyBsaW5lOiBuZXdQcm9tcHRMaW5lLCBjaDogMiB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRW5zdXJlIHZpZXcgc3RheXMgYXQgYm90dG9tXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY20tc2Nyb2xsZXInKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvckVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNjcm9sbCB0byBib3R0b20gb2YgdGhlIGN1cnJlbnQgdmlld1xuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yRWxlbWVudC5zY3JvbGxUb3AgPSBlZGl0b3JFbGVtZW50LnNjcm9sbEhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTAwKTsgLy8gSW5jcmVhc2VkIGRlbGF5IHRvIGVuc3VyZSBlZGl0b3IgY29udGVudCBhbmQgRE9NIGFyZSBmdWxseSB1cGRhdGVkXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ2hhdCBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFJlbW92ZSBsb2FkaW5nIGluZGljYXRvciBhbmQgYWRkIGVycm9yIG1lc3NhZ2VcbiAgICAgICAgICAgIGxpbmVzLnNwbGljZShwcm9tcHRMaW5lICsgMSwgMSk7XG4gICAgICAgICAgICBsaW5lcy5zcGxpY2UocHJvbXB0TGluZSArIDEsIDAsICdfRXJyb3I6IENvdWxkIG5vdCBnZW5lcmF0ZSByZXNwb25zZV8nKTtcbiAgICAgICAgICAgIGVkaXRvci5zZXRWYWx1ZShsaW5lcy5qb2luKCdcXG4nKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgYXN5bmMgZ2VuZXJhdGVMaXZlU3VnZ2VzdGlvbihlZGl0b3I6IEVkaXRvcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuZW5hYmxlTGl2ZVN1Z2dlc3Rpb25zKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgY3VycmVudCBjb250ZXh0XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGN1cnNvci5saW5lO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGEgZmV3IGxpbmVzIGJlZm9yZSBjdXJyZW50IGxpbmUgZm9yIGNvbnRleHRcbiAgICAgICAgY29uc3QgY29udGV4dExpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJykuc2xpY2UoTWF0aC5tYXgoMCwgY3VycmVudExpbmUgLSAxMCksIGN1cnJlbnRMaW5lICsgNSk7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBjb250ZXh0TGluZXMuam9pbignXFxuJyk7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udGV4dC50cmltKCkubGVuZ3RoIDwgNSkgcmV0dXJuOyAvLyBOb3QgZW5vdWdoIGNvbnRleHRcbiAgICAgICAgXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBUcmFkaXRpb25hbCB0ZXh0IGNvbnRpbnVhdGlvblxuICAgICAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgYW4gQUkgd3JpdGluZyBhc3Npc3RhbnQuIFxuICAgICAgICAgICAgQmFzZWQgb24gdGhlIGNvbnRleHQgcHJvdmlkZWQsIHN1Z2dlc3QgYSBicmllZiBjb250aW51YXRpb24gKDEtMyB3b3JkcyBtYXhpbXVtKS5cbiAgICAgICAgICAgIE1ha2UgeW91ciBzdWdnZXN0aW9uIGRpcmVjdGx5IHJlbGV2YW50IHRvIHdoYXQncyBiZWluZyB3cml0dGVuLlxuICAgICAgICAgICAgRG8gbm90IHJlcGVhdCB3aGF0J3MgYWxyZWFkeSB3cml0dGVuLiBcbiAgICAgICAgICAgIE9ubHkgcmV0dXJuIHRoZSBjb250aW51YXRpb24gdGV4dC4gRG8gbm90IGluY2x1ZGUgYW55IGFkZGl0aW9uYWwgdGV4dCBvciBmb3JtYXR0aW5nLmA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5vbGxhbWEuZ2VuZXJhdGUoYENvbnRpbnVlIHRoaXMgdGV4dDogJHtjb250ZXh0fWAsIHN5c3RlbVByb21wdCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIERpc3BsYXkgc3VnZ2VzdGlvbiBhcyBnaG9zdCB0ZXh0XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlHaG9zdFRleHQoZWRpdG9yLCByZXNwb25zZSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdTdWdnZXN0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZGlzcGxheUdob3N0VGV4dChlZGl0b3I6IEVkaXRvciwgdGV4dDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIC8vIERpc3BsYXkgZ2hvc3QgdGV4dCBzdWdnZXN0aW9uXG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5zaG93R2hvc3RUZXh0KSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgYSBub3RpY2Ugd2l0aCB0aGUgc3VnZ2VzdGlvblxuICAgICAgICBjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlKGBTdWdnZXN0aW9uOiAke3RleHQuc3Vic3RyaW5nKDAsIDUwKX0ke3RleHQubGVuZ3RoID4gNTAgPyAnLi4uJyA6ICcnfWAsIDUwMDApO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGFuIGFjY2VwdCBidXR0b25cbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuYWxsb3dRdWlja0FjY2VwdCkge1xuICAgICAgICAgICAgY29uc3Qgbm90aWNlRWwgPSBub3RpY2Uubm90aWNlRWw7XG4gICAgICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBub3RpY2VFbC5jcmVhdGVEaXYoJ3N5bmFwc2Utc3VnZ2VzdGlvbi1hY3Rpb25zJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGFjY2VwdEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywge1xuICAgICAgICAgICAgICAgIHRleHQ6ICdBY2NlcHQnLFxuICAgICAgICAgICAgICAgIGNsczogJ3N5bmFwc2UtYWNjZXB0LWJ1dHRvbidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhY2NlcHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UodGV4dCwgY3Vyc29yKTtcbiAgICAgICAgICAgICAgICBub3RpY2UuaGlkZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBOZXcgbWV0aG9kIHRvIHByb2Nlc3MgdGVtcGxhdGUgdmFyaWFibGVzIGluIHByb21wdHNcbiAgICBwcml2YXRlIHByb2Nlc3NUZW1wbGF0ZVZhcmlhYmxlcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBsZXQgcHJvY2Vzc2VkID0gdGV4dDtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlcGxhY2UgYnVpbHQtaW4gdmFyaWFibGVzXG4gICAgICAgIHByb2Nlc3NlZCA9IHByb2Nlc3NlZC5yZXBsYWNlKC97e21heFJlc3BvbnNlTGVuZ3RofX0vZywgdGhpcy5zZXR0aW5ncy5tYXhSZXNwb25zZUxlbmd0aC50b1N0cmluZygpKTtcbiAgICAgICAgcHJvY2Vzc2VkID0gcHJvY2Vzc2VkLnJlcGxhY2UoL3t7bW9kZWx9fS9nLCB0aGlzLnNldHRpbmdzLm9sbGFtYU1vZGVsKTtcbiAgICAgICAgcHJvY2Vzc2VkID0gcHJvY2Vzc2VkLnJlcGxhY2UoL3t7ZGF0ZX19L2csIG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCkpO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVwbGFjZSBjdXN0b20gdmFyaWFibGVzXG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuc2V0dGluZ3MuY3VzdG9tVGVtcGxhdGVWYXJpYWJsZXMpKSB7XG4gICAgICAgICAgICBwcm9jZXNzZWQgPSBwcm9jZXNzZWQucmVwbGFjZShuZXcgUmVnRXhwKGB7eyR7a2V5fX19YCwgJ2cnKSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcHJvY2Vzc2VkO1xuICAgIH1cblxuICAgIC8vIE5ldyBtZXRob2QgdG8gZ2VuZXJhdGUgbm90ZSBjb250ZW50IGZyb20gdGVtcGxhdGVcbiAgICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlRnJvbVRlbXBsYXRlKHRlbXBsYXRlUGF0aDogc3RyaW5nLCB2YXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IHRlbXBsYXRlIGZpbGVcbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0ZW1wbGF0ZVBhdGgpO1xuICAgICAgICAgICAgaWYgKCEodGVtcGxhdGVGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUZW1wbGF0ZSBmaWxlIG5vdCBmb3VuZDogJHt0ZW1wbGF0ZVBhdGh9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFJlYWQgdGVtcGxhdGUgY29udGVudFxuICAgICAgICAgICAgbGV0IHRlbXBsYXRlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQodGVtcGxhdGVGaWxlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVwbGFjZSB2YXJpYWJsZXNcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHZhcmlhYmxlcykpIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZUNvbnRlbnQgPSB0ZW1wbGF0ZUNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKGB7eyR7a2V5fX19YCwgJ2cnKSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gdGVtcGxhdGVDb250ZW50O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVGVtcGxhdGUgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gcHJvY2VzcyB0ZW1wbGF0ZTogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzYW5pdGl6ZUZpbGVOYW1lKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIFJlbW92ZSBvciByZXBsYWNlIGludmFsaWQgY2hhcmFjdGVycyBmb3IgZmlsZSBuYW1lc1xuICAgICAgICByZXR1cm4gdGV4dFxuICAgICAgICAgICAgLnJlcGxhY2UoL1teXFx3XFxzLV0vZywgJycpIC8vIFJlbW92ZSBzcGVjaWFsIGNoYXJhY3RlcnMgZXhjZXB0IHdvcmQgY2hhcnMsIHNwYWNlcywgaHlwaGVuc1xuICAgICAgICAgICAgLnJlcGxhY2UoL1xccysvZywgJyAnKSAvLyBSZXBsYWNlIG11bHRpcGxlIHNwYWNlcyB3aXRoIHNpbmdsZSBzcGFjZVxuICAgICAgICAgICAgLnRyaW0oKVxuICAgICAgICAgICAgLnN1YnN0cmluZygwLCA1MCk7IC8vIExpbWl0IGxlbmd0aFxuICAgIH1cbiAgICBcbiAgICBwcml2YXRlIGFzeW5jIGVuc3VyZUZvbGRlckV4aXN0cyhmb2xkZXJQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCFmb2xkZXJQYXRoKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmb2xkZXJzID0gZm9sZGVyUGF0aC5zcGxpdCgnLycpLmZpbHRlcihwID0+IHAudHJpbSgpKTtcbiAgICAgICAgbGV0IGN1cnJlbnRQYXRoID0gJyc7XG4gICAgICAgIFxuICAgICAgICBmb3IgKGNvbnN0IGZvbGRlciBvZiBmb2xkZXJzKSB7XG4gICAgICAgICAgICBjdXJyZW50UGF0aCA9IGN1cnJlbnRQYXRoID8gYCR7Y3VycmVudFBhdGh9LyR7Zm9sZGVyfWAgOiBmb2xkZXI7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChjdXJyZW50UGF0aCkpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIoY3VycmVudFBhdGgpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgZm9sZGVyICR7Y3VycmVudFBhdGh9OmAsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBnZXRBY3RpdmVFZGl0b3IoKTogRWRpdG9yIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICByZXR1cm4gdmlldz8uZWRpdG9yIHx8IG51bGw7XG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgZXh0cmFjdENoYXRIaXN0b3J5KGxpbmVzOiBzdHJpbmdbXSwgY3VycmVudFByb21wdExpbmU6IG51bWJlcik6IHN0cmluZyB7XG4gICAgICAgIC8vIEV4dHJhY3QgYWxsIHByZXZpb3VzIGV4Y2hhbmdlcyB0byBnaXZlIGNvbnRleHQgdG8gdGhlIEFJXG4gICAgICAgIGxldCBjaGF0SGlzdG9yeSA9ICcnO1xuICAgICAgICBsZXQgaW5DaGF0ID0gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN1cnJlbnRQcm9tcHRMaW5lOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgcmVhY2hlZCB0aGUgY2hhdCBzZWN0aW9uXG4gICAgICAgICAgICBpZiAobGluZSA9PT0gJyMjIENoYXQnKSB7XG4gICAgICAgICAgICAgICAgaW5DaGF0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGluQ2hhdCkge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoJz4gJykpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhdEhpc3RvcnkgKz0gYFVzZXI6ICR7bGluZS5zdWJzdHJpbmcoMil9XFxuYDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmUudHJpbSgpICYmICFsaW5lLnN0YXJ0c1dpdGgoJ18nKSAmJiBsaW5lICE9PSAnJykge1xuICAgICAgICAgICAgICAgICAgICBjaGF0SGlzdG9yeSArPSBgQUk6ICR7bGluZX1cXG5gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNoYXRIaXN0b3J5O1xuICAgIH1cblxuICAgIC8vIEhlbHBlciBtZXRob2QgdG8gZ2V0IGZvcm1hdHRlZCB0YWdzIHN0cmluZ1xuICAgIHByaXZhdGUgZ2V0VGFnc1N0cmluZygpOiBzdHJpbmcge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuYWRkU3luYXBzZVRhZyB8fCAhdGhpcy5zZXR0aW5ncy5zeW5hcHNlVGFnKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEZvcm1hdCB0YWdzIHByb3Blcmx5IGZvciBZQU1MXG4gICAgICAgIGNvbnN0IHRhZ3MgPSB0aGlzLnNldHRpbmdzLnN5bmFwc2VUYWcuc3BsaXQoJywnKVxuICAgICAgICAgICAgLm1hcCh0YWcgPT4gdGFnLnRyaW0oKSlcbiAgICAgICAgICAgIC5maWx0ZXIodGFnID0+IHRhZylcbiAgICAgICAgICAgIC5tYXAodGFnID0+IHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0YWcgZG9lc24ndCBzdGFydCB3aXRoICMsIGFkZCBpdFxuICAgICAgICAgICAgICAgIHJldHVybiB0YWcuc3RhcnRzV2l0aCgnIycpID8gdGFnIDogYCMke3RhZ31gO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRhZ3Muam9pbignICcpO1xuICAgIH1cbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQXFFOzs7QUM0QjlELElBQU0sbUJBQW9DO0FBQUEsRUFDN0MsV0FBVztBQUFBLEVBQ1gsYUFBYTtBQUFBLEVBQ2IsaUJBQWlCO0FBQUEsRUFDakIsaUJBQWlCO0FBQUEsRUFDakIsaUJBQWlCO0FBQUEsRUFDakIsbUJBQW1CO0FBQUEsRUFDbkIsbUJBQW1CO0FBQUEsRUFDbkIsaUJBQWlCO0FBQUEsRUFDakIsZ0JBQWdCO0FBQUEsRUFDaEIsWUFBWTtBQUFBLEVBQ1osZ0JBQWdCO0FBQUEsRUFDaEIsdUJBQXVCO0FBQUEsRUFDdkIsaUJBQWlCO0FBQUEsRUFDakIsZUFBZTtBQUFBLEVBQ2Ysa0JBQWtCO0FBQUEsRUFDbEIsY0FBYztBQUFBLEVBQ2QsNEJBQTRCO0FBQUEsRUFDNUIsb0JBQW9CO0FBQUEsRUFDcEIsa0JBQWtCO0FBQUEsRUFDbEIseUJBQXlCO0FBQUEsRUFDekIscUJBQXFCO0FBQUEsRUFDckIsdUJBQXVCO0FBQUEsRUFDdkIseUJBQXlCLENBQUM7QUFBQSxFQUMxQixlQUFlO0FBQUEsRUFDZixZQUFZO0FBQ2hCOzs7QUN0REEsc0JBQTZHOzs7QUNNdEcsSUFBTSxlQUFOLE1BQW1CO0FBQUEsRUFJdEIsWUFBWSxTQUFpQixPQUFlO0FBQ3hDLFNBQUssVUFBVSxRQUFRLFFBQVEsT0FBTyxFQUFFO0FBQ3hDLFNBQUssUUFBUTtBQUFBLEVBQ2pCO0FBQUEsRUFFQSxNQUFNLGNBQWdDO0FBQ2xDLFFBQUk7QUFDQSxZQUFNLFdBQVcsTUFBTSxNQUFNLEdBQUcsS0FBSyxrQkFBa0I7QUFDdkQsYUFBTyxTQUFTO0FBQUEs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QUNuQixpQkFDSyxTQUFTLDZCQUFzQixFQUMvQixRQUFRLGdCQUFnQixFQUN4QixRQUFRLFlBQVk7QUFDakIsb0JBQU0sS0FBSyxTQUFTLGdCQUFnQixNQUFNO0FBQUEsWUFDOUMsQ0FBQztBQUFBLFVBQ1QsQ0FBQztBQUFBLFFBQ0wsT0FBTztBQUNILGVBQUssUUFBUSxDQUFDLFNBQVM7QUFDbkIsaUJBQ0ssU0FBUyw4QkFBdUIsRUFDaEMsUUFBUSxnQkFBZ0IsRUFDeEIsUUFBUSxZQUFZO0FBQ2pCLG9CQUFNLEtBQUssU0FBUyxpQkFBaUIsTUFBTTtBQUFBLFlBQy9DLENBQUM7QUFBQSxVQUNULENBQUM7QUFBQSxRQUNMO0FBQUEsTUFDSixDQUFDO0FBQUEsSUFDTDtBQUdBLFNBQUssNkJBQTZCO0FBR2xDLFNBQUssc0JBQXNCO0FBRTNCLFlBQVEsSUFBSSx1QkFBdUI7QUFBQSxFQUN2QztBQUFBLEVBRUEsV0FBVztBQUNQLFlBQVEsSUFBSSx5QkFBeUI7QUFBQSxFQUN6QztBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ2pCLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDN0U7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFFakMsU0FBSyxTQUFTLGVBQWUsS0FBSyxRQUFRO0FBRzFDLFNBQUssMEJBQXNCO0FBQUEsTUFDdkIsQ0FBQyxXQUFtQixLQUFLLFNBQVMsdUJBQXVCLE1BQU07QUFBQSxNQUMvRCxLQUFLLFNBQVM7QUFBQSxJQUNsQjtBQUdBLFNBQUssNkJBQTZCO0FBQUEsRUFDdEM7QUFBQSxFQUVRLCtCQUErQjtBQUVuQyxRQUFJLEtBQUsscUJBQXFCO0FBQzFCLFdBQUssSUFBSSxVQUFVLElBQUksaUJBQWlCLEtBQUssbUJBQW1CO0FBQUEsSUFDcEU7QUFHQSxRQUFJLEtBQUssU0FBUyx1QkFBdUI7QUFDckMsV0FBSyxzQkFBc0IsS0FBSyxJQUFJLFVBQVUsR0FBRyxpQkFBaUIsQ0FBQyxXQUFtQjtBQUNsRixhQUFLLG9CQUFvQixNQUFNO0FBQUEsTUFDbkMsQ0FBQztBQUNELFdBQUssY0FBYyxLQUFLLG1CQUFtQjtBQUFBLElBQy9DO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBYyx3QkFBd0I7QUFDbEMsVUFBTSxjQUFjLE1BQU0sS0FBSyxPQUFPLFlBQVk7QUFFbEQsUUFBSSxDQUFDLGFBQWE7QUFDZCxVQUFJO0FBQUEsUUFDQSw4RUFDQSxLQUFLLFNBQVM7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUFBLElBQ0osT0FBTztBQUNILFVBQUksd0JBQU8sNkNBQTZDLEdBQUk7QUFBQSxJQUNoRTtBQUFBLEVBQ0o7QUFDSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJuZXdDb250ZW50Il0KfQo=
